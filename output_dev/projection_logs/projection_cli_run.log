2025-05-10 07:16:12,091 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 07:16:12,091 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 07:16:12,096 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 07:16:12,096 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 07:16:12,096 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 07:16:12,096 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 07:16:12,155 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 07:16:12,164 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 07:16:12,164 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 07:16:12,164 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 07:16:12,166 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 07:16:12,166 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 07:16:12,166 [INFO    ] [cost_model.projections.runner.run_projection_engine:92] Running 5-year projection starting from 2025.
2025-05-10 07:16:12,166 [INFO    ] [cost_model.projections.runner.run_projection_engine:93] Random seed: 42
2025-05-10 07:16:12,166 [INFO    ] [cost_model.projections.runner._generate_hazard_table:29] Generating hazard table...
2025-05-10 07:16:12,168 [INFO    ] [cost_model.projections.runner._generate_hazard_table:41] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 07:16:12,168 [INFO    ] [cost_model.projections.runner._generate_hazard_table:58] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 07:16:12,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:110] --- Simulating Year 2025 (Index 0) ---
2025-05-10 07:16:12,190 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 07:16:12,194 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 07:16:12,196 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 07:16:12,205 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:16:12,206 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 07:16:12,207 [INFO    ] [cost_model.projections.runner.run_projection_engine:123] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 07:16:12,208 [INFO    ] [cost_model.projections.runner.run_projection_engine:110] --- Simulating Year 2026 (Index 1) ---
2025-05-10 07:16:12,221 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 07:16:12,221 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 07:16:12,221 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 07:16:12,222 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 07:16:12,223 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 07:16:12,223 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 07:16:12,223 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 07:16:12,223 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 07:16:12,224 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 07:16:12,226 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:16:12,228 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 07:16:12,235 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:16:12,235 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 07:16:12,236 [INFO    ] [cost_model.projections.runner.run_projection_engine:123] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 07:16:12,238 [INFO    ] [cost_model.projections.runner.run_projection_engine:110] --- Simulating Year 2027 (Index 2) ---
2025-05-10 07:16:12,251 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 07:16:12,254 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:16:12,256 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 07:16:12,262 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:16:12,263 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 07:16:12,264 [INFO    ] [cost_model.projections.runner.run_projection_engine:123] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 07:16:12,265 [INFO    ] [cost_model.projections.runner.run_projection_engine:110] --- Simulating Year 2028 (Index 3) ---
2025-05-10 07:16:12,279 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 07:16:12,283 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:16:12,285 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 07:16:12,291 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:16:12,292 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 07:16:12,292 [INFO    ] [cost_model.projections.runner.run_projection_engine:123] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 07:16:12,294 [INFO    ] [cost_model.projections.runner.run_projection_engine:110] --- Simulating Year 2029 (Index 4) ---
2025-05-10 07:16:12,308 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 07:16:12,311 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:16:12,313 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 07:16:12,320 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 07:16:12,321 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 07:16:12,322 [INFO    ] [cost_model.projections.runner.run_projection_engine:123] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 07:16:12,323 [INFO    ] [cost_model.projections.runner.run_projection_engine:180] Projection engine run completed.
2025-05-10 07:16:12,323 [INFO    ] [cost_model.projections.runner.run_projection_engine:181] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 07:16:12,323 [INFO    ] [cost_model.projections.runner.run_projection_engine:182] Final Cumulative Event Log shape: (370, 8)
2025-05-10 07:16:12,324 [INFO    ] [cost_model.projections.runner.run_projection_engine:183] Summary Results:
   year  active_headcount_eoy  terminations  new_hires  total_contributions
0  2025                   135             0          0                    0
1  2026                   118             0          0                    0
2  2027                   111             0          0                    0
3  2028                   111             0          0                    0
4  2029                   109             0          0                    0
2025-05-10 07:16:12,324 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 07:16:12,324 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 07:16:12,324 [INFO    ] [cost_model.projections.reporting.save_detailed_results:82] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 07:16:12,330 [INFO    ] [cost_model.projections.reporting.save_detailed_results:110] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:16:12,330 [INFO    ] [cost_model.projections.cli.main:112] Generating and saving plots...
2025-05-10 07:16:12,330 [INFO    ] [cost_model.projections.reporting.plot_projection_results:25] Plotting projection results to output_dev/projection_cli_results...
2025-05-10 07:16:12,409 [INFO    ] [cost_model.projections.reporting.plot_projection_results:49] Saved summary plot to output_dev/projection_cli_results/projection_summary_plot.png
2025-05-10 07:16:12,441 [INFO    ] [cost_model.projections.reporting.plot_projection_results:64] Saved contributions plot to output_dev/projection_cli_results/projection_contributions_plot.png
2025-05-10 07:16:12,441 [INFO    ] [cost_model.projections.cli.main:115] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 07:16:12,441 [INFO    ] [cost_model.projections.cli.main:116] All outputs saved in: output_dev/projection_cli_results
2025-05-10 07:31:42,204 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 07:31:42,205 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 07:31:42,209 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 07:31:42,210 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 07:31:42,210 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 07:31:42,210 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 07:31:42,264 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 07:31:42,274 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 07:31:42,277 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 07:31:42,277 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 07:31:42,282 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 07:31:42,282 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 07:31:42,282 [INFO    ] [cost_model.projections.runner.run_projection_engine:91] Running 5-year projection starting from 2025.
2025-05-10 07:31:42,282 [INFO    ] [cost_model.projections.runner.run_projection_engine:92] Random seed: 42
2025-05-10 07:31:42,282 [INFO    ] [cost_model.projections.runner._generate_hazard_table:36] Generating hazard table...
2025-05-10 07:31:42,285 [INFO    ] [cost_model.projections.runner._generate_hazard_table:50] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 07:31:42,285 [INFO    ] [cost_model.projections.runner._generate_hazard_table:67] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 07:31:42,285 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2025 (Index 0) ---
2025-05-10 07:31:42,303 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 07:31:42,307 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 07:31:42,310 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 07:31:42,319 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:31:42,319 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 07:31:42,320 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 07:31:42,320 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Events generated this year: 362
2025-05-10 07:31:42,323 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2026 (Index 1) ---
2025-05-10 07:31:42,335 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 07:31:42,335 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 07:31:42,335 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 07:31:42,336 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 07:31:42,336 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 07:31:42,336 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 07:31:42,337 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 07:31:42,337 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 07:31:42,337 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 07:31:42,340 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:31:42,342 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 07:31:42,349 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:31:42,350 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 07:31:42,351 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 07:31:42,351 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Events generated this year: 374
2025-05-10 07:31:42,352 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2027 (Index 2) ---
2025-05-10 07:31:42,366 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 07:31:42,369 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:31:42,371 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 07:31:42,379 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:31:42,379 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 07:31:42,380 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 07:31:42,380 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Events generated this year: 370
2025-05-10 07:31:42,382 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2028 (Index 3) ---
2025-05-10 07:31:42,398 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 07:31:42,402 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:31:42,404 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 07:31:42,411 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:31:42,412 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 07:31:42,413 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 07:31:42,413 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Events generated this year: 360
2025-05-10 07:31:42,415 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2029 (Index 4) ---
2025-05-10 07:31:42,472 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 07:31:42,475 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:31:42,481 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 07:31:42,491 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 07:31:42,492 [WARNING ] [cost_model.engines.run_one_year.run_one_year:181] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 07:31:42,493 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 07:31:42,493 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Events generated this year: 370
2025-05-10 07:31:42,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:210] Projection engine run completed.
2025-05-10 07:31:42,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 07:31:42,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:217] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 07:31:42,495 [INFO    ] [cost_model.projections.runner.run_projection_engine:218] Summary Results:
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 07:31:42,495 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 07:31:42,496 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 07:31:42,496 [INFO    ] [cost_model.projections.reporting.save_detailed_results:82] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 07:31:42,504 [INFO    ] [cost_model.projections.reporting.save_detailed_results:110] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:31:42,504 [INFO    ] [cost_model.projections.cli.main:112] Generating and saving plots...
2025-05-10 07:31:42,504 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 07:31:42,504 [INFO    ] [cost_model.projections.cli.main:115] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 07:31:42,504 [INFO    ] [cost_model.projections.cli.main:116] All outputs saved in: output_dev/projection_cli_results
2025-05-10 07:35:58,380 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 07:35:58,381 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 07:35:58,385 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 07:35:58,385 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 07:35:58,385 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 07:35:58,385 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 07:35:58,437 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 07:35:58,444 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 07:35:58,445 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 07:35:58,445 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 07:35:58,446 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 07:35:58,446 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 07:35:58,446 [INFO    ] [cost_model.projections.runner.run_projection_engine:91] Running 5-year projection starting from 2025.
2025-05-10 07:35:58,446 [INFO    ] [cost_model.projections.runner.run_projection_engine:92] Random seed: 42
2025-05-10 07:35:58,446 [INFO    ] [cost_model.projections.runner._generate_hazard_table:36] Generating hazard table...
2025-05-10 07:35:58,448 [INFO    ] [cost_model.projections.runner._generate_hazard_table:50] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 07:35:58,448 [INFO    ] [cost_model.projections.runner._generate_hazard_table:67] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 07:35:58,448 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2025 (Index 0) ---
2025-05-10 07:35:58,466 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 07:35:58,469 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 07:35:58,470 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2025] Survivors after main terminations: 150, Growth Rate from hazard: 0.0500, Target EOY headcount: 158
2025-05-10 07:35:58,470 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 07:35:58,471 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:35:58,472 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 07:35:58,480 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:35:58,481 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 07:35:58,482 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 07:35:58,482 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Events generated this year: 362
2025-05-10 07:35:58,484 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2026 (Index 1) ---
2025-05-10 07:35:58,496 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 07:35:58,496 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 07:35:58,496 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 07:35:58,497 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 07:35:58,498 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 07:35:58,498 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 07:35:58,498 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 07:35:58,498 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 07:35:58,499 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 07:35:58,501 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:35:58,502 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2026] Survivors after main terminations: 158, Growth Rate from hazard: 0.0500, Target EOY headcount: 166
2025-05-10 07:35:58,502 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 07:35:58,503 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:35:58,504 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 07:35:58,511 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:35:58,511 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 07:35:58,512 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 07:35:58,512 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Events generated this year: 374
2025-05-10 07:35:58,514 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2027 (Index 2) ---
2025-05-10 07:35:58,528 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 07:35:58,531 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:35:58,531 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2027] Survivors after main terminations: 166, Growth Rate from hazard: 0.0500, Target EOY headcount: 175
2025-05-10 07:35:58,531 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 07:35:58,532 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:35:58,533 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 07:35:58,540 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:35:58,540 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 07:35:58,541 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 07:35:58,541 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Events generated this year: 370
2025-05-10 07:35:58,543 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2028 (Index 3) ---
2025-05-10 07:35:58,556 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 07:35:58,559 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:35:58,560 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2028] Survivors after main terminations: 175, Growth Rate from hazard: 0.0500, Target EOY headcount: 184
2025-05-10 07:35:58,560 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 07:35:58,560 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:35:58,561 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 07:35:58,568 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:35:58,569 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 07:35:58,570 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 07:35:58,570 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Events generated this year: 360
2025-05-10 07:35:58,572 [INFO    ] [cost_model.projections.runner.run_projection_engine:118] --- Simulating Year 2029 (Index 4) ---
2025-05-10 07:35:58,588 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 07:35:58,591 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:35:58,592 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2029] Survivors after main terminations: 184, Growth Rate from hazard: 0.0500, Target EOY headcount: 194
2025-05-10 07:35:58,592 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 07:35:58,593 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 07:35:58,594 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 07:35:58,600 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 07:35:58,601 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 07:35:58,601 [INFO    ] [cost_model.projections.runner.run_projection_engine:132] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 07:35:58,602 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Events generated this year: 370
2025-05-10 07:35:58,603 [INFO    ] [cost_model.projections.runner.run_projection_engine:210] Projection engine run completed.
2025-05-10 07:35:58,603 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 07:35:58,603 [INFO    ] [cost_model.projections.runner.run_projection_engine:217] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 07:35:58,604 [INFO    ] [cost_model.projections.runner.run_projection_engine:218] Summary Results:
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 07:35:58,604 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 07:35:58,604 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 07:35:58,604 [INFO    ] [cost_model.projections.reporting.save_detailed_results:82] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 07:35:58,614 [INFO    ] [cost_model.projections.reporting.save_detailed_results:110] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:35:58,614 [INFO    ] [cost_model.projections.cli.main:112] Generating and saving plots...
2025-05-10 07:35:58,614 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 07:35:58,614 [INFO    ] [cost_model.projections.cli.main:115] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 07:35:58,614 [INFO    ] [cost_model.projections.cli.main:116] All outputs saved in: output_dev/projection_cli_results
2025-05-10 07:43:51,597 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 07:43:51,597 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 07:43:51,602 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 07:43:51,602 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 07:43:51,602 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 07:43:51,602 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 07:43:51,653 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 07:43:51,659 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 07:43:51,659 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 07:43:51,659 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 07:43:51,661 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 07:43:51,661 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 07:43:51,661 [INFO    ] [cost_model.projections.runner.run_projection_engine:91] Running 5-year projection starting from 2025.
2025-05-10 07:43:51,661 [INFO    ] [cost_model.projections.runner.run_projection_engine:92] Random seed: 42
2025-05-10 07:43:51,661 [INFO    ] [cost_model.projections.runner._generate_hazard_table:36] Generating hazard table...
2025-05-10 07:43:51,663 [INFO    ] [cost_model.projections.runner._generate_hazard_table:50] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 07:43:51,663 [INFO    ] [cost_model.projections.runner._generate_hazard_table:67] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 07:43:51,663 [INFO    ] [cost_model.projections.runner.run_projection_engine:125] --- Simulating Year 2025 (Index 0) ---
2025-05-10 07:43:51,681 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 07:43:51,685 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 07:43:51,685 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2025] Survivors after main terminations: 150, Growth Rate from hazard: 0.0500, Target EOY headcount: 158
2025-05-10 07:43:51,686 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 07:43:51,686 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:43:51,688 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 07:43:51,696 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:43:51,696 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 07:43:51,697 [INFO    ] [cost_model.projections.runner.run_projection_engine:139] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 07:43:51,697 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] EOY 2025 - Events generated this year: 362
2025-05-10 07:43:51,700 [INFO    ] [cost_model.projections.runner.run_projection_engine:125] --- Simulating Year 2026 (Index 1) ---
2025-05-10 07:43:51,713 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 07:43:51,713 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 07:43:51,713 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 07:43:51,714 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 07:43:51,714 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 07:43:51,715 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 07:43:51,715 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 07:43:51,715 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 07:43:51,716 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 07:43:51,719 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:43:51,720 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2026] Survivors after main terminations: 158, Growth Rate from hazard: 0.0500, Target EOY headcount: 166
2025-05-10 07:43:51,720 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 07:43:51,721 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:43:51,722 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 07:43:51,729 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:43:51,729 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 07:43:51,731 [INFO    ] [cost_model.projections.runner.run_projection_engine:139] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 07:43:51,731 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] EOY 2026 - Events generated this year: 374
2025-05-10 07:43:51,734 [INFO    ] [cost_model.projections.runner.run_projection_engine:125] --- Simulating Year 2027 (Index 2) ---
2025-05-10 07:43:51,748 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 07:43:51,751 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:43:51,751 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2027] Survivors after main terminations: 166, Growth Rate from hazard: 0.0500, Target EOY headcount: 175
2025-05-10 07:43:51,751 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 07:43:51,752 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:43:51,753 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 07:43:51,759 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:43:51,760 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 07:43:51,761 [INFO    ] [cost_model.projections.runner.run_projection_engine:139] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 07:43:51,761 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] EOY 2027 - Events generated this year: 370
2025-05-10 07:43:51,764 [INFO    ] [cost_model.projections.runner.run_projection_engine:125] --- Simulating Year 2028 (Index 3) ---
2025-05-10 07:43:51,777 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 07:43:51,781 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:43:51,781 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2028] Survivors after main terminations: 175, Growth Rate from hazard: 0.0500, Target EOY headcount: 184
2025-05-10 07:43:51,781 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 07:43:51,782 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:43:51,783 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 07:43:51,789 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:43:51,789 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 07:43:51,790 [INFO    ] [cost_model.projections.runner.run_projection_engine:139] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 07:43:51,790 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] EOY 2028 - Events generated this year: 360
2025-05-10 07:43:51,793 [INFO    ] [cost_model.projections.runner.run_projection_engine:125] --- Simulating Year 2029 (Index 4) ---
2025-05-10 07:43:51,808 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 07:43:51,811 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:43:51,811 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2029] Survivors after main terminations: 184, Growth Rate from hazard: 0.0500, Target EOY headcount: 194
2025-05-10 07:43:51,811 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 07:43:51,812 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 07:43:51,813 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 07:43:51,820 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 07:43:51,820 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 07:43:51,821 [INFO    ] [cost_model.projections.runner.run_projection_engine:139] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 07:43:51,821 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] EOY 2029 - Events generated this year: 370
2025-05-10 07:43:51,824 [INFO    ] [cost_model.projections.runner.run_projection_engine:270] Projection engine run completed.
2025-05-10 07:43:51,824 [INFO    ] [cost_model.projections.runner.run_projection_engine:276] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 07:43:51,824 [INFO    ] [cost_model.projections.runner.run_projection_engine:277] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 07:43:51,824 [INFO    ] [cost_model.projections.runner.run_projection_engine:278] Summary Results:
2025-05-10 07:43:51,825 [INFO    ] [cost_model.projections.runner.run_projection_engine:279] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 07:43:51,825 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 07:43:51,825 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 07:43:51,825 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 07:43:51,827 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 07:43:51,831 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 07:43:51,832 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 07:43:51,832 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 07:57:54,547 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 07:57:54,548 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 07:57:54,552 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 07:57:54,552 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 07:57:54,552 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 07:57:54,552 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 07:57:54,613 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 07:57:54,619 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 07:57:54,619 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 07:57:54,619 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 07:57:54,621 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 07:57:54,621 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 07:57:54,621 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 07:57:54,621 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 07:57:54,621 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 07:57:54,623 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 07:57:54,623 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 07:57:54,623 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 07:57:54,644 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 07:57:54,648 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 07:57:54,649 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2025] Survivors after main terminations: 150, Growth Rate from hazard: 0.0500, Target EOY headcount: 158
2025-05-10 07:57:54,649 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 07:57:54,650 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:57:54,654 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 07:57:54,662 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:57:54,662 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 07:57:54,663 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 07:57:54,663 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 07:57:54,668 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 07:57:54,680 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 07:57:54,680 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 07:57:54,680 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 07:57:54,681 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 07:57:54,682 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 07:57:54,682 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 07:57:54,682 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 07:57:54,682 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 07:57:54,683 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 07:57:54,686 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:57:54,687 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2026] Survivors after main terminations: 158, Growth Rate from hazard: 0.0500, Target EOY headcount: 166
2025-05-10 07:57:54,687 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 07:57:54,688 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:57:54,689 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 07:57:54,695 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:57:54,696 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 07:57:54,697 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 07:57:54,697 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 07:57:54,701 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 07:57:54,713 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 07:57:54,716 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:57:54,716 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2027] Survivors after main terminations: 166, Growth Rate from hazard: 0.0500, Target EOY headcount: 175
2025-05-10 07:57:54,717 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 07:57:54,717 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:57:54,719 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 07:57:54,726 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:57:54,726 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 07:57:54,727 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 07:57:54,727 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 07:57:54,731 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 07:57:54,746 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 07:57:54,749 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:57:54,749 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2028] Survivors after main terminations: 175, Growth Rate from hazard: 0.0500, Target EOY headcount: 184
2025-05-10 07:57:54,749 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 07:57:54,750 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:57:54,751 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 07:57:54,757 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:57:54,757 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 07:57:54,759 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 07:57:54,759 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 07:57:54,762 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 07:57:54,776 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 07:57:54,779 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:57:54,779 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2029] Survivors after main terminations: 184, Growth Rate from hazard: 0.0500, Target EOY headcount: 194
2025-05-10 07:57:54,780 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 07:57:54,780 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 07:57:54,782 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 07:57:54,789 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 07:57:54,789 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 07:57:54,790 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 07:57:54,790 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 07:57:54,793 [INFO    ] [cost_model.projections.runner.run_projection_engine:279] Projection engine run completed.
2025-05-10 07:57:54,793 [INFO    ] [cost_model.projections.runner.run_projection_engine:285] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 07:57:54,793 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 07:57:54,793 [INFO    ] [cost_model.projections.runner.run_projection_engine:287] Summary Results:
2025-05-10 07:57:54,794 [INFO    ] [cost_model.projections.runner.run_projection_engine:288] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 07:57:54,794 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 07:57:54,795 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 07:57:54,795 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 07:57:54,796 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 07:57:54,800 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 07:57:54,800 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 07:58:26,346 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 07:58:26,346 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 07:58:26,352 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 07:58:26,352 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 07:58:26,352 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 07:58:26,352 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 07:58:26,411 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 07:58:26,419 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 07:58:26,420 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 07:58:26,420 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 07:58:26,422 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 07:58:26,422 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 07:58:26,422 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 07:58:26,422 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 07:58:26,422 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 07:58:26,424 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 07:58:26,424 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 07:58:26,424 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 07:58:26,443 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 07:58:26,448 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 07:58:26,448 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2025] Survivors after main terminations: 150, Growth Rate from hazard: 0.0500, Target EOY headcount: 158
2025-05-10 07:58:26,448 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 07:58:26,449 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:58:26,451 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 07:58:26,458 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:58:26,459 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 07:58:26,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 07:58:26,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 07:58:26,464 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 07:58:26,477 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 07:58:26,477 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 07:58:26,477 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 07:58:26,479 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 07:58:26,479 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 07:58:26,479 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 07:58:26,479 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 07:58:26,479 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 07:58:26,480 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 07:58:26,483 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 07:58:26,483 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2026] Survivors after main terminations: 158, Growth Rate from hazard: 0.0500, Target EOY headcount: 166
2025-05-10 07:58:26,484 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 07:58:26,484 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 07:58:26,485 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 07:58:26,493 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:58:26,493 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 07:58:26,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 07:58:26,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 07:58:26,497 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 07:58:26,511 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 07:58:26,514 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 07:58:26,514 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2027] Survivors after main terminations: 166, Growth Rate from hazard: 0.0500, Target EOY headcount: 175
2025-05-10 07:58:26,515 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 07:58:26,515 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:58:26,516 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 07:58:26,524 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:58:26,524 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 07:58:26,525 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 07:58:26,525 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 07:58:26,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 07:58:26,543 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 07:58:26,547 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 07:58:26,547 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2028] Survivors after main terminations: 175, Growth Rate from hazard: 0.0500, Target EOY headcount: 184
2025-05-10 07:58:26,547 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 07:58:26,548 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 07:58:26,549 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 07:58:26,557 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:58:26,557 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 07:58:26,558 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 07:58:26,558 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 07:58:26,561 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 07:58:26,577 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 07:58:26,580 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 07:58:26,580 [INFO    ] [cost_model.engines.run_one_year.run_one_year:134] [RUN_ONE_YEAR YR=2029] Survivors after main terminations: 184, Growth Rate from hazard: 0.0500, Target EOY headcount: 194
2025-05-10 07:58:26,581 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 07:58:26,581 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 07:58:26,582 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 07:58:26,589 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 07:58:26,590 [WARNING ] [cost_model.engines.run_one_year.run_one_year:183] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 07:58:26,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 07:58:26,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 07:58:26,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:279] Projection engine run completed.
2025-05-10 07:58:26,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:285] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 07:58:26,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 07:58:26,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:287] Summary Results:
2025-05-10 07:58:26,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:288] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 07:58:26,596 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 07:58:26,596 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 07:58:26,596 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 07:58:26,598 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 07:58:26,602 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 07:58:26,602 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:03:47,343 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:03:47,343 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:03:47,348 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:03:47,348 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:03:47,348 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:03:47,349 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:03:47,409 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:03:47,419 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:03:47,419 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:03:47,419 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:03:47,420 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:03:47,420 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:03:47,420 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:03:47,420 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:03:47,421 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:03:47,423 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:03:47,423 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:03:47,424 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:03:47,444 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:03:47,449 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:03:47,450 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:03:47,450 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:03:47,450 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:03:47,451 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:03:47,453 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:03:47,461 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:03:47,461 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:03:47,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:03:47,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:03:47,466 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:03:47,480 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:03:47,480 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:03:47,480 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:03:47,481 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:03:47,481 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:03:47,482 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:03:47,482 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:03:47,482 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:03:47,483 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:03:47,486 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:03:47,486 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:03:47,486 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2026] Target from BOY: 166, Target from survivors: 166, Final target: 166
2025-05-10 08:03:47,487 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:03:47,487 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:03:47,488 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:03:47,495 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:03:47,495 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:03:47,496 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:03:47,496 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:03:47,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:03:47,514 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:03:47,517 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:03:47,517 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:03:47,517 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2027] Target from BOY: 175, Target from survivors: 175, Final target: 175
2025-05-10 08:03:47,518 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:03:47,518 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:03:47,519 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:03:47,526 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:03:47,526 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:03:47,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:03:47,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:03:47,531 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:03:47,544 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:03:47,547 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:03:47,548 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:03:47,548 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2028] Target from BOY: 184, Target from survivors: 184, Final target: 184
2025-05-10 08:03:47,548 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:03:47,549 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:03:47,550 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:03:47,557 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:03:47,558 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:03:47,559 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:03:47,559 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:03:47,562 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:03:47,577 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:03:47,580 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:03:47,580 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:03:47,580 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2029] Target from BOY: 194, Target from survivors: 194, Final target: 194
2025-05-10 08:03:47,581 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:03:47,581 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:03:47,582 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:03:47,589 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:03:47,590 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:03:47,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:03:47,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:03:47,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:279] Projection engine run completed.
2025-05-10 08:03:47,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:285] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:03:47,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:03:47,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:287] Summary Results:
2025-05-10 08:03:47,596 [INFO    ] [cost_model.projections.runner.run_projection_engine:288] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:03:47,596 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:03:47,596 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:03:47,596 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:03:47,598 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 08:03:47,601 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 08:03:47,601 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 08:03:47,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 08:03:47,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:03:47,602 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:03:47,602 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:03:47,602 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 08:03:47,602 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:03:47,602 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:03:47,602 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:04:06,447 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:04:06,447 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:04:06,452 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:04:06,452 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:04:06,452 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:04:06,452 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:04:06,504 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:04:06,513 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:04:06,513 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:04:06,513 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:04:06,514 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:04:06,514 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:04:06,514 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:04:06,514 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:04:06,515 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:04:06,516 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:04:06,516 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:04:06,517 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:04:06,533 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:04:06,537 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:04:06,538 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:04:06,538 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:04:06,538 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:04:06,539 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:04:06,541 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:04:06,548 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:04:06,548 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:04:06,549 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:04:06,549 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:04:06,553 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:04:06,566 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:04:06,566 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:04:06,566 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:04:06,567 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:04:06,567 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:04:06,567 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:04:06,568 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:04:06,568 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:04:06,568 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:04:06,571 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:04:06,572 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:04:06,572 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2026] Target from BOY: 166, Target from survivors: 166, Final target: 166
2025-05-10 08:04:06,572 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:04:06,573 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:04:06,574 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:04:06,581 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:04:06,581 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:04:06,582 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:04:06,582 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:04:06,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:04:06,598 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:04:06,601 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:04:06,602 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:04:06,602 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2027] Target from BOY: 175, Target from survivors: 175, Final target: 175
2025-05-10 08:04:06,602 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:04:06,603 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:04:06,604 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:04:06,611 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:04:06,612 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:04:06,613 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:04:06,613 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:04:06,616 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:04:06,629 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:04:06,632 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:04:06,633 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:04:06,633 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2028] Target from BOY: 184, Target from survivors: 184, Final target: 184
2025-05-10 08:04:06,633 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:04:06,634 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:04:06,635 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:04:06,642 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:04:06,642 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:04:06,643 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:04:06,643 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:04:06,646 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:04:06,660 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:04:06,664 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:04:06,664 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:04:06,664 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2029] Target from BOY: 194, Target from survivors: 194, Final target: 194
2025-05-10 08:04:06,665 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:04:06,665 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:04:06,666 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:04:06,673 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:04:06,673 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:04:06,674 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:04:06,674 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:04:06,677 [INFO    ] [cost_model.projections.runner.run_projection_engine:279] Projection engine run completed.
2025-05-10 08:04:06,677 [INFO    ] [cost_model.projections.runner.run_projection_engine:285] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:04:06,677 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:04:06,677 [INFO    ] [cost_model.projections.runner.run_projection_engine:287] Summary Results:
2025-05-10 08:04:06,678 [INFO    ] [cost_model.projections.runner.run_projection_engine:288] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:04:06,679 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:04:06,679 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:04:06,679 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:04:06,680 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 08:04:06,683 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 08:04:06,684 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:04:06,684 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:05:04,817 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:05:04,818 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:05:04,822 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:05:04,822 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:05:04,822 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:05:04,822 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:05:04,878 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:05:04,884 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:05:04,885 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:05:04,885 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:05:04,887 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:05:04,887 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:05:04,887 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:05:04,887 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:05:04,887 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:05:04,889 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:05:04,889 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:05:04,889 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:05:04,906 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:05:04,910 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:05:04,911 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:05:04,911 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:05:04,911 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:05:04,912 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:05:04,913 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:05:04,921 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:05:04,921 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:05:04,922 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:05:04,922 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:05:04,924 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:04,924 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:04,924 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:05:04,924 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:05:04,925 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:05:04,925 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:05:04,926 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:05:04,937 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:05:04,938 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:05:04,938 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:05:04,938 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:05:04,939 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:05:04,939 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:05:04,939 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:05:04,939 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:05:04,940 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:05:04,943 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:05:04,943 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:05:04,943 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2026] Target from BOY: 166, Target from survivors: 166, Final target: 166
2025-05-10 08:05:04,944 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:05:04,944 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:05:04,945 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:05:04,952 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:05:04,952 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:05:04,953 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:05:04,953 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:05:04,955 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:04,955 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:04,955 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:05:04,955 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:05:04,956 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:05:04,956 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:05:04,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:05:04,971 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:05:04,974 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:05:04,974 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:05:04,974 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2027] Target from BOY: 175, Target from survivors: 175, Final target: 175
2025-05-10 08:05:04,975 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:05:04,975 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:05:04,976 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:05:04,987 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:05:04,988 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:05:04,990 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:05:04,990 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:05:04,995 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:04,995 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:04,995 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:05:04,995 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:05:04,996 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:05:04,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:05:04,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:05:05,015 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:05:05,018 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:05:05,019 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:05:05,019 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2028] Target from BOY: 184, Target from survivors: 184, Final target: 184
2025-05-10 08:05:05,020 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:05:05,020 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:05:05,022 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:05:05,030 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:05:05,030 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:05:05,032 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:05:05,032 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:05:05,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:05,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:05,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:05:05,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:05:05,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:05:05,035 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:05:05,035 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:05:05,051 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:05:05,054 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:05:05,055 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:05:05,055 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2029] Target from BOY: 194, Target from survivors: 194, Final target: 194
2025-05-10 08:05:05,055 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:05:05,056 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:05:05,057 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:05:05,065 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:05:05,065 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:05:05,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:05:05,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:05:05,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:05,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:05,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:05:05,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:05:05,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:05:05,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:05:05,070 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] Projection engine run completed.
2025-05-10 08:05:05,070 [INFO    ] [cost_model.projections.runner.run_projection_engine:292] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:05:05,070 [INFO    ] [cost_model.projections.runner.run_projection_engine:293] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:05:05,070 [INFO    ] [cost_model.projections.runner.run_projection_engine:294] Summary Results:
2025-05-10 08:05:05,071 [INFO    ] [cost_model.projections.runner.run_projection_engine:295] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:05:05,071 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:05:05,071 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:05:05,071 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:05:05,073 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 08:05:05,076 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 08:05:05,076 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 08:05:05,077 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 08:05:05,077 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:05:05,077 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:05:05,077 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:05:05,077 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 08:05:05,077 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:05:05,077 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:05:05,077 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:05:54,250 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:05:54,250 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:05:54,254 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:05:54,254 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:05:54,254 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:05:54,254 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:05:54,275 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:05:54,278 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:05:54,279 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:05:54,279 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:05:54,280 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:05:54,280 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:05:54,280 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:05:54,280 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:05:54,280 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:05:54,281 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:05:54,281 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:05:54,281 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:05:54,296 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:05:54,299 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:05:54,300 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:05:54,300 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:05:54,300 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:05:54,301 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:05:54,302 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:05:54,309 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:05:54,309 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:05:54,310 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:05:54,310 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:05:54,312 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:54,312 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:54,312 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:05:54,312 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:05:54,313 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:05:54,313 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:05:54,313 [INFO    ] [cost_model.projections.runner.run_projection_engine:246] [RUNNER EMP_STATUS_SUM YR=2025] Found 1 new hires by comparing BOY and EOY snapshots
2025-05-10 08:05:54,313 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=1, Total Active=128
2025-05-10 08:05:54,314 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:05:54,327 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:05:54,327 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:05:54,327 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:05:54,328 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:05:54,328 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:05:54,328 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:05:54,328 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:05:54,328 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:05:54,329 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:05:54,332 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:05:54,332 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:05:54,332 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2026] Target from BOY: 166, Target from survivors: 166, Final target: 166
2025-05-10 08:05:54,333 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:05:54,333 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:05:54,334 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:05:54,340 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:05:54,341 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:05:54,342 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:05:54,342 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:05:54,344 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:54,344 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:54,344 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:05:54,344 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:05:54,344 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:05:54,345 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:05:54,345 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2026] Using event log for new hire IDs instead of snapshot comparison
2025-05-10 08:05:54,345 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=103, New Hire=0, Total Active=103
2025-05-10 08:05:54,346 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:05:54,360 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:05:54,362 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:05:54,363 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:05:54,363 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2027] Target from BOY: 175, Target from survivors: 175, Final target: 175
2025-05-10 08:05:54,363 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:05:54,363 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:05:54,364 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:05:54,371 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:05:54,371 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:05:54,372 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:05:54,372 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:05:54,374 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:54,374 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:54,374 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:05:54,374 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:05:54,375 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:05:54,375 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:05:54,375 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2027] Using event log for new hire IDs instead of snapshot comparison
2025-05-10 08:05:54,375 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=87, New Hire=0, Total Active=87
2025-05-10 08:05:54,376 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:05:54,390 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:05:54,393 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:05:54,393 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:05:54,393 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2028] Target from BOY: 184, Target from survivors: 184, Final target: 184
2025-05-10 08:05:54,393 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:05:54,394 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:05:54,395 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:05:54,401 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:05:54,402 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:05:54,403 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:05:54,403 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:05:54,404 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:54,404 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:54,405 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:05:54,405 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:05:54,405 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:05:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:05:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2028] Using event log for new hire IDs instead of snapshot comparison
2025-05-10 08:05:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=78, New Hire=0, Total Active=78
2025-05-10 08:05:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:05:54,420 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:05:54,423 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:05:54,424 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:05:54,424 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2029] Target from BOY: 194, Target from survivors: 194, Final target: 194
2025-05-10 08:05:54,424 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:05:54,424 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:05:54,425 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:05:54,432 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:05:54,432 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:05:54,433 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:05:54,433 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:05:54,435 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:05:54,435 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:05:54,435 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:05:54,435 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:05:54,435 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:05:54,436 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:05:54,436 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2029] Using event log for new hire IDs instead of snapshot comparison
2025-05-10 08:05:54,436 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=66, New Hire=0, Total Active=66
2025-05-10 08:05:54,437 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] Projection engine run completed.
2025-05-10 08:05:54,437 [INFO    ] [cost_model.projections.runner.run_projection_engine:316] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:05:54,437 [INFO    ] [cost_model.projections.runner.run_projection_engine:317] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:05:54,437 [INFO    ] [cost_model.projections.runner.run_projection_engine:318] Summary Results:
2025-05-10 08:05:54,438 [INFO    ] [cost_model.projections.runner.run_projection_engine:319] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:05:54,438 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:05:54,438 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:05:54,438 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:05:54,439 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 08:05:54,442 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 08:05:54,443 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:05:54,443 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:06:46,103 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:06:46,103 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:06:46,108 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:06:46,108 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:06:46,108 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:06:46,108 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:06:46,130 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:06:46,133 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:06:46,133 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:06:46,133 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:06:46,134 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:06:46,134 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:06:46,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:06:46,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:06:46,135 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:06:46,136 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:06:46,136 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:06:46,136 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:06:46,151 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:06:46,155 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:06:46,155 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:06:46,155 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:06:46,156 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:06:46,156 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:06:46,157 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:06:46,165 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:06:46,166 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:06:46,167 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:06:46,167 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:06:46,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:06:46,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:06:46,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:06:46,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:06:46,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:06:46,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:06:46,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:239] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 135
2025-05-10 08:06:46,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:06:46,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=8, Total Active=135
2025-05-10 08:06:46,170 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:06:46,183 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:06:46,183 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:06:46,183 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:06:46,184 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:06:46,184 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:06:46,184 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:06:46,184 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:06:46,184 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:06:46,185 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:06:46,188 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:06:46,188 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:06:46,188 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2026] Target from BOY: 166, Target from survivors: 166, Final target: 166
2025-05-10 08:06:46,188 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:06:46,189 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:06:46,190 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:06:46,197 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:06:46,197 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:06:46,198 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:06:46,198 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:06:46,200 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:06:46,200 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:06:46,200 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:06:46,200 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:06:46,201 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:06:46,201 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:06:46,201 [INFO    ] [cost_model.projections.runner.run_projection_engine:239] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 118
2025-05-10 08:06:46,201 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:06:46,201 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=110, New Hire=8, Total Active=118
2025-05-10 08:06:46,202 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:06:46,215 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:06:46,218 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:06:46,219 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:06:46,219 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2027] Target from BOY: 175, Target from survivors: 175, Final target: 175
2025-05-10 08:06:46,219 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:06:46,219 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:06:46,220 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:06:46,227 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:06:46,227 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:06:46,228 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:06:46,228 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:06:46,230 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:06:46,230 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:06:46,230 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:06:46,230 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:06:46,230 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:06:46,231 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:06:46,231 [INFO    ] [cost_model.projections.runner.run_projection_engine:239] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 111
2025-05-10 08:06:46,231 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:06:46,231 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:06:46,231 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:06:46,246 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:06:46,249 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:06:46,250 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:06:46,250 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2028] Target from BOY: 184, Target from survivors: 184, Final target: 184
2025-05-10 08:06:46,250 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:06:46,251 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:06:46,252 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:06:46,260 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:06:46,260 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:06:46,261 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:06:46,261 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:06:46,263 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:06:46,263 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:06:46,264 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:06:46,264 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:06:46,264 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:06:46,265 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:06:46,265 [INFO    ] [cost_model.projections.runner.run_projection_engine:239] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 111
2025-05-10 08:06:46,265 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:06:46,265 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:06:46,265 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:06:46,279 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:06:46,282 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:06:46,283 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:06:46,283 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2029] Target from BOY: 194, Target from survivors: 194, Final target: 194
2025-05-10 08:06:46,283 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:06:46,284 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:06:46,285 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:06:46,292 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:06:46,293 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:06:46,293 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:06:46,293 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:06:46,295 [INFO    ] [cost_model.projections.runner.run_projection_engine:213] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:06:46,295 [INFO    ] [cost_model.projections.runner.run_projection_engine:214] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:06:46,295 [INFO    ] [cost_model.projections.runner.run_projection_engine:215] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:06:46,295 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:06:46,296 [INFO    ] [cost_model.projections.runner.run_projection_engine:224] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:06:46,296 [INFO    ] [cost_model.projections.runner.run_projection_engine:226] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:06:46,296 [INFO    ] [cost_model.projections.runner.run_projection_engine:239] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 109
2025-05-10 08:06:46,296 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:06:46,296 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=99, New Hire=10, Total Active=109
2025-05-10 08:06:46,297 [INFO    ] [cost_model.projections.runner.run_projection_engine:311] Projection engine run completed.
2025-05-10 08:06:46,297 [INFO    ] [cost_model.projections.runner.run_projection_engine:317] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:06:46,297 [INFO    ] [cost_model.projections.runner.run_projection_engine:318] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:06:46,297 [INFO    ] [cost_model.projections.runner.run_projection_engine:319] Summary Results:
2025-05-10 08:06:46,298 [INFO    ] [cost_model.projections.runner.run_projection_engine:320] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:06:46,298 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:06:46,298 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:06:46,298 [INFO    ] [cost_model.projections.reporting.save_detailed_results:80] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:06:46,299 [INFO    ] [cost_model.projections.reporting.save_detailed_results:86] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.csv
2025-05-10 08:06:46,302 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.csv
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.csv
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.csv
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.reporting.save_detailed_results:108] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.cli.main:112] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.cli.main:114] Generating and saving plots...
2025-05-10 08:06:46,303 [WARNING ] [cost_model.projections.reporting.plot_projection_results:22] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.cli.main:117] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:06:46,303 [INFO    ] [cost_model.projections.cli.main:118] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:13:25,768 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:13:25,768 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:13:25,773 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:13:25,773 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:13:25,773 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:13:25,773 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:13:25,825 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:13:25,833 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:13:25,834 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:13:25,834 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:13:25,835 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:13:25,835 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:13:25,835 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:13:25,835 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:13:25,835 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:13:25,837 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:13:25,838 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:13:25,838 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:13:25,856 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:13:25,860 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:13:25,860 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:13:25,860 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:13:25,861 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:13:25,861 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:13:25,863 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:13:25,870 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:13:25,871 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:13:25,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:13:25,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:13:25,873 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: Must have equal len keys and value when setting with an iterable
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 154, in run_projection_engine
    comprehensive_snapshot.loc[comprehensive_snapshot[EMP_ID] == emp_id] = eoy_snapshot[eoy_snapshot[EMP_ID] == emp_id].iloc[0]
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/indexing.py", line 911, in __setitem__
    iloc._setitem_with_indexer(indexer, value, self.name)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/indexing.py", line 1942, in _setitem_with_indexer
    self._setitem_with_indexer_split_path(indexer, value, name)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/indexing.py", line 2027, in _setitem_with_indexer_split_path
    raise ValueError(
ValueError: Must have equal len keys and value when setting with an iterable
2025-05-10 08:13:59,543 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:13:59,544 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:13:59,549 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:13:59,549 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:13:59,549 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:13:59,549 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:13:59,610 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:13:59,618 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:13:59,618 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:13:59,619 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:13:59,620 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:13:59,620 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:13:59,620 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:13:59,620 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:13:59,620 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:13:59,622 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:13:59,622 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:13:59,623 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:13:59,641 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:13:59,646 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:13:59,647 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:13:59,647 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:13:59,647 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:13:59,648 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:13:59,650 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:13:59,658 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:13:59,659 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:13:59,660 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:13:59,660 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:13:59,769 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2025 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:13:59,770 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:13:59,771 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:13:59,771 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:13:59,771 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:13:59,771 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:13:59,772 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:13:59,772 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 135
2025-05-10 08:13:59,772 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:13:59,772 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=8, Total Active=135
2025-05-10 08:13:59,773 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:13:59,786 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:13:59,786 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:13:59,786 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:13:59,787 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:13:59,788 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:13:59,788 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:13:59,788 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:13:59,788 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:13:59,789 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:13:59,791 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:13:59,792 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:13:59,792 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2026] Target from BOY: 166, Target from survivors: 166, Final target: 166
2025-05-10 08:13:59,792 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:13:59,793 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:13:59,794 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:13:59,800 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:13:59,801 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:13:59,802 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:13:59,802 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:13:59,927 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2026 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:13:59,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:13:59,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:13:59,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:13:59,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:13:59,930 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:13:59,930 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:13:59,930 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 118
2025-05-10 08:13:59,930 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:13:59,930 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=110, New Hire=8, Total Active=118
2025-05-10 08:13:59,931 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:13:59,944 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:13:59,947 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:13:59,947 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:13:59,947 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2027] Target from BOY: 175, Target from survivors: 175, Final target: 175
2025-05-10 08:13:59,948 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:13:59,948 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:13:59,949 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:13:59,956 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:13:59,957 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:13:59,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:13:59,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:14:00,064 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2027 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:14:00,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:14:00,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:14:00,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:14:00,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:14:00,067 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:14:00,067 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:14:00,067 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 111
2025-05-10 08:14:00,067 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:14:00,067 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:14:00,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:14:00,082 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:14:00,085 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:14:00,085 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:14:00,085 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2028] Target from BOY: 184, Target from survivors: 184, Final target: 184
2025-05-10 08:14:00,085 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:14:00,086 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:14:00,087 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:14:00,094 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:14:00,095 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:14:00,096 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:14:00,096 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:14:00,204 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2028 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:14:00,206 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:14:00,206 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:14:00,206 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:14:00,206 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:14:00,207 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:14:00,207 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:14:00,207 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 111
2025-05-10 08:14:00,207 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:14:00,207 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:14:00,208 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:14:00,223 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:14:00,226 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:14:00,227 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:14:00,227 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2029] Target from BOY: 194, Target from survivors: 194, Final target: 194
2025-05-10 08:14:00,227 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:14:00,228 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:14:00,229 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:14:00,236 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:14:00,236 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:14:00,237 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:14:00,237 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:14:00,347 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2029 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:14:00,349 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:14:00,349 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:14:00,349 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:14:00,349 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:14:00,349 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:14:00,350 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:14:00,350 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 109
2025-05-10 08:14:00,350 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:14:00,350 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=99, New Hire=10, Total Active=109
2025-05-10 08:14:00,351 [INFO    ] [cost_model.projections.runner.run_projection_engine:354] Projection engine run completed.
2025-05-10 08:14:00,351 [INFO    ] [cost_model.projections.runner.run_projection_engine:360] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:14:00,351 [INFO    ] [cost_model.projections.runner.run_projection_engine:361] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:14:00,351 [INFO    ] [cost_model.projections.runner.run_projection_engine:362] Summary Results:
2025-05-10 08:14:00,352 [INFO    ] [cost_model.projections.runner.run_projection_engine:363] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:14:00,352 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:14:00,352 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:14:00,352 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:14:00,359 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:14:00,361 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:14:00,362 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:14:00,363 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:14:00,368 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:14:00,371 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:14:00,371 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:14:00,371 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:14:00,371 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:14:00,371 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:14:00,371 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:14:00,371 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:15:00,680 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:15:00,681 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:15:00,685 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:15:00,685 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:15:00,685 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:15:00,685 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:15:00,707 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:15:00,711 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:15:00,711 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:15:00,711 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:15:00,712 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:15:00,712 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:15:00,712 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:15:00,712 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:15:00,713 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:15:00,714 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:15:00,714 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:15:00,715 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:15:00,732 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:15:00,735 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:15:00,736 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:15:00,736 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2025] Target from BOY: 158, Target from survivors: 158, Final target: 158
2025-05-10 08:15:00,736 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:15:00,737 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:15:00,739 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:15:00,746 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:15:00,746 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:15:00,747 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:15:00,747 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:15:00,857 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2025 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:15:00,859 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:15:00,859 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:15:00,859 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:15:00,860 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:15:00,860 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:15:00,861 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:15:00,861 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 135
2025-05-10 08:15:00,861 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:15:00,861 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=8, Total Active=135
2025-05-10 08:15:00,861 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:15:00,873 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:15:00,873 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:15:00,873 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:15:00,874 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:15:00,875 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:15:00,875 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:15:00,875 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:15:00,875 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:15:00,876 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:15:00,878 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:15:00,879 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:15:00,879 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2026] Target from BOY: 166, Target from survivors: 166, Final target: 166
2025-05-10 08:15:00,879 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:15:00,880 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:15:00,881 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:15:00,888 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:15:00,888 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:15:00,889 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:15:00,889 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:15:00,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2026 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:15:00,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:15:00,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:15:00,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:15:00,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:15:00,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:15:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:15:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 118
2025-05-10 08:15:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:15:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=110, New Hire=8, Total Active=118
2025-05-10 08:15:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:15:01,014 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:15:01,017 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:15:01,017 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:15:01,017 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2027] Target from BOY: 175, Target from survivors: 175, Final target: 175
2025-05-10 08:15:01,017 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:15:01,018 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:15:01,019 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:15:01,026 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:15:01,026 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:15:01,027 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:15:01,027 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:15:01,131 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2027 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:15:01,133 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:15:01,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:15:01,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:15:01,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:15:01,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:15:01,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:15:01,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 111
2025-05-10 08:15:01,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:15:01,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:15:01,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:15:01,149 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:15:01,151 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:15:01,152 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:15:01,152 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2028] Target from BOY: 184, Target from survivors: 184, Final target: 184
2025-05-10 08:15:01,152 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:15:01,152 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:15:01,154 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:15:01,160 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:15:01,160 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:15:01,161 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:15:01,161 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:15:01,270 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2028 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:15:01,272 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:15:01,272 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:15:01,272 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:15:01,272 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:15:01,272 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:15:01,273 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:15:01,273 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 111
2025-05-10 08:15:01,273 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:15:01,273 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:15:01,274 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:15:01,288 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:15:01,291 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:15:01,291 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:15:01,291 [INFO    ] [cost_model.engines.run_one_year.run_one_year:152] [RUN_ONE_YEAR YR=2029] Target from BOY: 194, Target from survivors: 194, Final target: 194
2025-05-10 08:15:01,292 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:15:01,292 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:15:01,293 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:15:01,300 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:15:01,300 [WARNING ] [cost_model.engines.run_one_year.run_one_year:201] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:15:01,301 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:15:01,301 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:15:01,411 [INFO    ] [cost_model.projections.runner.run_projection_engine:177] Year 2029 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:15:01,413 [INFO    ] [cost_model.projections.runner.run_projection_engine:256] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:15:01,413 [INFO    ] [cost_model.projections.runner.run_projection_engine:257] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:15:01,413 [INFO    ] [cost_model.projections.runner.run_projection_engine:258] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:15:01,413 [INFO    ] [cost_model.projections.runner.run_projection_engine:259] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:15:01,413 [INFO    ] [cost_model.projections.runner.run_projection_engine:267] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:269] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:282] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 109
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:286] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:310] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=99, New Hire=10, Total Active=109
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:354] Projection engine run completed.
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:360] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:361] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:15:01,414 [INFO    ] [cost_model.projections.runner.run_projection_engine:362] Summary Results:
2025-05-10 08:15:01,415 [INFO    ] [cost_model.projections.runner.run_projection_engine:363] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:15:01,416 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:15:01,416 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:15:01,416 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:15:01,420 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:15:01,422 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:15:01,423 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:15:01,424 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:15:01,428 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:15:01,430 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:15:01,430 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:15:01,430 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:15:01,430 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:15:01,430 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:15:01,431 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:15:01,431 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:18:31,950 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:18:31,950 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:18:31,954 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:18:31,955 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:18:31,955 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:18:31,955 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:18:32,006 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:18:32,015 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:18:32,016 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:18:32,016 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:18:32,017 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:18:32,017 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:18:32,017 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:18:32,017 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:18:32,017 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:18:32,019 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:18:32,019 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:18:32,019 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:18:32,037 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:18:32,041 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:18:32,042 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:18:32,042 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2025] Growth Target: 158, Hires needed: 8, Final target: 158
2025-05-10 08:18:32,042 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:18:32,043 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:18:32,045 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:18:32,053 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:18:32,054 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:18:32,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:18:32,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:18:32,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2025 - Found 46 termination events
2025-05-10 08:18:32,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:221] Year 2025 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:18:32,058 [INFO    ] [cost_model.projections.runner.run_projection_engine:300] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:18:32,059 [INFO    ] [cost_model.projections.runner.run_projection_engine:301] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:18:32,059 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:18:32,059 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:18:32,059 [INFO    ] [cost_model.projections.runner.run_projection_engine:311] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:18:32,060 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:18:32,060 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 135
2025-05-10 08:18:32,060 [INFO    ] [cost_model.projections.runner.run_projection_engine:330] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:18:32,060 [INFO    ] [cost_model.projections.runner.run_projection_engine:354] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=8, Total Active=135
2025-05-10 08:18:32,060 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:18:32,073 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:18:32,073 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:18:32,073 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:18:32,073 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:18:32,074 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:18:32,074 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:18:32,074 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:18:32,074 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:18:32,075 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:18:32,078 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:18:32,079 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:18:32,079 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2026] Growth Target: 166, Hires needed: 8, Final target: 166
2025-05-10 08:18:32,079 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:18:32,079 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:18:32,080 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:18:32,088 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:18:32,088 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:18:32,089 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:18:32,090 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:18:32,090 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2026 - Found 58 termination events
2025-05-10 08:18:32,091 [INFO    ] [cost_model.projections.runner.run_projection_engine:221] Year 2026 - Comprehensive snapshot shape: (166, 12), includes all employees with compensation during the year
2025-05-10 08:18:32,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:300] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:18:32,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:301] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:18:32,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:18:32,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:18:32,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:311] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:18:32,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:18:32,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 118
2025-05-10 08:18:32,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:330] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:18:32,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:354] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=110, New Hire=8, Total Active=118
2025-05-10 08:18:32,095 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:18:32,109 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:18:32,113 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:18:32,113 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:18:32,113 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2027] Growth Target: 175, Hires needed: 9, Final target: 175
2025-05-10 08:18:32,113 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:18:32,114 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:18:32,115 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:18:32,122 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:18:32,122 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:18:32,123 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:18:32,123 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:18:32,123 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2027 - Found 52 termination events
2025-05-10 08:18:32,124 [INFO    ] [cost_model.projections.runner.run_projection_engine:221] Year 2027 - Comprehensive snapshot shape: (175, 12), includes all employees with compensation during the year
2025-05-10 08:18:32,126 [INFO    ] [cost_model.projections.runner.run_projection_engine:300] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:18:32,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:301] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:18:32,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:18:32,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:18:32,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:311] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:18:32,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:18:32,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 111
2025-05-10 08:18:32,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:330] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:18:32,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:354] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:18:32,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:18:32,142 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:18:32,145 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:18:32,146 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:18:32,146 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2028] Growth Target: 184, Hires needed: 9, Final target: 184
2025-05-10 08:18:32,146 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:18:32,147 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:18:32,148 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:18:32,155 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:18:32,155 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:18:32,156 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:18:32,156 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:18:32,156 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2028 - Found 42 termination events
2025-05-10 08:18:32,157 [INFO    ] [cost_model.projections.runner.run_projection_engine:221] Year 2028 - Comprehensive snapshot shape: (184, 12), includes all employees with compensation during the year
2025-05-10 08:18:32,159 [INFO    ] [cost_model.projections.runner.run_projection_engine:300] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:18:32,159 [INFO    ] [cost_model.projections.runner.run_projection_engine:301] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:18:32,159 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:18:32,159 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:18:32,159 [INFO    ] [cost_model.projections.runner.run_projection_engine:311] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:18:32,160 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:18:32,160 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 111
2025-05-10 08:18:32,160 [INFO    ] [cost_model.projections.runner.run_projection_engine:330] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:18:32,160 [INFO    ] [cost_model.projections.runner.run_projection_engine:354] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:18:32,160 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:18:32,175 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:18:32,178 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:18:32,179 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:18:32,179 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2029] Growth Target: 194, Hires needed: 10, Final target: 194
2025-05-10 08:18:32,179 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:18:32,180 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:18:32,181 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:18:32,188 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:18:32,188 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:18:32,189 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:18:32,189 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:18:32,189 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2029 - Found 50 termination events
2025-05-10 08:18:32,190 [INFO    ] [cost_model.projections.runner.run_projection_engine:221] Year 2029 - Comprehensive snapshot shape: (194, 12), includes all employees with compensation during the year
2025-05-10 08:18:32,192 [INFO    ] [cost_model.projections.runner.run_projection_engine:300] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:18:32,192 [INFO    ] [cost_model.projections.runner.run_projection_engine:301] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:18:32,192 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:18:32,192 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:18:32,192 [INFO    ] [cost_model.projections.runner.run_projection_engine:311] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 109
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:330] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:354] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=99, New Hire=10, Total Active=109
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:398] Projection engine run completed.
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:404] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:405] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:18:32,193 [INFO    ] [cost_model.projections.runner.run_projection_engine:406] Summary Results:
2025-05-10 08:18:32,194 [INFO    ] [cost_model.projections.runner.run_projection_engine:407] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:18:32,195 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:18:32,195 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:18:32,195 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:18:32,203 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:18:32,205 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:18:32,206 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:18:32,207 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:18:32,211 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:18:32,214 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:18:32,214 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:18:32,214 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:18:32,214 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:18:32,214 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:18:32,214 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:18:32,214 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:19:42,900 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:19:42,900 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:19:42,905 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:19:42,905 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:19:42,905 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:19:42,905 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:19:42,955 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:19:42,961 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:19:42,961 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:19:42,961 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:19:42,962 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:19:42,962 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:19:42,962 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:19:42,962 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:19:42,962 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:19:42,964 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:19:42,964 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:19:42,964 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:19:42,980 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:19:42,985 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:19:42,985 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2025] BOY Active: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:19:42,985 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2025] Growth Target: 158, Hires needed: 8, Final target: 158
2025-05-10 08:19:42,986 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:19:42,986 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:19:42,988 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:19:42,995 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:19:42,996 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2025 - Found 46 termination events
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:19:42,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:19:42,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:19:42,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:19:42,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:19:42,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:19:42,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:19:42,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:19:42,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:19:42,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:19:43,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:19:43,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:19:43,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:19:43,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:19:43,002 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_189765_000194 in EOY data
2025-05-10 08:19:43,002 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:19:43,002 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:19:43,003 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:19:43,003 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:19:43,003 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_542881_000225 in EOY data
2025-05-10 08:19:43,004 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:19:43,004 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:19:43,004 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:19:43,005 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:19:43,005 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:19:43,005 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:19:43,006 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:19:43,006 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:19:43,006 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:19:43,007 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:19:43,007 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_376781_000092 in EOY data
2025-05-10 08:19:43,007 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:19:43,007 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2025 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:19:43,009 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:19:43,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:19:43,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:19:43,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:19:43,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:19:43,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:19:43,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 135
2025-05-10 08:19:43,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:19:43,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=8, Total Active=135
2025-05-10 08:19:43,012 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:19:43,023 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:19:43,023 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:19:43,023 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:19:43,024 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:19:43,025 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:19:43,025 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:19:43,025 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:19:43,025 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:19:43,025 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:19:43,028 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:19:43,028 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2026] BOY Active: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:19:43,028 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2026] Growth Target: 166, Hires needed: 8, Final target: 166
2025-05-10 08:19:43,029 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:19:43,029 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:19:43,030 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:19:43,037 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:19:43,038 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2026 - Found 58 termination events
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_517930_000140
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:19:43,039 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_960846_000153
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:19:43,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_517930_000140
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:19:43,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_960846_000153
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:19:43,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_554513_000013 in EOY data
2025-05-10 08:19:43,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:19:43,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:19:43,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_517930_000140 in EOY data
2025-05-10 08:19:43,044 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:19:43,044 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_820606_000155 in EOY data
2025-05-10 08:19:43,044 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_892526_000162 in EOY data
2025-05-10 08:19:43,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_383697_000180 in EOY data
2025-05-10 08:19:43,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:19:43,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_926080_000203 in EOY data
2025-05-10 08:19:43,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:19:43,046 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:19:43,046 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:19:43,046 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:19:43,047 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:19:43,047 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:19:43,047 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_194336_000237 in EOY data
2025-05-10 08:19:43,048 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_225724_000240 in EOY data
2025-05-10 08:19:43,048 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:19:43,048 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:19:43,049 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:19:43,049 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:19:43,049 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_128328_000187 in EOY data
2025-05-10 08:19:43,050 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:19:43,050 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:19:43,050 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_960846_000153 in EOY data
2025-05-10 08:19:43,051 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:19:43,051 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:19:43,052 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:19:43,052 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2026 - Comprehensive snapshot shape: (166, 12), includes all employees with compensation during the year
2025-05-10 08:19:43,054 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:19:43,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:19:43,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:19:43,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:19:43,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:19:43,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:19:43,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 118
2025-05-10 08:19:43,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:19:43,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=110, New Hire=8, Total Active=118
2025-05-10 08:19:43,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:19:43,070 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:19:43,073 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:19:43,074 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2027] BOY Active: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:19:43,074 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2027] Growth Target: 175, Hires needed: 9, Final target: 175
2025-05-10 08:19:43,074 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:19:43,075 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:19:43,076 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:19:43,082 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:19:43,083 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:19:43,083 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:19:43,083 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2027 - Found 52 termination events
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_248978_000042
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_235928_000161
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_466441_000184
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:19:43,084 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_673207_000229
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_248978_000042
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_235928_000161
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_466441_000184
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_673207_000229
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:19:43,085 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:19:43,086 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:19:43,086 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:19:43,086 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:19:43,086 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:19:43,086 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:19:43,087 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_276791_000032 in EOY data
2025-05-10 08:19:43,087 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:19:43,088 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_248978_000042 in EOY data
2025-05-10 08:19:43,088 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:19:43,089 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:19:43,089 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_235928_000161 in EOY data
2025-05-10 08:19:43,089 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:19:43,089 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_466441_000184 in EOY data
2025-05-10 08:19:43,090 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_564913_000201 in EOY data
2025-05-10 08:19:43,090 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_572298_000205 in EOY data
2025-05-10 08:19:43,090 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:19:43,091 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:19:43,091 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_681254_000214 in EOY data
2025-05-10 08:19:43,091 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:19:43,092 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:19:43,092 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:19:43,092 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:19:43,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_673207_000229 in EOY data
2025-05-10 08:19:43,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:19:43,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_674346_000243 in EOY data
2025-05-10 08:19:43,093 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:19:43,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_359903_000175 in EOY data
2025-05-10 08:19:43,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_159455_000167 in EOY data
2025-05-10 08:19:43,094 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:19:43,095 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:19:43,095 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_924184_000152 in EOY data
2025-05-10 08:19:43,095 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2027 - Comprehensive snapshot shape: (175, 12), includes all employees with compensation during the year
2025-05-10 08:19:43,097 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:19:43,097 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:19:43,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:19:43,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:19:43,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:19:43,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:19:43,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 111
2025-05-10 08:19:43,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:19:43,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:19:43,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:19:43,113 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:19:43,115 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:19:43,116 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2028] BOY Active: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:19:43,116 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2028] Growth Target: 184, Hires needed: 9, Final target: 184
2025-05-10 08:19:43,117 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:19:43,117 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:19:43,118 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:19:43,125 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:19:43,125 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:19:43,126 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:19:43,126 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2028 - Found 42 termination events
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:19:43,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:19:43,128 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:43,129 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:19:43,129 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:19:43,129 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:19:43,129 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:19:43,129 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:19:43,129 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_276791_000032 in EOY data
2025-05-10 08:19:43,130 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_787530_000056 in EOY data
2025-05-10 08:19:43,130 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_995917_000082 in EOY data
2025-05-10 08:19:43,131 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_590026_000145 in EOY data
2025-05-10 08:19:43,131 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_302145_000170 in EOY data
2025-05-10 08:19:43,131 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:19:43,131 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:19:43,132 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:19:43,132 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:19:43,132 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:19:43,133 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_329729_000232 in EOY data
2025-05-10 08:19:43,133 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:19:43,133 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:19:43,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_272287_000242 in EOY data
2025-05-10 08:19:43,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:19:43,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:19:43,134 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:19:43,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:19:43,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:19:43,135 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_918902_000199 in EOY data
2025-05-10 08:19:43,136 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_891995_000110 in EOY data
2025-05-10 08:19:43,136 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2028 - Comprehensive snapshot shape: (184, 12), includes all employees with compensation during the year
2025-05-10 08:19:43,138 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:19:43,138 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:19:43,138 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:19:43,138 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:19:43,138 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:19:43,139 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:19:43,139 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 111
2025-05-10 08:19:43,139 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:19:43,139 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:19:43,139 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:19:43,154 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:19:43,157 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:19:43,157 [INFO    ] [cost_model.engines.run_one_year.run_one_year:156] [RUN_ONE_YEAR YR=2029] BOY Active: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:19:43,157 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2029] Growth Target: 194, Hires needed: 10, Final target: 194
2025-05-10 08:19:43,157 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:19:43,158 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:19:43,159 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:19:43,165 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:19:43,166 [WARNING ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:19:43,167 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:19:43,167 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:19:43,167 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2029 - Found 50 termination events
2025-05-10 08:19:43,167 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_113115_000065
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_480527_000197
2025-05-10 08:19:43,168 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_113115_000065
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:19:43,169 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_480527_000197
2025-05-10 08:19:43,170 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:19:43,170 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:19:43,171 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_113115_000065 in EOY data
2025-05-10 08:19:43,171 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:19:43,172 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_557478_000081 in EOY data
2025-05-10 08:19:43,172 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:19:43,172 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:19:43,173 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_978079_000117 in EOY data
2025-05-10 08:19:43,173 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:19:43,173 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_876713_000183 in EOY data
2025-05-10 08:19:43,174 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_654803_000185 in EOY data
2025-05-10 08:19:43,174 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_572298_000205 in EOY data
2025-05-10 08:19:43,174 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:19:43,174 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_761402_000211 in EOY data
2025-05-10 08:19:43,175 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_944917_000212 in EOY data
2025-05-10 08:19:43,175 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:19:43,175 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:19:43,176 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:19:43,176 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:19:43,176 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:19:43,177 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:19:43,177 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:19:43,177 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_162302_000174 in EOY data
2025-05-10 08:19:43,178 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_938622_000132 in EOY data
2025-05-10 08:19:43,178 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_480527_000197 in EOY data
2025-05-10 08:19:43,178 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_228914_000151 in EOY data
2025-05-10 08:19:43,178 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2029 - Comprehensive snapshot shape: (194, 12), includes all employees with compensation during the year
2025-05-10 08:19:43,180 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:19:43,181 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:19:43,181 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:19:43,181 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:19:43,181 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:19:43,182 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:19:43,182 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 109
2025-05-10 08:19:43,182 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:19:43,182 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=99, New Hire=10, Total Active=109
2025-05-10 08:19:43,183 [INFO    ] [cost_model.projections.runner.run_projection_engine:400] Projection engine run completed.
2025-05-10 08:19:43,183 [INFO    ] [cost_model.projections.runner.run_projection_engine:406] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:19:43,183 [INFO    ] [cost_model.projections.runner.run_projection_engine:407] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:19:43,183 [INFO    ] [cost_model.projections.runner.run_projection_engine:408] Summary Results:
2025-05-10 08:19:43,184 [INFO    ] [cost_model.projections.runner.run_projection_engine:409] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:19:43,184 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:19:43,184 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:19:43,184 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:19:43,191 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:19:43,193 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:19:43,194 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:19:43,195 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:19:43,200 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:19:43,203 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:19:43,203 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:19:43,203 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:19:43,203 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:19:43,203 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:19:43,203 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:19:43,203 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:23:56,601 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:23:56,602 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:23:56,607 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:23:56,607 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:23:56,607 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:23:56,607 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:23:56,661 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:23:56,669 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:23:56,669 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:23:56,669 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:23:56,671 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:23:56,671 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:23:56,671 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:23:56,671 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:23:56,672 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:23:56,673 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:23:56,673 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:23:56,674 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:23:56,691 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:23:56,695 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:23:56,696 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2025] Starting Headcount: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:23:56,696 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2025] Target Headcount: 158, Hires needed: 8
2025-05-10 08:23:56,696 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:23:56,697 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:23:56,699 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:23:56,707 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:23:56,708 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:23:56,709 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:23:56,709 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2025 - Found 46 termination events
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:23:56,710 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:23:56,711 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:23:56,712 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:23:56,712 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:23:56,713 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:23:56,713 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:23:56,713 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:23:56,714 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_189765_000194 in EOY data
2025-05-10 08:23:56,714 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:23:56,714 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:23:56,715 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:23:56,715 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:23:56,715 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_542881_000225 in EOY data
2025-05-10 08:23:56,716 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:23:56,716 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:23:56,716 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:23:56,717 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:23:56,717 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:23:56,718 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:23:56,718 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:23:56,718 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:23:56,719 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:23:56,719 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:23:56,720 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_376781_000092 in EOY data
2025-05-10 08:23:56,720 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:23:56,720 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2025 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:23:56,722 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:23:56,722 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:23:56,722 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:23:56,722 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:23:56,723 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:23:56,723 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:23:56,723 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 135
2025-05-10 08:23:56,723 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:23:56,723 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=8, Total Active=135
2025-05-10 08:23:56,724 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:23:56,738 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:23:56,738 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:23:56,738 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:23:56,738 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:23:56,739 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:23:56,739 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:23:56,739 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:23:56,739 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:23:56,740 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:23:56,742 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:23:56,743 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2026] Starting Headcount: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:23:56,743 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2026] Target Headcount: 166, Hires needed: 8
2025-05-10 08:23:56,743 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:23:56,744 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:23:56,745 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:23:56,752 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:23:56,752 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:23:56,753 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:23:56,753 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2026 - Found 58 termination events
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_517930_000140
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:23:56,754 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_960846_000153
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_517930_000140
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:23:56,755 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_960846_000153
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:23:56,756 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:23:56,757 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_554513_000013 in EOY data
2025-05-10 08:23:56,757 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:23:56,757 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:23:56,758 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_517930_000140 in EOY data
2025-05-10 08:23:56,758 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:23:56,758 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_820606_000155 in EOY data
2025-05-10 08:23:56,759 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_892526_000162 in EOY data
2025-05-10 08:23:56,759 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_383697_000180 in EOY data
2025-05-10 08:23:56,759 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:23:56,760 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_926080_000203 in EOY data
2025-05-10 08:23:56,760 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:23:56,760 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:23:56,761 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:23:56,761 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:23:56,762 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:23:56,762 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:23:56,762 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_194336_000237 in EOY data
2025-05-10 08:23:56,763 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_225724_000240 in EOY data
2025-05-10 08:23:56,763 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:23:56,763 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:23:56,764 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:23:56,764 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:23:56,764 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_128328_000187 in EOY data
2025-05-10 08:23:56,765 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:23:56,765 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:23:56,765 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_960846_000153 in EOY data
2025-05-10 08:23:56,765 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:23:56,766 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:23:56,766 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:23:56,766 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2026 - Comprehensive snapshot shape: (166, 12), includes all employees with compensation during the year
2025-05-10 08:23:56,768 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:23:56,768 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:23:56,768 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:23:56,768 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:23:56,769 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:23:56,769 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:23:56,769 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 118
2025-05-10 08:23:56,769 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:23:56,769 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=110, New Hire=8, Total Active=118
2025-05-10 08:23:56,770 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:23:56,784 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:23:56,786 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:23:56,787 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2027] Starting Headcount: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:23:56,787 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2027] Target Headcount: 175, Hires needed: 9
2025-05-10 08:23:56,787 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:23:56,788 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:23:56,788 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:23:56,796 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:23:56,796 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:23:56,797 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:23:56,797 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2027 - Found 52 termination events
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_248978_000042
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_235928_000161
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_466441_000184
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:23:56,798 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_673207_000229
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_248978_000042
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_235928_000161
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_466441_000184
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:23:56,799 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_673207_000229
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:23:56,800 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:23:56,801 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_276791_000032 in EOY data
2025-05-10 08:23:56,801 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:23:56,801 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_248978_000042 in EOY data
2025-05-10 08:23:56,802 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:23:56,802 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:23:56,802 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_235928_000161 in EOY data
2025-05-10 08:23:56,803 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:23:56,803 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_466441_000184 in EOY data
2025-05-10 08:23:56,803 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_564913_000201 in EOY data
2025-05-10 08:23:56,804 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_572298_000205 in EOY data
2025-05-10 08:23:56,804 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:23:56,804 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:23:56,805 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_681254_000214 in EOY data
2025-05-10 08:23:56,805 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:23:56,805 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:23:56,806 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:23:56,806 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:23:56,806 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_673207_000229 in EOY data
2025-05-10 08:23:56,806 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:23:56,807 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_674346_000243 in EOY data
2025-05-10 08:23:56,807 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:23:56,807 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_359903_000175 in EOY data
2025-05-10 08:23:56,808 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_159455_000167 in EOY data
2025-05-10 08:23:56,808 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:23:56,808 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:23:56,809 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_924184_000152 in EOY data
2025-05-10 08:23:56,809 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2027 - Comprehensive snapshot shape: (175, 12), includes all employees with compensation during the year
2025-05-10 08:23:56,811 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:23:56,811 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:23:56,811 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:23:56,811 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:23:56,811 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:23:56,812 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:23:56,812 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 111
2025-05-10 08:23:56,812 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:23:56,812 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:23:56,813 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:23:56,827 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:23:56,829 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:23:56,830 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2028] Starting Headcount: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:23:56,830 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2028] Target Headcount: 184, Hires needed: 9
2025-05-10 08:23:56,830 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:23:56,831 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:23:56,832 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:23:56,839 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:23:56,839 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:23:56,840 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:23:56,840 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2028 - Found 42 termination events
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:23:56,841 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:23:56,842 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:23:56,843 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_276791_000032 in EOY data
2025-05-10 08:23:56,844 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_787530_000056 in EOY data
2025-05-10 08:23:56,844 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_995917_000082 in EOY data
2025-05-10 08:23:56,844 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_590026_000145 in EOY data
2025-05-10 08:23:56,845 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_302145_000170 in EOY data
2025-05-10 08:23:56,845 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:23:56,845 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:23:56,845 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:23:56,846 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:23:56,846 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:23:56,846 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_329729_000232 in EOY data
2025-05-10 08:23:56,847 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:23:56,847 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:23:56,847 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_272287_000242 in EOY data
2025-05-10 08:23:56,848 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:23:56,848 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:23:56,848 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:23:56,849 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:23:56,849 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:23:56,849 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_918902_000199 in EOY data
2025-05-10 08:23:56,850 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_891995_000110 in EOY data
2025-05-10 08:23:56,850 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2028 - Comprehensive snapshot shape: (184, 12), includes all employees with compensation during the year
2025-05-10 08:23:56,852 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:23:56,852 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:23:56,852 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:23:56,852 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:23:56,852 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:23:56,853 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:23:56,853 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 111
2025-05-10 08:23:56,853 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:23:56,853 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:23:56,853 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:23:56,868 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:23:56,871 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:23:56,872 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2029] Starting Headcount: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:23:56,872 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2029] Target Headcount: 194, Hires needed: 10
2025-05-10 08:23:56,872 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:23:56,873 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:23:56,873 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:23:56,880 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:23:56,881 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:23:56,882 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:23:56,882 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:23:56,882 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2029 - Found 50 termination events
2025-05-10 08:23:56,882 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:23:56,882 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_113115_000065
2025-05-10 08:23:56,882 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_480527_000197
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:23:56,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_113115_000065
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_480527_000197
2025-05-10 08:23:56,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:23:56,885 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:23:56,885 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_113115_000065 in EOY data
2025-05-10 08:23:56,885 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:23:56,886 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_557478_000081 in EOY data
2025-05-10 08:23:56,886 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:23:56,886 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:23:56,887 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_978079_000117 in EOY data
2025-05-10 08:23:56,887 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:23:56,887 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_876713_000183 in EOY data
2025-05-10 08:23:56,888 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_654803_000185 in EOY data
2025-05-10 08:23:56,888 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_572298_000205 in EOY data
2025-05-10 08:23:56,888 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:23:56,888 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_761402_000211 in EOY data
2025-05-10 08:23:56,889 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_944917_000212 in EOY data
2025-05-10 08:23:56,889 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:23:56,889 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:23:56,890 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:23:56,890 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:23:56,891 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:23:56,891 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:23:56,891 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:23:56,892 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_162302_000174 in EOY data
2025-05-10 08:23:56,892 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_938622_000132 in EOY data
2025-05-10 08:23:56,892 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_480527_000197 in EOY data
2025-05-10 08:23:56,893 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_228914_000151 in EOY data
2025-05-10 08:23:56,893 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2029 - Comprehensive snapshot shape: (194, 12), includes all employees with compensation during the year
2025-05-10 08:23:56,895 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:23:56,895 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:23:56,895 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:23:56,895 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:23:56,895 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:23:56,896 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:23:56,896 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 109
2025-05-10 08:23:56,896 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:23:56,896 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=99, New Hire=10, Total Active=109
2025-05-10 08:23:56,897 [INFO    ] [cost_model.projections.runner.run_projection_engine:400] Projection engine run completed.
2025-05-10 08:23:56,897 [INFO    ] [cost_model.projections.runner.run_projection_engine:406] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:23:56,897 [INFO    ] [cost_model.projections.runner.run_projection_engine:407] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:23:56,897 [INFO    ] [cost_model.projections.runner.run_projection_engine:408] Summary Results:
2025-05-10 08:23:56,898 [INFO    ] [cost_model.projections.runner.run_projection_engine:409] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:23:56,898 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:23:56,898 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:23:56,898 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:23:56,904 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:23:56,906 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:23:56,907 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:23:56,908 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:23:56,912 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:23:56,916 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:23:56,916 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:23:56,916 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:23:56,916 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:23:56,916 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:23:56,916 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:23:56,916 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:25:00,794 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:25:00,795 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:25:00,799 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:25:00,799 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:25:00,799 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:25:00,799 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:25:00,831 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:25:00,835 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:25:00,835 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:25:00,835 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:25:00,836 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:25:00,837 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:25:00,837 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:25:00,837 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:25:00,837 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:25:00,838 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:25:00,838 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:25:00,839 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:25:00,855 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:25:00,858 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:25:00,859 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2025] Starting Headcount: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:25:00,859 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2025] Target Headcount: 158, Hires needed: 8
2025-05-10 08:25:00,859 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:25:00,860 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:25:00,862 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:25:00,869 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:25:00,869 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:25:00,870 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 135
2025-05-10 08:25:00,870 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 362
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2025 - Found 46 termination events
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:25:00,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:25:00,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:25:00,873 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:25:00,873 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:25:00,874 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:25:00,874 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:25:00,874 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:25:00,875 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_189765_000194 in EOY data
2025-05-10 08:25:00,875 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:25:00,875 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:25:00,876 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:25:00,876 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:25:00,876 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_542881_000225 in EOY data
2025-05-10 08:25:00,877 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:25:00,877 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:25:00,877 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:25:00,877 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:25:00,878 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:25:00,878 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:25:00,878 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:25:00,879 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:25:00,879 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:25:00,879 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:25:00,880 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_376781_000092 in EOY data
2025-05-10 08:25:00,880 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:25:00,880 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2025 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:25:00,882 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:25:00,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:25:00,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:25:00,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:25:00,883 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:25:00,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
346  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
347  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
348  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
349  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
350  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:25:00,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 135
2025-05-10 08:25:00,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:25:00,884 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=127, New Hire=8, Total Active=135
2025-05-10 08:25:00,885 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:25:00,897 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:25:00,897 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:25:00,897 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:25:00,898 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:25:00,899 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:25:00,899 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:25:00,899 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:25:00,899 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 29
2025-05-10 08:25:00,899 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 179 new events...
2025-05-10 08:25:00,903 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:25:00,904 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2026] Starting Headcount: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:25:00,904 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2026] Target Headcount: 166, Hires needed: 8
2025-05-10 08:25:00,904 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:25:00,904 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:25:00,905 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:25:00,912 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:25:00,913 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:25:00,914 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 118
2025-05-10 08:25:00,914 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 374
2025-05-10 08:25:00,914 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2026 - Found 58 termination events
2025-05-10 08:25:00,914 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:25:00,914 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:25:00,914 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:25:00,914 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_517930_000140
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:25:00,915 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_960846_000153
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_517930_000140
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_960846_000153
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:25:00,916 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:25:00,917 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:25:00,917 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_554513_000013 in EOY data
2025-05-10 08:25:00,917 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:25:00,918 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:25:00,918 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_517930_000140 in EOY data
2025-05-10 08:25:00,918 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:25:00,919 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_820606_000155 in EOY data
2025-05-10 08:25:00,919 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_892526_000162 in EOY data
2025-05-10 08:25:00,919 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_383697_000180 in EOY data
2025-05-10 08:25:00,920 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:25:00,920 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_926080_000203 in EOY data
2025-05-10 08:25:00,920 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:25:00,921 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:25:00,921 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:25:00,921 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:25:00,921 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:25:00,922 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:25:00,922 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_194336_000237 in EOY data
2025-05-10 08:25:00,922 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_225724_000240 in EOY data
2025-05-10 08:25:00,923 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:25:00,923 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:25:00,923 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:25:00,924 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:25:00,924 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_128328_000187 in EOY data
2025-05-10 08:25:00,925 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:25:00,925 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:25:00,925 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_960846_000153 in EOY data
2025-05-10 08:25:00,926 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:25:00,926 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:25:00,926 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:25:00,927 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2026 - Comprehensive snapshot shape: (166, 12), includes all employees with compensation during the year
2025-05-10 08:25:00,928 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:25:00,928 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:25:00,928 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:25:00,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:25:00,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:25:00,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
358  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
359  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
360  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
361  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
362  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:25:00,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 118
2025-05-10 08:25:00,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:25:00,929 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=110, New Hire=8, Total Active=118
2025-05-10 08:25:00,930 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:25:00,943 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 176 new events...
2025-05-10 08:25:00,946 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:25:00,946 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2027] Starting Headcount: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:25:00,946 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2027] Target Headcount: 175, Hires needed: 9
2025-05-10 08:25:00,946 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:25:00,947 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:25:00,948 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:25:00,955 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:25:00,955 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:25:00,956 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 111
2025-05-10 08:25:00,956 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 370
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2027 - Found 52 termination events
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_248978_000042
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_235928_000161
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_466441_000184
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_673207_000229
2025-05-10 08:25:00,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_248978_000042
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_235928_000161
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_466441_000184
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:25:00,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_673207_000229
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:25:00,959 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_276791_000032 in EOY data
2025-05-10 08:25:00,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:25:00,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_248978_000042 in EOY data
2025-05-10 08:25:00,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:25:00,961 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:25:00,961 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_235928_000161 in EOY data
2025-05-10 08:25:00,962 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:25:00,962 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_466441_000184 in EOY data
2025-05-10 08:25:00,962 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_564913_000201 in EOY data
2025-05-10 08:25:00,963 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_572298_000205 in EOY data
2025-05-10 08:25:00,963 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:25:00,963 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:25:00,964 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_681254_000214 in EOY data
2025-05-10 08:25:00,964 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:25:00,964 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:25:00,965 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:25:00,965 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:25:00,966 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_673207_000229 in EOY data
2025-05-10 08:25:00,966 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:25:00,966 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_674346_000243 in EOY data
2025-05-10 08:25:00,967 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:25:00,967 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_359903_000175 in EOY data
2025-05-10 08:25:00,968 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_159455_000167 in EOY data
2025-05-10 08:25:00,968 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:25:00,968 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:25:00,969 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_924184_000152 in EOY data
2025-05-10 08:25:00,969 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2027 - Comprehensive snapshot shape: (175, 12), includes all employees with compensation during the year
2025-05-10 08:25:00,971 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:25:00,971 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:25:00,971 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:25:00,971 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:25:00,972 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:25:00,972 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
352  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
353  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
354  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
355  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2027
356  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:25:00,972 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 111
2025-05-10 08:25:00,972 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:25:00,972 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:25:00,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:25:00,987 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 171 new events...
2025-05-10 08:25:00,990 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:25:00,990 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2028] Starting Headcount: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:25:00,990 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2028] Target Headcount: 184, Hires needed: 9
2025-05-10 08:25:00,990 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:25:00,991 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:25:00,992 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:25:00,998 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:25:00,999 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:25:00,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 111
2025-05-10 08:25:00,999 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 360
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2028 - Found 42 termination events
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:25:01,000 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_276791_000032
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:25:01,001 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:25:01,002 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_276791_000032 in EOY data
2025-05-10 08:25:01,002 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_787530_000056 in EOY data
2025-05-10 08:25:01,003 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_995917_000082 in EOY data
2025-05-10 08:25:01,003 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_590026_000145 in EOY data
2025-05-10 08:25:01,003 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_302145_000170 in EOY data
2025-05-10 08:25:01,004 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:25:01,004 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:25:01,004 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:25:01,005 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:25:01,005 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:25:01,005 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_329729_000232 in EOY data
2025-05-10 08:25:01,006 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:25:01,006 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:25:01,006 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_272287_000242 in EOY data
2025-05-10 08:25:01,006 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:25:01,007 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:25:01,007 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:25:01,007 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:25:01,008 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:25:01,008 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_918902_000199 in EOY data
2025-05-10 08:25:01,008 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_891995_000110 in EOY data
2025-05-10 08:25:01,009 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2028 - Comprehensive snapshot shape: (184, 12), includes all employees with compensation during the year
2025-05-10 08:25:01,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:25:01,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:25:01,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:25:01,010 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:25:01,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:25:01,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
342  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
343  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
344  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
345  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
346  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:25:01,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 111
2025-05-10 08:25:01,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:25:01,011 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=102, New Hire=9, Total Active=111
2025-05-10 08:25:01,012 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:25:01,027 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 175 new events...
2025-05-10 08:25:01,030 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:25:01,031 [INFO    ] [cost_model.engines.run_one_year.run_one_year:153] [RUN_ONE_YEAR YR=2029] Starting Headcount: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:25:01,031 [INFO    ] [cost_model.engines.run_one_year.run_one_year:154] [RUN_ONE_YEAR YR=2029] Target Headcount: 194, Hires needed: 10
2025-05-10 08:25:01,031 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:25:01,032 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:25:01,032 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:25:01,039 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:25:01,039 [WARNING ] [cost_model.engines.run_one_year.run_one_year:203] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:25:01,040 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 109
2025-05-10 08:25:01,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 370
2025-05-10 08:25:01,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2029 - Found 50 termination events
2025-05-10 08:25:01,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:25:01,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_113115_000065
2025-05-10 08:25:01,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:25:01,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:25:01,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_480527_000197
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_113115_000065
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:25:01,042 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_480527_000197
2025-05-10 08:25:01,043 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:25:01,044 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:25:01,044 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_113115_000065 in EOY data
2025-05-10 08:25:01,044 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:25:01,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_557478_000081 in EOY data
2025-05-10 08:25:01,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:25:01,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:25:01,045 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_978079_000117 in EOY data
2025-05-10 08:25:01,046 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:25:01,046 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_876713_000183 in EOY data
2025-05-10 08:25:01,046 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_654803_000185 in EOY data
2025-05-10 08:25:01,047 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_572298_000205 in EOY data
2025-05-10 08:25:01,047 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:25:01,047 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_761402_000211 in EOY data
2025-05-10 08:25:01,048 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_944917_000212 in EOY data
2025-05-10 08:25:01,048 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:25:01,048 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:25:01,049 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:25:01,049 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:25:01,049 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:25:01,050 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:25:01,050 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:25:01,051 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_162302_000174 in EOY data
2025-05-10 08:25:01,051 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_938622_000132 in EOY data
2025-05-10 08:25:01,051 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_480527_000197 in EOY data
2025-05-10 08:25:01,052 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_228914_000151 in EOY data
2025-05-10 08:25:01,052 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2029 - Comprehensive snapshot shape: (194, 12), includes all employees with compensation during the year
2025-05-10 08:25:01,054 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:25:01,054 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:25:01,054 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:25:01,054 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:25:01,054 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:25:01,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
350  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
351  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
352  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
353  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
354  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:25:01,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 109
2025-05-10 08:25:01,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:25:01,055 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=99, New Hire=10, Total Active=109
2025-05-10 08:25:01,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:400] Projection engine run completed.
2025-05-10 08:25:01,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:406] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:25:01,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:407] Final Cumulative Event Log shape: (1838, 8)
2025-05-10 08:25:01,056 [INFO    ] [cost_model.projections.runner.run_projection_engine:408] Summary Results:
2025-05-10 08:25:01,057 [INFO    ] [cost_model.projections.runner.run_projection_engine:409] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               135             135                115                        12276077.36                    0.0                    0.0         12276077.36               90933.906370         47.206325            0.851852                          4.226087
1             2026               118             118                 93                        10116858.82                    0.0                    0.0         10116858.82               85736.091695         48.495497            0.788136                          4.247312
2             2027               111             111                 78                         8745535.62                    0.0                    0.0          8745535.62               78788.609189         50.665330            0.702703                          4.358974
3             2028               111             111                 69                         7661597.89                    0.0                    0.0          7661597.89               69023.404414         52.367299            0.621622                          4.405797
4             2029               109             109                 60                         6608087.56                    0.0                    0.0          6608087.56               60624.656514         52.983183            0.550459                          4.400000
2025-05-10 08:25:01,057 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:25:01,057 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:25:01,057 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:25:01,062 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:25:01,063 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:25:01,064 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:25:01,065 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:25:01,070 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:25:01,072 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:25:01,073 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:25:01,073 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:25:01,073 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:25:01,073 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:25:01,073 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:25:01,073 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:27:26,699 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:27:26,699 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:27:26,704 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:27:26,705 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:27:26,705 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:27:26,705 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:27:26,772 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:27:26,781 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:108] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:27:26,782 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:27:26,782 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:27:26,784 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:27:26,784 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:27:26,784 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:27:26,784 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:27:26,784 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:27:26,785 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:27:26,785 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:27:26,786 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:27:26,801 [INFO    ] [cost_model.engines.run_one_year.run_one_year:130] [RUN_ONE_YEAR YR=2025] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:27:26,804 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 159 new events...
2025-05-10 08:27:26,809 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:27:26,809 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2025] Starting count: 150, Terminated: 0, Survivors: 150
2025-05-10 08:27:26,810 [INFO    ] [cost_model.engines.run_one_year.run_one_year:197] [RUN_ONE_YEAR YR=2025] Starting Headcount: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:27:26,810 [INFO    ] [cost_model.engines.run_one_year.run_one_year:198] [RUN_ONE_YEAR YR=2025] Target Headcount: 158, Hires needed: 8
2025-05-10 08:27:26,810 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:27:26,811 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:27:26,812 [INFO    ] [cost_model.engines.run_one_year.run_one_year:204] [RUN_ONE_YEAR YR=2025] Hiring target: 158 (survivors + new hires)
2025-05-10 08:27:26,812 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:27:26,820 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:27:26,821 [WARNING ] [cost_model.engines.run_one_year.run_one_year:250] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2025 - Snapshot shape: (158, 11), Active: 149
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2025 - Events generated this year: 334
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2025 - Found 18 termination events
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:27:26,822 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:27:26,823 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:27:26,824 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:27:26,824 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:27:26,824 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:27:26,825 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_542881_000225 in EOY data
2025-05-10 08:27:26,825 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:27:26,826 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:27:26,826 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:27:26,826 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2025 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:27:26,827 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2025 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:27:26,829 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:27:26,829 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:27:26,829 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:27:26,829 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:27:26,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:27:26,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
318  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
319  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
320  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
321  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
322  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:27:26,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 149
2025-05-10 08:27:26,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:27:26,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=141, New Hire=8, Total Active=149
2025-05-10 08:27:26,831 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:27:26,843 [INFO    ] [cost_model.engines.run_one_year.run_one_year:130] [RUN_ONE_YEAR YR=2026] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:27:26,843 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:27:26,843 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:27:26,843 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:27:26,844 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:27:26,845 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0      0.075
1      0.075
2      0.075
3      0.075
4      0.075
2025-05-10 08:27:26,845 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:27:26,845 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.075 0.075 0.075 0.075 0.075]
2025-05-10 08:27:26,845 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 11
2025-05-10 08:27:26,846 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 161 new events...
2025-05-10 08:27:26,849 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:27:26,849 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2026] Starting count: 158, Terminated: 0, Survivors: 158
2025-05-10 08:27:26,850 [INFO    ] [cost_model.engines.run_one_year.run_one_year:197] [RUN_ONE_YEAR YR=2026] Starting Headcount: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:27:26,850 [INFO    ] [cost_model.engines.run_one_year.run_one_year:198] [RUN_ONE_YEAR YR=2026] Target Headcount: 166, Hires needed: 8
2025-05-10 08:27:26,850 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:27:26,851 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:27:26,851 [INFO    ] [cost_model.engines.run_one_year.run_one_year:204] [RUN_ONE_YEAR YR=2026] Hiring target: 166 (survivors + new hires)
2025-05-10 08:27:26,852 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:27:26,860 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:27:26,861 [WARNING ] [cost_model.engines.run_one_year.run_one_year:250] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:27:26,862 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2026 - Snapshot shape: (166, 11), Active: 147
2025-05-10 08:27:26,862 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2026 - Events generated this year: 338
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2026 - Found 22 termination events
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_202240_000168
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_450171_000196
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_491476_000191
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_202240_000168
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:27:26,863 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:27:26,864 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:27:26,864 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:27:26,864 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_450171_000196
2025-05-10 08:27:26,864 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_491476_000191
2025-05-10 08:27:26,864 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:27:26,864 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:27:26,864 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:27:26,865 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_202240_000168 in EOY data
2025-05-10 08:27:26,865 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:27:26,865 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_628360_000222 in EOY data
2025-05-10 08:27:26,866 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_272287_000242 in EOY data
2025-05-10 08:27:26,866 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_874410_000200 in EOY data
2025-05-10 08:27:26,866 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_359903_000175 in EOY data
2025-05-10 08:27:26,867 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_450171_000196 in EOY data
2025-05-10 08:27:26,867 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_491476_000191 in EOY data
2025-05-10 08:27:26,868 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:27:26,868 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2026 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:27:26,868 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2026 - Comprehensive snapshot shape: (166, 12), includes all employees with compensation during the year
2025-05-10 08:27:26,870 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:27:26,870 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:27:26,870 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:27:26,870 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:27:26,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:27:26,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
322  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
323  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
324  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
325  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2026
326  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:27:26,871 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 147
2025-05-10 08:27:26,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:27:26,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=139, New Hire=8, Total Active=147
2025-05-10 08:27:26,872 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:27:26,885 [INFO    ] [cost_model.engines.run_one_year.run_one_year:130] [RUN_ONE_YEAR YR=2027] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:27:26,887 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 160 new events...
2025-05-10 08:27:26,889 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:27:26,890 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2027] Starting count: 166, Terminated: 0, Survivors: 166
2025-05-10 08:27:26,890 [INFO    ] [cost_model.engines.run_one_year.run_one_year:197] [RUN_ONE_YEAR YR=2027] Starting Headcount: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:27:26,890 [INFO    ] [cost_model.engines.run_one_year.run_one_year:198] [RUN_ONE_YEAR YR=2027] Target Headcount: 175, Hires needed: 9
2025-05-10 08:27:26,890 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:27:26,891 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:27:26,891 [INFO    ] [cost_model.engines.run_one_year.run_one_year:204] [RUN_ONE_YEAR YR=2027] Hiring target: 175 (survivors + new hires)
2025-05-10 08:27:26,892 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:27:26,898 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:27:26,899 [WARNING ] [cost_model.engines.run_one_year.run_one_year:250] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2027 - Snapshot shape: (175, 11), Active: 146
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2027 - Events generated this year: 338
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2027 - Found 20 termination events
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_977990_000223
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_826965_000230
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_977990_000223
2025-05-10 08:27:26,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_826965_000230
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:27:26,901 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_926080_000203 in EOY data
2025-05-10 08:27:26,902 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_977990_000223 in EOY data
2025-05-10 08:27:26,902 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_826965_000230 in EOY data
2025-05-10 08:27:26,902 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_150696_000231 in EOY data
2025-05-10 08:27:26,903 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_329729_000232 in EOY data
2025-05-10 08:27:26,903 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_194336_000237 in EOY data
2025-05-10 08:27:26,903 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_674346_000243 in EOY data
2025-05-10 08:27:26,904 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_128328_000187 in EOY data
2025-05-10 08:27:26,904 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:27:26,905 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2027 - Updated termination date for employee DUMMY_NH_930610_000177 in EOY data
2025-05-10 08:27:26,905 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2027 - Comprehensive snapshot shape: (175, 12), includes all employees with compensation during the year
2025-05-10 08:27:26,907 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:27:26,907 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:27:26,907 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:27:26,907 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:27:26,907 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:27:26,908 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
320  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
321  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
322  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
323  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
324  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:27:26,908 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 146
2025-05-10 08:27:26,908 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:27:26,908 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=137, New Hire=9, Total Active=146
2025-05-10 08:27:26,909 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:27:26,921 [INFO    ] [cost_model.engines.run_one_year.run_one_year:130] [RUN_ONE_YEAR YR=2028] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:27:26,923 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 161 new events...
2025-05-10 08:27:26,926 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:27:26,926 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2028] Starting count: 175, Terminated: 0, Survivors: 175
2025-05-10 08:27:26,926 [INFO    ] [cost_model.engines.run_one_year.run_one_year:197] [RUN_ONE_YEAR YR=2028] Starting Headcount: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:27:26,926 [INFO    ] [cost_model.engines.run_one_year.run_one_year:198] [RUN_ONE_YEAR YR=2028] Target Headcount: 184, Hires needed: 9
2025-05-10 08:27:26,927 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:27:26,927 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:27:26,928 [INFO    ] [cost_model.engines.run_one_year.run_one_year:204] [RUN_ONE_YEAR YR=2028] Hiring target: 184 (survivors + new hires)
2025-05-10 08:27:26,928 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:27:26,935 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:27:26,935 [WARNING ] [cost_model.engines.run_one_year.run_one_year:250] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:27:26,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2028 - Snapshot shape: (184, 11), Active: 148
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2028 - Events generated this year: 340
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2028 - Found 22 termination events
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_146765_000046
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_785598_000173
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_803274_000213
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_450171_000196
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_146765_000046
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:27:26,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_785598_000173
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_803274_000213
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_450171_000196
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:27:26,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_EX_146765_000046 in EOY data
2025-05-10 08:27:26,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:27:26,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_785598_000173 in EOY data
2025-05-10 08:27:26,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_803274_000213 in EOY data
2025-05-10 08:27:26,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:27:26,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_674346_000243 in EOY data
2025-05-10 08:27:26,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_450171_000196 in EOY data
2025-05-10 08:27:26,941 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_937981_000164 in EOY data
2025-05-10 08:27:26,941 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:27:26,941 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:27:26,942 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2028 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:27:26,942 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2028 - Comprehensive snapshot shape: (184, 12), includes all employees with compensation during the year
2025-05-10 08:27:26,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:27:26,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:27:26,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:27:26,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:27:26,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:27:26,945 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
322  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2028
323  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
324  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
325  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2028
326  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:27:26,945 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 148
2025-05-10 08:27:26,945 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:27:26,945 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=139, New Hire=9, Total Active=148
2025-05-10 08:27:26,946 [INFO    ] [cost_model.projections.runner.run_projection_engine:120] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:27:26,957 [INFO    ] [cost_model.engines.run_one_year.run_one_year:130] [RUN_ONE_YEAR YR=2029] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:27:26,959 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 169 new events...
2025-05-10 08:27:26,962 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:27:26,962 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2029] Starting count: 184, Terminated: 0, Survivors: 184
2025-05-10 08:27:26,962 [INFO    ] [cost_model.engines.run_one_year.run_one_year:197] [RUN_ONE_YEAR YR=2029] Starting Headcount: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:27:26,962 [INFO    ] [cost_model.engines.run_one_year.run_one_year:198] [RUN_ONE_YEAR YR=2029] Target Headcount: 194, Hires needed: 10
2025-05-10 08:27:26,963 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:27:26,963 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:27:26,963 [INFO    ] [cost_model.engines.run_one_year.run_one_year:204] [RUN_ONE_YEAR YR=2029] Hiring target: 194 (survivors + new hires)
2025-05-10 08:27:26,964 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:27:26,971 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:27:26,972 [WARNING ] [cost_model.engines.run_one_year.run_one_year:250] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] EOY 2029 - Snapshot shape: (194, 11), Active: 141
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:134] EOY 2029 - Events generated this year: 358
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] Year 2029 - Found 38 termination events
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_845395_000043
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_802270_000060
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_814926_000102
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_824486_000113
2025-05-10 08:27:26,973 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_202240_000168
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_214746_000176
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_270716_000250
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_754885_000195
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_845395_000043
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_802270_000060
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_814926_000102
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_824486_000113
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_202240_000168
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_214746_000176
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:27:26,974 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:27:26,975 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:27:26,975 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:27:26,975 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:27:26,975 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_270716_000250
2025-05-10 08:27:26,975 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_754885_000195
2025-05-10 08:27:26,975 [INFO    ] [cost_model.projections.runner.run_projection_engine:172] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_349161_000198
2025-05-10 08:27:26,975 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_554513_000013 in EOY data
2025-05-10 08:27:26,976 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:27:26,976 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_845395_000043 in EOY data
2025-05-10 08:27:26,976 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_802270_000060 in EOY data
2025-05-10 08:27:26,977 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:27:26,977 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_814926_000102 in EOY data
2025-05-10 08:27:26,978 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_824486_000113 in EOY data
2025-05-10 08:27:26,978 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_202240_000168 in EOY data
2025-05-10 08:27:26,978 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_214746_000176 in EOY data
2025-05-10 08:27:26,979 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_876713_000183 in EOY data
2025-05-10 08:27:26,979 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_654803_000185 in EOY data
2025-05-10 08:27:26,979 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_775373_000204 in EOY data
2025-05-10 08:27:26,980 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_377257_000224 in EOY data
2025-05-10 08:27:26,980 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:27:26,980 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_225724_000240 in EOY data
2025-05-10 08:27:26,980 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:27:26,981 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_270716_000250 in EOY data
2025-05-10 08:27:26,981 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_754885_000195 in EOY data
2025-05-10 08:27:26,981 [INFO    ] [cost_model.projections.runner.run_projection_engine:186] Year 2029 - Updated termination date for employee DUMMY_NH_349161_000198 in EOY data
2025-05-10 08:27:26,982 [INFO    ] [cost_model.projections.runner.run_projection_engine:223] Year 2029 - Comprehensive snapshot shape: (194, 12), includes all employees with compensation during the year
2025-05-10 08:27:26,984 [INFO    ] [cost_model.projections.runner.run_projection_engine:302] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:27:26,984 [INFO    ] [cost_model.projections.runner.run_projection_engine:303] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:27:26,984 [INFO    ] [cost_model.projections.runner.run_projection_engine:304] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:27:26,984 [INFO    ] [cost_model.projections.runner.run_projection_engine:305] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:27:26,984 [INFO    ] [cost_model.projections.runner.run_projection_engine:313] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:27:26,985 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
338  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2029
339  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
340  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
341  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
342  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:27:26,985 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 141
2025-05-10 08:27:26,985 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:27:26,985 [INFO    ] [cost_model.projections.runner.run_projection_engine:356] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=131, New Hire=10, Total Active=141
2025-05-10 08:27:26,986 [INFO    ] [cost_model.projections.runner.run_projection_engine:400] Projection engine run completed.
2025-05-10 08:27:26,986 [INFO    ] [cost_model.projections.runner.run_projection_engine:406] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:27:26,986 [INFO    ] [cost_model.projections.runner.run_projection_engine:407] Final Cumulative Event Log shape: (1710, 8)
2025-05-10 08:27:26,986 [INFO    ] [cost_model.projections.runner.run_projection_engine:408] Summary Results:
2025-05-10 08:27:26,987 [INFO    ] [cost_model.projections.runner.run_projection_engine:409] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               149             149                129                        14125035.97                    0.0                    0.0         14125035.97               94798.899128         46.954180            0.865772                          4.224806
1             2026               147             147                121                        12920297.46                    0.0                    0.0         12920297.46               87893.180000         48.623143            0.823129                          4.297521
2             2027               146             146                111                        12274379.68                    0.0                    0.0         12274379.68               84071.093699         49.722991            0.760274                          4.306306
3             2028               148             148                104                        11422951.16                    0.0                    0.0         11422951.16               77182.102432         50.945399            0.702703                          4.269231
4             2029               141             141                 90                         9465126.13                    0.0                    0.0          9465126.13               67128.554113         50.741492            0.638298                          4.222222
2025-05-10 08:27:26,987 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:27:26,987 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:27:26,987 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:27:26,994 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:27:26,996 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:27:26,997 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:27:26,998 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:27:27,001 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:27:27,004 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:27:27,004 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:27:27,005 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:27:27,005 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:27:27,005 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:27:27,005 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:27:27,005 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:32:56,085 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:32:56,086 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:32:56,090 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:32:56,090 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:32:56,090 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:32:56,091 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:32:56,145 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:32:56,146 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:32:56,151 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:32:56,152 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:32:56,152 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:32:56,153 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:32:56,153 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:32:56,153 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:32:56,154 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:32:56,154 [INFO    ] [cost_model.projections.runner.run_projection_engine:98] Initial snapshot - Total employees: 150, Active employees: 150, Terminated: 0
2025-05-10 08:32:56,154 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: name 'EVENT_COLS' is not defined
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 104, in run_projection_engine
    current_cumulative_event_log = pd.DataFrame([], columns=EVENT_COLS)
NameError: name 'EVENT_COLS' is not defined
2025-05-10 08:33:50,861 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:33:50,862 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:33:50,871 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:33:50,871 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:33:50,871 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:33:50,871 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:33:50,920 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:33:50,921 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:33:50,926 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:33:50,926 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:33:50,926 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:33:50,927 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:33:50,927 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:33:50,927 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:33:50,927 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:33:50,928 [INFO    ] [cost_model.projections.runner.run_projection_engine:98] Initial snapshot - Total employees: 150, Active employees: 150, Terminated: 0
2025-05-10 08:33:50,928 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:33:50,929 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:33:50,929 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:33:50,930 [INFO    ] [cost_model.projections.runner.run_projection_engine:130] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:33:50,930 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: name 'rng' is not defined
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 139, in run_projection_engine
    rng=rng,
NameError: name 'rng' is not defined
2025-05-10 08:34:06,837 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:34:06,837 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:34:06,841 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:34:06,842 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:34:06,842 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:34:06,842 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:34:06,891 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:34:06,892 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:34:06,898 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:34:06,898 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:34:06,898 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:34:06,900 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:34:06,900 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:34:06,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:34:06,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:34:06,900 [INFO    ] [cost_model.projections.runner.run_projection_engine:101] Initial snapshot - Total employees: 150, Active employees: 150, Terminated: 0
2025-05-10 08:34:06,900 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:34:06,901 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:34:06,902 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:34:06,902 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:34:06,916 [INFO    ] [cost_model.engines.run_one_year.run_one_year:135] [RUN_ONE_YEAR YR=2025] Special adjustment for first year: Setting termination rate to 0.3500 to achieve exactly 105 active employees
2025-05-10 08:34:06,919 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 201 new events...
2025-05-10 08:34:06,923 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:34:06,923 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2025] Starting count: 150, Terminated: 0, Survivors: 150
2025-05-10 08:34:06,923 [INFO    ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR YR=2025] Starting Headcount: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:34:06,923 [INFO    ] [cost_model.engines.run_one_year.run_one_year:207] [RUN_ONE_YEAR YR=2025] Target Headcount: 158, Hires needed: 8
2025-05-10 08:34:06,924 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:34:06,924 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:34:06,925 [INFO    ] [cost_model.engines.run_one_year.run_one_year:213] [RUN_ONE_YEAR YR=2025] Hiring target: 158 (survivors + new hires)
2025-05-10 08:34:06,926 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:34:06,934 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:34:06,935 [WARNING ] [cost_model.engines.run_one_year.run_one_year:259] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:146] EOY 2025 - Snapshot shape: (158, 11), Active: 75
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:147] EOY 2025 - Events generated this year: 418
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:176] Year 2025 - Found 102 termination events
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:34:06,936 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_768665_000121
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_630610_000139
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_320008_000165
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_975970_000188
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_725374_000239
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:34:06,937 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_981004_000160
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_194135_000159
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_529547_000075
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_165566_000136
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_768665_000121
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_630610_000139
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_320008_000165
2025-05-10 08:34:06,938 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_975970_000188
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_725374_000239
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:34:06,939 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_981004_000160
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_194135_000159
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_529547_000075
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_165566_000136
2025-05-10 08:34:06,940 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:34:06,941 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:34:06,941 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:34:06,941 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_557478_000081 in EOY data
2025-05-10 08:34:06,942 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:34:06,942 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_768665_000121 in EOY data
2025-05-10 08:34:06,942 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:34:06,943 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_630610_000139 in EOY data
2025-05-10 08:34:06,943 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_820606_000155 in EOY data
2025-05-10 08:34:06,943 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_320008_000165 in EOY data
2025-05-10 08:34:06,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:34:06,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_302145_000170 in EOY data
2025-05-10 08:34:06,944 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:34:06,945 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_975970_000188 in EOY data
2025-05-10 08:34:06,945 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_189765_000194 in EOY data
2025-05-10 08:34:06,946 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_564913_000201 in EOY data
2025-05-10 08:34:06,946 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:34:06,946 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:34:06,946 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:34:06,947 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:34:06,947 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:34:06,947 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:34:06,948 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_377257_000224 in EOY data
2025-05-10 08:34:06,948 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_542881_000225 in EOY data
2025-05-10 08:34:06,948 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:34:06,949 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:34:06,949 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:34:06,949 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:34:06,950 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:34:06,950 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_725374_000239 in EOY data
2025-05-10 08:34:06,950 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:34:06,951 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:34:06,951 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:34:06,951 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:34:06,952 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_874410_000200 in EOY data
2025-05-10 08:34:06,952 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_937981_000164 in EOY data
2025-05-10 08:34:06,952 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:34:06,953 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_981004_000160 in EOY data
2025-05-10 08:34:06,953 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:34:06,953 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:34:06,954 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:34:06,954 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:34:06,954 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_924184_000152 in EOY data
2025-05-10 08:34:06,955 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:34:06,955 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:34:06,955 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_194135_000159 in EOY data
2025-05-10 08:34:06,956 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_983688_000154 in EOY data
2025-05-10 08:34:06,956 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:34:06,956 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_376781_000092 in EOY data
2025-05-10 08:34:06,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_EX_529547_000075 in EOY data
2025-05-10 08:34:06,957 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_165566_000136 in EOY data
2025-05-10 08:34:06,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2025 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:34:06,958 [INFO    ] [cost_model.projections.runner.run_projection_engine:236] Year 2025 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:34:06,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:34:06,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:316] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:34:06,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:317] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:34:06,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:318] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:34:06,960 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:34:06,961 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
402  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
403  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2025
404  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
405  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
406  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:34:06,961 [INFO    ] [cost_model.projections.runner.run_projection_engine:341] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 75
2025-05-10 08:34:06,961 [INFO    ] [cost_model.projections.runner.run_projection_engine:345] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:34:06,961 [INFO    ] [cost_model.projections.runner.run_projection_engine:369] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=67, New Hire=8, Total Active=75
2025-05-10 08:34:06,962 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:34:06,975 [INFO    ] [cost_model.engines.run_one_year.run_one_year:139] [RUN_ONE_YEAR YR=2026] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:34:06,975 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:34:06,975 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:34:06,975 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:34:06,976 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:34:06,976 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0      0.075
1      0.075
2      0.075
3      0.075
4      0.075
2025-05-10 08:34:06,976 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:34:06,977 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.075 0.075 0.075 0.075 0.075]
2025-05-10 08:34:06,977 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 10
2025-05-10 08:34:06,977 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 160 new events...
2025-05-10 08:34:06,980 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:34:06,980 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2026] Starting count: 158, Terminated: 0, Survivors: 158
2025-05-10 08:34:06,980 [INFO    ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR YR=2026] Starting Headcount: 158, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:34:06,980 [INFO    ] [cost_model.engines.run_one_year.run_one_year:207] [RUN_ONE_YEAR YR=2026] Target Headcount: 166, Hires needed: 8
2025-05-10 08:34:06,981 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 166, Needed before gross-up: 8
2025-05-10 08:34:06,981 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2026] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:34:06,982 [INFO    ] [cost_model.engines.run_one_year.run_one_year:213] [RUN_ONE_YEAR YR=2026] Hiring target: 166 (survivors + new hires)
2025-05-10 08:34:06,982 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 16 new events...
2025-05-10 08:34:06,989 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:34:06,989 [WARNING ] [cost_model.engines.run_one_year.run_one_year:259] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:34:06,990 [INFO    ] [cost_model.projections.runner.run_projection_engine:146] EOY 2026 - Snapshot shape: (166, 11), Active: 79
2025-05-10 08:34:06,990 [INFO    ] [cost_model.projections.runner.run_projection_engine:147] EOY 2026 - Events generated this year: 336
2025-05-10 08:34:06,990 [INFO    ] [cost_model.projections.runner.run_projection_engine:176] Year 2026 - Found 20 termination events
2025-05-10 08:34:06,990 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:34:06,990 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:34:06,991 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:34:06,992 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_EX_995917_000082 in EOY data
2025-05-10 08:34:06,992 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_302145_000170 in EOY data
2025-05-10 08:34:06,992 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_564913_000201 in EOY data
2025-05-10 08:34:06,993 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:34:06,993 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_329729_000232 in EOY data
2025-05-10 08:34:06,993 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_120009_000233 in EOY data
2025-05-10 08:34:06,993 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:34:06,994 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_674346_000243 in EOY data
2025-05-10 08:34:06,994 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:34:06,994 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2026 - Updated termination date for employee DUMMY_NH_359903_000175 in EOY data
2025-05-10 08:34:06,994 [INFO    ] [cost_model.projections.runner.run_projection_engine:236] Year 2026 - Comprehensive snapshot shape: (166, 12), includes all employees with compensation during the year
2025-05-10 08:34:06,996 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:34:06,996 [INFO    ] [cost_model.projections.runner.run_projection_engine:316] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:34:06,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:317] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 8
2025-05-10 08:34:06,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:318] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 8
2025-05-10 08:34:06,997 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2026] Found 8 unique employee IDs hired in 2026.
2025-05-10 08:34:06,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2026] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
320  evt_hire_2026_0000        NaT  NH_2026_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
321  evt_hire_2026_0001        NaT  NH_2026_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
322  evt_hire_2026_0002        NaT  NH_2026_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
323  evt_hire_2026_0003        NaT  NH_2026_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
324  evt_hire_2026_0004        NaT  NH_2026_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2026
2025-05-10 08:34:06,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:341] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 79
2025-05-10 08:34:06,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:345] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 8
2025-05-10 08:34:06,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:369] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=71, New Hire=8, Total Active=79
2025-05-10 08:34:06,998 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:34:07,010 [INFO    ] [cost_model.engines.run_one_year.run_one_year:139] [RUN_ONE_YEAR YR=2027] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:34:07,012 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 162 new events...
2025-05-10 08:34:07,015 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (166, 11)
2025-05-10 08:34:07,015 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2027] Starting count: 166, Terminated: 0, Survivors: 166
2025-05-10 08:34:07,015 [INFO    ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR YR=2027] Starting Headcount: 166, Survivors: 166, Growth Rate: 0.0500
2025-05-10 08:34:07,015 [INFO    ] [cost_model.engines.run_one_year.run_one_year:207] [RUN_ONE_YEAR YR=2027] Target Headcount: 175, Hires needed: 9
2025-05-10 08:34:07,016 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 166, Target EOY: 175, Needed before gross-up: 9
2025-05-10 08:34:07,016 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2027] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:34:07,016 [INFO    ] [cost_model.engines.run_one_year.run_one_year:213] [RUN_ONE_YEAR YR=2027] Hiring target: 175 (survivors + new hires)
2025-05-10 08:34:07,017 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((166, 11)) with 18 new events...
2025-05-10 08:34:07,023 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:34:07,024 [WARNING ] [cost_model.engines.run_one_year.run_one_year:259] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:146] EOY 2027 - Snapshot shape: (175, 11), Active: 83
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:147] EOY 2027 - Events generated this year: 342
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:176] Year 2027 - Found 24 termination events
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:34:07,025 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_668428_000238
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_862579_000146
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_761402_000211
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_668428_000238
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_862579_000146
2025-05-10 08:34:07,026 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:34:07,027 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_590026_000145 in EOY data
2025-05-10 08:34:07,027 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:34:07,028 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:34:07,028 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:34:07,028 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_761402_000211 in EOY data
2025-05-10 08:34:07,029 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:34:07,029 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_628360_000222 in EOY data
2025-05-10 08:34:07,029 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:34:07,030 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_668428_000238 in EOY data
2025-05-10 08:34:07,030 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_938622_000132 in EOY data
2025-05-10 08:34:07,030 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_862579_000146 in EOY data
2025-05-10 08:34:07,031 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2027 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:34:07,031 [INFO    ] [cost_model.projections.runner.run_projection_engine:236] Year 2027 - Comprehensive snapshot shape: (175, 12), includes all employees with compensation during the year
2025-05-10 08:34:07,032 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:34:07,033 [INFO    ] [cost_model.projections.runner.run_projection_engine:316] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:34:07,033 [INFO    ] [cost_model.projections.runner.run_projection_engine:317] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 9
2025-05-10 08:34:07,033 [INFO    ] [cost_model.projections.runner.run_projection_engine:318] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 9
2025-05-10 08:34:07,033 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2027] Found 9 unique employee IDs hired in 2027.
2025-05-10 08:34:07,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2027] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
324  evt_hire_2027_0000        NaT  NH_2027_0001       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
325  evt_hire_2027_0001        NaT  NH_2027_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
326  evt_hire_2027_0002        NaT  NH_2027_0003       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
327  evt_hire_2027_0003        NaT  NH_2027_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2027
328  evt_hire_2027_0004        NaT  NH_2027_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2027
2025-05-10 08:34:07,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:341] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 83
2025-05-10 08:34:07,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:345] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 9
2025-05-10 08:34:07,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:369] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=74, New Hire=9, Total Active=83
2025-05-10 08:34:07,034 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:34:07,046 [INFO    ] [cost_model.engines.run_one_year.run_one_year:139] [RUN_ONE_YEAR YR=2028] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:34:07,048 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 162 new events...
2025-05-10 08:34:07,051 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (175, 11)
2025-05-10 08:34:07,051 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2028] Starting count: 175, Terminated: 0, Survivors: 175
2025-05-10 08:34:07,051 [INFO    ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR YR=2028] Starting Headcount: 175, Survivors: 175, Growth Rate: 0.0500
2025-05-10 08:34:07,051 [INFO    ] [cost_model.engines.run_one_year.run_one_year:207] [RUN_ONE_YEAR YR=2028] Target Headcount: 184, Hires needed: 9
2025-05-10 08:34:07,051 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 175, Target EOY: 184, Needed before gross-up: 9
2025-05-10 08:34:07,052 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2028] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 9
2025-05-10 08:34:07,052 [INFO    ] [cost_model.engines.run_one_year.run_one_year:213] [RUN_ONE_YEAR YR=2028] Hiring target: 184 (survivors + new hires)
2025-05-10 08:34:07,053 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((175, 11)) with 18 new events...
2025-05-10 08:34:07,060 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:34:07,060 [WARNING ] [cost_model.engines.run_one_year.run_one_year:259] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:34:07,061 [INFO    ] [cost_model.projections.runner.run_projection_engine:146] EOY 2028 - Snapshot shape: (184, 11), Active: 87
2025-05-10 08:34:07,061 [INFO    ] [cost_model.projections.runner.run_projection_engine:147] EOY 2028 - Events generated this year: 342
2025-05-10 08:34:07,061 [INFO    ] [cost_model.projections.runner.run_projection_engine:176] Year 2028 - Found 24 termination events
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_845395_000043
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_814926_000102
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_214746_000176
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_432398_000192
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_884012_000181
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_563570_000093
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_845395_000043
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_814926_000102
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_214746_000176
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_194336_000237
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_432398_000192
2025-05-10 08:34:07,062 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_884012_000181
2025-05-10 08:34:07,063 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_563570_000093
2025-05-10 08:34:07,063 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_EX_845395_000043 in EOY data
2025-05-10 08:34:07,063 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_814926_000102 in EOY data
2025-05-10 08:34:07,064 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_214746_000176 in EOY data
2025-05-10 08:34:07,064 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_654803_000185 in EOY data
2025-05-10 08:34:07,064 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_628360_000222 in EOY data
2025-05-10 08:34:07,065 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:34:07,065 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_194336_000237 in EOY data
2025-05-10 08:34:07,065 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:34:07,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:34:07,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_432398_000192 in EOY data
2025-05-10 08:34:07,066 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_NH_884012_000181 in EOY data
2025-05-10 08:34:07,067 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2028 - Updated termination date for employee DUMMY_EX_563570_000093 in EOY data
2025-05-10 08:34:07,067 [INFO    ] [cost_model.projections.runner.run_projection_engine:236] Year 2028 - Comprehensive snapshot shape: (184, 12), includes all employees with compensation during the year
2025-05-10 08:34:07,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:34:07,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:316] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:34:07,068 [INFO    ] [cost_model.projections.runner.run_projection_engine:317] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 9
2025-05-10 08:34:07,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:318] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 9
2025-05-10 08:34:07,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2028] Found 9 unique employee IDs hired in 2028.
2025-05-10 08:34:07,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2028] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                     value_json meta  year
324  evt_hire_2028_0000        NaT  NH_2028_0001       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
325  evt_hire_2028_0001        NaT  NH_2028_0002       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
326  evt_hire_2028_0002        NaT  NH_2028_0003       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
327  evt_hire_2028_0003        NaT  NH_2028_0004       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
328  evt_hire_2028_0004        NaT  NH_2028_0005       hire        NaN  {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2028
2025-05-10 08:34:07,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:341] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 87
2025-05-10 08:34:07,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:345] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 9
2025-05-10 08:34:07,069 [INFO    ] [cost_model.projections.runner.run_projection_engine:369] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=78, New Hire=9, Total Active=87
2025-05-10 08:34:07,070 [INFO    ] [cost_model.projections.runner.run_projection_engine:133] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:34:07,082 [INFO    ] [cost_model.engines.run_one_year.run_one_year:139] [RUN_ONE_YEAR YR=2029] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:34:07,084 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 164 new events...
2025-05-10 08:34:07,087 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (184, 11)
2025-05-10 08:34:07,087 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2029] Starting count: 184, Terminated: 0, Survivors: 184
2025-05-10 08:34:07,087 [INFO    ] [cost_model.engines.run_one_year.run_one_year:206] [RUN_ONE_YEAR YR=2029] Starting Headcount: 184, Survivors: 184, Growth Rate: 0.0500
2025-05-10 08:34:07,087 [INFO    ] [cost_model.engines.run_one_year.run_one_year:207] [RUN_ONE_YEAR YR=2029] Target Headcount: 194, Hires needed: 10
2025-05-10 08:34:07,087 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 184, Target EOY: 194, Needed before gross-up: 10
2025-05-10 08:34:07,088 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2029] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 10
2025-05-10 08:34:07,088 [INFO    ] [cost_model.engines.run_one_year.run_one_year:213] [RUN_ONE_YEAR YR=2029] Hiring target: 194 (survivors + new hires)
2025-05-10 08:34:07,089 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((184, 11)) with 20 new events...
2025-05-10 08:34:07,096 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (194, 11)
2025-05-10 08:34:07,096 [WARNING ] [cost_model.engines.run_one_year.run_one_year:259] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:34:07,097 [INFO    ] [cost_model.projections.runner.run_projection_engine:146] EOY 2029 - Snapshot shape: (194, 11), Active: 92
2025-05-10 08:34:07,097 [INFO    ] [cost_model.projections.runner.run_projection_engine:147] EOY 2029 - Events generated this year: 348
2025-05-10 08:34:07,097 [INFO    ] [cost_model.projections.runner.run_projection_engine:176] Year 2029 - Found 28 termination events
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_181509_000011
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_814926_000102
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_824486_000113
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_317413_000228
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_181509_000011
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_814926_000102
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_824486_000113
2025-05-10 08:34:07,098 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_978079_000117
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_590026_000145
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_317413_000228
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:185] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:34:07,099 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_EX_181509_000011 in EOY data
2025-05-10 08:34:07,100 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_EX_557478_000081 in EOY data
2025-05-10 08:34:07,100 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_814926_000102 in EOY data
2025-05-10 08:34:07,100 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_824486_000113 in EOY data
2025-05-10 08:34:07,101 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_978079_000117 in EOY data
2025-05-10 08:34:07,101 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_590026_000145 in EOY data
2025-05-10 08:34:07,101 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:34:07,102 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_775373_000204 in EOY data
2025-05-10 08:34:07,102 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:34:07,102 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:34:07,103 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_317413_000228 in EOY data
2025-05-10 08:34:07,103 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_120009_000233 in EOY data
2025-05-10 08:34:07,103 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:34:07,104 [INFO    ] [cost_model.projections.runner.run_projection_engine:199] Year 2029 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:34:07,104 [INFO    ] [cost_model.projections.runner.run_projection_engine:236] Year 2029 - Comprehensive snapshot shape: (194, 12), includes all employees with compensation during the year
2025-05-10 08:34:07,106 [INFO    ] [cost_model.projections.runner.run_projection_engine:315] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:34:07,106 [INFO    ] [cost_model.projections.runner.run_projection_engine:316] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:34:07,106 [INFO    ] [cost_model.projections.runner.run_projection_engine:317] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 10
2025-05-10 08:34:07,106 [INFO    ] [cost_model.projections.runner.run_projection_engine:318] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 10
2025-05-10 08:34:07,106 [INFO    ] [cost_model.projections.runner.run_projection_engine:326] [RUNNER EMP_STATUS_SUM YR=2029] Found 10 unique employee IDs hired in 2029.
2025-05-10 08:34:07,107 [INFO    ] [cost_model.projections.runner.run_projection_engine:328] [RUNNER EMP_STATUS_SUM YR=2029] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                       value_json meta  year
328  evt_hire_2029_0000        NaT  NH_2029_0001       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
329  evt_hire_2029_0001        NaT  NH_2029_0002       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
330  evt_hire_2029_0002        NaT  NH_2029_0003       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
331  evt_hire_2029_0003        NaT  NH_2029_0004       hire        NaN    {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2029
332  evt_hire_2029_0004        NaT  NH_2029_0005       hire        NaN  {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2029
2025-05-10 08:34:07,107 [INFO    ] [cost_model.projections.runner.run_projection_engine:341] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 92
2025-05-10 08:34:07,107 [INFO    ] [cost_model.projections.runner.run_projection_engine:345] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 10
2025-05-10 08:34:07,107 [INFO    ] [cost_model.projections.runner.run_projection_engine:369] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=82, New Hire=10, Total Active=92
2025-05-10 08:34:07,108 [INFO    ] [cost_model.projections.runner.run_projection_engine:413] Projection engine run completed.
2025-05-10 08:34:07,108 [INFO    ] [cost_model.projections.runner.run_projection_engine:419] Final EOY Snapshot (2029) shape: (194, 11)
2025-05-10 08:34:07,108 [INFO    ] [cost_model.projections.runner.run_projection_engine:420] Final Cumulative Event Log shape: (1786, 8)
2025-05-10 08:34:07,108 [INFO    ] [cost_model.projections.runner.run_projection_engine:421] Summary Results:
2025-05-10 08:34:07,109 [INFO    ] [cost_model.projections.runner.run_projection_engine:422] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025                75              75                 60                         6602532.37                    0.0                    0.0          6602532.37               88033.764933         46.903879            0.800000                          3.916667
1             2026                79              79                 56                         6361039.99                    0.0                    0.0          6361039.99               80519.493544         48.595852            0.708861                          3.946429
2             2027                83              83                 52                         5961483.00                    0.0                    0.0          5961483.00               71825.096386         49.594940            0.626506                          3.980769
3             2028                87              87                 47                         5508629.26                    0.0                    0.0          5508629.26               63317.577701         49.938450            0.540230                          3.787234
4             2029                92              92                 43                         5087561.30                    0.0                    0.0          5087561.30               55299.579348         50.523842            0.467391                          3.790698
2025-05-10 08:34:07,109 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:34:07,109 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:34:07,109 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:34:07,115 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:34:07,116 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:34:07,118 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:34:07,118 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:34:07,123 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:34:07,126 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:34:07,126 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:34:07,126 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:34:07,126 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:34:07,126 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:34:07,126 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:34:07,126 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:36:49,346 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:36:49,346 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:36:49,351 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:36:49,351 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:36:49,351 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:36:49,351 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:36:49,402 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:36:49,403 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:36:49,408 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:36:49,408 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:36:49,408 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:36:49,410 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:36:49,410 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:36:49,410 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:36:49,410 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:36:49,410 [INFO    ] [cost_model.projections.runner.run_projection_engine:101] Initial snapshot - Total employees: 150, Active employees: 150, Terminated: 0
2025-05-10 08:36:49,410 [INFO    ] [cost_model.projections.runner.run_projection_engine:112] Actual active employees for growth calculations: 150
2025-05-10 08:36:49,410 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:36:49,411 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:36:49,412 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:36:49,412 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:36:49,421 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 150 active employees
2025-05-10 08:36:49,427 [INFO    ] [cost_model.engines.run_one_year.run_one_year:144] [RUN_ONE_YEAR YR=2025] Special adjustment for first year: Setting termination rate to 0.3500 to achieve exactly 105 active employees
2025-05-10 08:36:49,430 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 201 new events...
2025-05-10 08:36:49,434 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:36:49,435 [INFO    ] [cost_model.engines.run_one_year.run_one_year:180] [RUN_ONE_YEAR YR=2025] Starting count: 150, Terminated: 0, Survivors: 150
2025-05-10 08:36:49,435 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 150 active employees
2025-05-10 08:36:49,436 [INFO    ] [cost_model.engines.run_one_year.run_one_year:224] [RUN_ONE_YEAR YR=2025] Starting Headcount: 150, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:36:49,436 [INFO    ] [cost_model.engines.run_one_year.run_one_year:225] [RUN_ONE_YEAR YR=2025] Target Headcount: 158, Hires needed: 8
2025-05-10 08:36:49,436 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 158, Needed before gross-up: 8
2025-05-10 08:36:49,437 [INFO    ] [cost_model.engines.hire.run:61] [HIRE.RUN YR=2025] Avg NH Term Rate: 0.0000, Hires to make (grossed-up): 8
2025-05-10 08:36:49,438 [INFO    ] [cost_model.engines.run_one_year.run_one_year:231] [RUN_ONE_YEAR YR=2025] Hiring target: 158 (survivors + new hires)
2025-05-10 08:36:49,438 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 16 new events...
2025-05-10 08:36:49,447 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:36:49,447 [WARNING ] [cost_model.engines.run_one_year.run_one_year:277] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:36:49,448 [INFO    ] [cost_model.projections.runner.run_projection_engine:153] EOY 2025 - Snapshot shape: (158, 11), Active: 107
2025-05-10 08:36:49,448 [INFO    ] [cost_model.projections.runner.run_projection_engine:154] EOY 2025 - Events generated this year: 418
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:183] Year 2025 - Found 102 termination events
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_768665_000121
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_630610_000139
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_320008_000165
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_975970_000188
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:36:49,449 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_725374_000239
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_981004_000160
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:36:49,450 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_194135_000159
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_529547_000075
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_165566_000136
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557478_000081
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_768665_000121
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_630610_000139
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_320008_000165
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_975970_000188
2025-05-10 08:36:49,451 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_725374_000239
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_981004_000160
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_423833_000171
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_945525_000108
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:36:49,452 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_194135_000159
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_529547_000075
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_165566_000136
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:36:49,453 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:36:49,454 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:36:49,454 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_557478_000081 in EOY data
2025-05-10 08:36:49,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:36:49,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_768665_000121 in EOY data
2025-05-10 08:36:49,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:36:49,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_630610_000139 in EOY data
2025-05-10 08:36:49,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_820606_000155 in EOY data
2025-05-10 08:36:49,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_320008_000165 in EOY data
2025-05-10 08:36:49,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:36:49,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_302145_000170 in EOY data
2025-05-10 08:36:49,458 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:36:49,458 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_975970_000188 in EOY data
2025-05-10 08:36:49,459 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_189765_000194 in EOY data
2025-05-10 08:36:49,459 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_564913_000201 in EOY data
2025-05-10 08:36:49,459 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:36:49,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:36:49,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:36:49,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:36:49,461 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:36:49,461 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:36:49,462 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_377257_000224 in EOY data
2025-05-10 08:36:49,462 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_542881_000225 in EOY data
2025-05-10 08:36:49,462 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:36:49,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:36:49,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:36:49,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:36:49,464 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:36:49,464 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_725374_000239 in EOY data
2025-05-10 08:36:49,464 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:36:49,465 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:36:49,465 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:36:49,465 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:36:49,466 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_874410_000200 in EOY data
2025-05-10 08:36:49,466 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_937981_000164 in EOY data
2025-05-10 08:36:49,466 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:36:49,467 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_981004_000160 in EOY data
2025-05-10 08:36:49,467 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_423833_000171 in EOY data
2025-05-10 08:36:49,467 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_945525_000108 in EOY data
2025-05-10 08:36:49,467 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:36:49,468 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:36:49,468 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_924184_000152 in EOY data
2025-05-10 08:36:49,468 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:36:49,469 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:36:49,469 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_194135_000159 in EOY data
2025-05-10 08:36:49,469 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_983688_000154 in EOY data
2025-05-10 08:36:49,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:36:49,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_376781_000092 in EOY data
2025-05-10 08:36:49,471 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_EX_529547_000075 in EOY data
2025-05-10 08:36:49,471 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_165566_000136 in EOY data
2025-05-10 08:36:49,472 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2025 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:36:49,472 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] Year 2025 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:36:49,474 [INFO    ] [cost_model.projections.runner.run_projection_engine:322] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:36:49,474 [INFO    ] [cost_model.projections.runner.run_projection_engine:323] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term' 'hire']
2025-05-10 08:36:49,474 [INFO    ] [cost_model.projections.runner.run_projection_engine:324] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 8
2025-05-10 08:36:49,474 [INFO    ] [cost_model.projections.runner.run_projection_engine:325] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 8
2025-05-10 08:36:49,474 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2025] Found 8 unique employee IDs hired in 2025.
2025-05-10 08:36:49,475 [INFO    ] [cost_model.projections.runner.run_projection_engine:335] [RUNNER EMP_STATUS_SUM YR=2025] Sample of current_year_hire_events_df:
               event_id event_time   employee_id event_type  value_num                                         value_json meta  year
402  evt_hire_2025_0000        NaT  NH_2025_0001       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
403  evt_hire_2025_0001        NaT  NH_2025_0002       hire        NaN  {"role": "Executive", "birth_date": "1990-01-01"}  NaN  2025
404  evt_hire_2025_0002        NaT  NH_2025_0003       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
405  evt_hire_2025_0003        NaT  NH_2025_0004       hire        NaN      {"role": "Staff", "birth_date": "1990-01-01"}  NaN  2025
406  evt_hire_2025_0004        NaT  NH_2025_0005       hire        NaN    {"role": "Manager", "birth_date": "1990-01-01"}  NaN  2025
2025-05-10 08:36:49,475 [INFO    ] [cost_model.projections.runner.run_projection_engine:348] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 107
2025-05-10 08:36:49,475 [INFO    ] [cost_model.projections.runner.run_projection_engine:352] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 8
2025-05-10 08:36:49,475 [INFO    ] [cost_model.projections.runner.run_projection_engine:376] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=99, New Hire=8, Total Active=107
2025-05-10 08:36:49,476 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:36:49,485 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2026] Using 'active' column for headcount: 107 active employees
2025-05-10 08:36:49,489 [INFO    ] [cost_model.engines.run_one_year.run_one_year:148] [RUN_ONE_YEAR YR=2026] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:36:49,489 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 158
2025-05-10 08:36:49,489 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 158
2025-05-10 08:36:49,489 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:36:49,490 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (158, 12)
2025-05-10 08:36:49,490 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0      0.075
1      0.075
2      0.075
3      0.075
4      0.075
2025-05-10 08:36:49,490 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 8
2025-05-10 08:36:49,491 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.075 0.075 0.075 0.075 0.075]
2025-05-10 08:36:49,491 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 10
2025-05-10 08:36:49,491 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 160 new events...
2025-05-10 08:36:49,494 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:36:49,495 [INFO    ] [cost_model.engines.run_one_year.run_one_year:180] [RUN_ONE_YEAR YR=2026] Starting count: 107, Terminated: -51, Survivors: 158
2025-05-10 08:36:49,495 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2026] Using 'active' column for headcount: 107 active employees
2025-05-10 08:36:49,495 [INFO    ] [cost_model.engines.run_one_year.run_one_year:224] [RUN_ONE_YEAR YR=2026] Starting Headcount: 107, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:36:49,495 [INFO    ] [cost_model.engines.run_one_year.run_one_year:225] [RUN_ONE_YEAR YR=2026] Target Headcount: 113, Hires needed: 0
2025-05-10 08:36:49,495 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 158, Target EOY: 158, Needed before gross-up: 0
2025-05-10 08:36:49,495 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2026] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:36:49,496 [INFO    ] [cost_model.engines.run_one_year.run_one_year:231] [RUN_ONE_YEAR YR=2026] Hiring target: 158 (survivors + new hires)
2025-05-10 08:36:49,497 [WARNING ] [cost_model.engines.run_one_year.run_one_year:277] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:36:49,498 [INFO    ] [cost_model.projections.runner.run_projection_engine:153] EOY 2026 - Snapshot shape: (158, 11), Active: 102
2025-05-10 08:36:49,498 [INFO    ] [cost_model.projections.runner.run_projection_engine:154] EOY 2026 - Events generated this year: 320
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:183] Year 2026 - Found 20 termination events
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_995917_000082
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_302145_000170
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_564913_000201
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:36:49,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:36:49,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_674346_000243
2025-05-10 08:36:49,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:36:49,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_359903_000175
2025-05-10 08:36:49,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_EX_995917_000082 in EOY data
2025-05-10 08:36:49,501 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_302145_000170 in EOY data
2025-05-10 08:36:49,501 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_564913_000201 in EOY data
2025-05-10 08:36:49,501 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:36:49,502 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_329729_000232 in EOY data
2025-05-10 08:36:49,502 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_120009_000233 in EOY data
2025-05-10 08:36:49,502 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:36:49,502 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_674346_000243 in EOY data
2025-05-10 08:36:49,503 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:36:49,503 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2026 - Updated termination date for employee DUMMY_NH_359903_000175 in EOY data
2025-05-10 08:36:49,503 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] Year 2026 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:36:49,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:322] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:36:49,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:323] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:36:49,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:324] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 0
2025-05-10 08:36:49,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:325] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 0
2025-05-10 08:36:49,506 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2026] Found 0 unique employee IDs hired in 2026.
2025-05-10 08:36:49,506 [INFO    ] [cost_model.projections.runner.run_projection_engine:348] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 102
2025-05-10 08:36:49,506 [INFO    ] [cost_model.projections.runner.run_projection_engine:352] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 0
2025-05-10 08:36:49,506 [INFO    ] [cost_model.projections.runner.run_projection_engine:376] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=102, New Hire=0, Total Active=102
2025-05-10 08:36:49,506 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:36:49,513 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2027] Using 'active' column for headcount: 102 active employees
2025-05-10 08:36:49,518 [INFO    ] [cost_model.engines.run_one_year.run_one_year:148] [RUN_ONE_YEAR YR=2027] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:36:49,520 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 160 new events...
2025-05-10 08:36:49,523 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:36:49,523 [INFO    ] [cost_model.engines.run_one_year.run_one_year:180] [RUN_ONE_YEAR YR=2027] Starting count: 102, Terminated: -56, Survivors: 158
2025-05-10 08:36:49,523 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2027] Using 'active' column for headcount: 102 active employees
2025-05-10 08:36:49,523 [INFO    ] [cost_model.engines.run_one_year.run_one_year:224] [RUN_ONE_YEAR YR=2027] Starting Headcount: 102, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:36:49,523 [INFO    ] [cost_model.engines.run_one_year.run_one_year:225] [RUN_ONE_YEAR YR=2027] Target Headcount: 108, Hires needed: 0
2025-05-10 08:36:49,524 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 158, Target EOY: 158, Needed before gross-up: 0
2025-05-10 08:36:49,524 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2027] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:36:49,524 [INFO    ] [cost_model.engines.run_one_year.run_one_year:231] [RUN_ONE_YEAR YR=2027] Hiring target: 158 (survivors + new hires)
2025-05-10 08:36:49,526 [WARNING ] [cost_model.engines.run_one_year.run_one_year:277] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:153] EOY 2027 - Snapshot shape: (158, 11), Active: 97
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:154] EOY 2027 - Events generated this year: 320
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:183] Year 2027 - Found 20 termination events
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_977990_000223
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_317413_000228
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_270716_000250
2025-05-10 08:36:49,527 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_233734_000182
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_681254_000214
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_628360_000222
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_977990_000223
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_317413_000228
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_506687_000234
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_270716_000250
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:36:49,528 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_233734_000182 in EOY data
2025-05-10 08:36:49,529 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_681254_000214 in EOY data
2025-05-10 08:36:49,529 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:36:49,530 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_628360_000222 in EOY data
2025-05-10 08:36:49,530 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_977990_000223 in EOY data
2025-05-10 08:36:49,530 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_317413_000228 in EOY data
2025-05-10 08:36:49,531 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_506687_000234 in EOY data
2025-05-10 08:36:49,531 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:36:49,531 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_270716_000250 in EOY data
2025-05-10 08:36:49,532 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2027 - Updated termination date for employee DUMMY_NH_983688_000154 in EOY data
2025-05-10 08:36:49,532 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] Year 2027 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:36:49,533 [INFO    ] [cost_model.projections.runner.run_projection_engine:322] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:323] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:324] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 0
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:325] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 0
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2027] Found 0 unique employee IDs hired in 2027.
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:348] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 97
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:352] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 0
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:376] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=97, New Hire=0, Total Active=97
2025-05-10 08:36:49,534 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:36:49,543 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2028] Using 'active' column for headcount: 97 active employees
2025-05-10 08:36:49,547 [INFO    ] [cost_model.engines.run_one_year.run_one_year:148] [RUN_ONE_YEAR YR=2028] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:36:49,548 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 162 new events...
2025-05-10 08:36:49,551 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:36:49,551 [INFO    ] [cost_model.engines.run_one_year.run_one_year:180] [RUN_ONE_YEAR YR=2028] Starting count: 97, Terminated: -61, Survivors: 158
2025-05-10 08:36:49,552 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2028] Using 'active' column for headcount: 97 active employees
2025-05-10 08:36:49,552 [INFO    ] [cost_model.engines.run_one_year.run_one_year:224] [RUN_ONE_YEAR YR=2028] Starting Headcount: 97, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:36:49,552 [INFO    ] [cost_model.engines.run_one_year.run_one_year:225] [RUN_ONE_YEAR YR=2028] Target Headcount: 102, Hires needed: 0
2025-05-10 08:36:49,552 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 158, Target EOY: 158, Needed before gross-up: 0
2025-05-10 08:36:49,552 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2028] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:36:49,553 [INFO    ] [cost_model.engines.run_one_year.run_one_year:231] [RUN_ONE_YEAR YR=2028] Hiring target: 158 (survivors + new hires)
2025-05-10 08:36:49,554 [WARNING ] [cost_model.engines.run_one_year.run_one_year:277] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:153] EOY 2028 - Snapshot shape: (158, 11), Active: 89
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:154] EOY 2028 - Events generated this year: 324
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:183] Year 2028 - Found 24 termination events
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_449357_000103
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_785598_000173
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:36:49,555 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_450171_000196
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_972372_000156
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_884012_000181
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_449357_000103
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_785598_000173
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_450171_000196
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_972372_000156
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_884012_000181
2025-05-10 08:36:49,556 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:36:49,557 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:36:49,557 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_449357_000103 in EOY data
2025-05-10 08:36:49,558 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_785598_000173 in EOY data
2025-05-10 08:36:49,558 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_775373_000204 in EOY data
2025-05-10 08:36:49,558 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:36:49,559 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_150696_000231 in EOY data
2025-05-10 08:36:49,559 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_450171_000196 in EOY data
2025-05-10 08:36:49,559 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_162302_000174 in EOY data
2025-05-10 08:36:49,559 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_972372_000156 in EOY data
2025-05-10 08:36:49,560 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:36:49,560 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_NH_884012_000181 in EOY data
2025-05-10 08:36:49,560 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2028 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:36:49,561 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] Year 2028 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:322] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:323] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:324] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 0
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:325] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 0
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2028] Found 0 unique employee IDs hired in 2028.
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:348] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 89
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:352] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 0
2025-05-10 08:36:49,563 [INFO    ] [cost_model.projections.runner.run_projection_engine:376] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=89, New Hire=0, Total Active=89
2025-05-10 08:36:49,564 [INFO    ] [cost_model.projections.runner.run_projection_engine:140] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:36:49,571 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2029] Using 'active' column for headcount: 89 active employees
2025-05-10 08:36:49,575 [INFO    ] [cost_model.engines.run_one_year.run_one_year:148] [RUN_ONE_YEAR YR=2029] Adjusting termination rate from 0.1500 to 0.0750 to ensure growth
2025-05-10 08:36:49,577 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((158, 11)) with 170 new events...
2025-05-10 08:36:49,580 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (158, 11)
2025-05-10 08:36:49,580 [INFO    ] [cost_model.engines.run_one_year.run_one_year:180] [RUN_ONE_YEAR YR=2029] Starting count: 89, Terminated: -69, Survivors: 158
2025-05-10 08:36:49,580 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2029] Using 'active' column for headcount: 89 active employees
2025-05-10 08:36:49,581 [INFO    ] [cost_model.engines.run_one_year.run_one_year:224] [RUN_ONE_YEAR YR=2029] Starting Headcount: 89, Survivors: 158, Growth Rate: 0.0500
2025-05-10 08:36:49,581 [INFO    ] [cost_model.engines.run_one_year.run_one_year:225] [RUN_ONE_YEAR YR=2029] Target Headcount: 94, Hires needed: 0
2025-05-10 08:36:49,581 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 158, Target EOY: 158, Needed before gross-up: 0
2025-05-10 08:36:49,581 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2029] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:36:49,581 [INFO    ] [cost_model.engines.run_one_year.run_one_year:231] [RUN_ONE_YEAR YR=2029] Hiring target: 158 (survivors + new hires)
2025-05-10 08:36:49,583 [WARNING ] [cost_model.engines.run_one_year.run_one_year:277] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:153] EOY 2029 - Snapshot shape: (158, 11), Active: 78
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:154] EOY 2029 - Events generated this year: 340
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:183] Year 2029 - Found 40 termination events
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_371360_000016
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_975970_000188
2025-05-10 08:36:49,584 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_803274_000213
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_668428_000238
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_802446_000158
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_884012_000181
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_862579_000146
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_371360_000016
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_975970_000188
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_775373_000204
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_434417_000207
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_803274_000213
2025-05-10 08:36:49,585 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_668428_000238
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_802446_000158
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_884012_000181
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_983688_000154
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:36:49,586 [INFO    ] [cost_model.projections.runner.run_projection_engine:192] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_862579_000146
2025-05-10 08:36:49,587 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_EX_371360_000016 in EOY data
2025-05-10 08:36:49,587 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:36:49,587 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_876713_000183 in EOY data
2025-05-10 08:36:49,587 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_975970_000188 in EOY data
2025-05-10 08:36:49,588 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_189765_000194 in EOY data
2025-05-10 08:36:49,588 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_775373_000204 in EOY data
2025-05-10 08:36:49,588 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_434417_000207 in EOY data
2025-05-10 08:36:49,589 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_803274_000213 in EOY data
2025-05-10 08:36:49,589 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:36:49,589 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_150696_000231 in EOY data
2025-05-10 08:36:49,590 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:36:49,590 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_668428_000238 in EOY data
2025-05-10 08:36:49,590 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_225724_000240 in EOY data
2025-05-10 08:36:49,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:36:49,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_802446_000158 in EOY data
2025-05-10 08:36:49,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_162302_000174 in EOY data
2025-05-10 08:36:49,591 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_884012_000181 in EOY data
2025-05-10 08:36:49,592 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_983688_000154 in EOY data
2025-05-10 08:36:49,592 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_930610_000177 in EOY data
2025-05-10 08:36:49,592 [INFO    ] [cost_model.projections.runner.run_projection_engine:206] Year 2029 - Updated termination date for employee DUMMY_NH_862579_000146 in EOY data
2025-05-10 08:36:49,592 [INFO    ] [cost_model.projections.runner.run_projection_engine:243] Year 2029 - Comprehensive snapshot shape: (158, 12), includes all employees with compensation during the year
2025-05-10 08:36:49,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:322] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:36:49,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:323] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:36:49,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:324] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 0
2025-05-10 08:36:49,594 [INFO    ] [cost_model.projections.runner.run_projection_engine:325] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 0
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2029] Found 0 unique employee IDs hired in 2029.
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:348] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 78
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:352] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 0
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:376] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=78, New Hire=0, Total Active=78
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:420] Projection engine run completed.
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:426] Final EOY Snapshot (2029) shape: (158, 11)
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:427] Final Cumulative Event Log shape: (1722, 8)
2025-05-10 08:36:49,595 [INFO    ] [cost_model.projections.runner.run_projection_engine:428] Summary Results:
2025-05-10 08:36:49,596 [INFO    ] [cost_model.projections.runner.run_projection_engine:429] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025               107             107                 89                        10339682.23                    0.0                    0.0         10339682.23               96632.544206         46.861497            0.831776                          4.134831
1             2026               102             102                 85                         9895671.09                    0.0                    0.0          9895671.09               97016.383235         48.452474            0.833333                          4.164706
2             2027                97              97                 81                         9613158.33                    0.0                    0.0          9613158.33               99104.725052         49.243692            0.835052                          4.234568
3             2028                89              89                 75                         8782422.22                    0.0                    0.0          8782422.22               98678.901348         50.601567            0.842697                          4.280000
4             2029                78              78                 67                         7578681.96                    0.0                    0.0          7578681.96               97162.589231         51.219986            0.858974                          4.074627
2025-05-10 08:36:49,597 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:36:49,597 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:36:49,597 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:36:49,604 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:36:49,605 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:36:49,606 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:36:49,607 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:36:49,612 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:36:49,615 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:36:49,615 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:36:49,615 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:36:49,615 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:36:49,615 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:36:49,615 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:36:49,615 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:42:54,261 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:42:54,262 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:42:54,266 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:42:54,267 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:42:54,267 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:42:54,267 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:42:54,337 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:42:54,337 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:42:54,343 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:42:54,344 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:42:54,344 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:42:54,346 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:42:54,346 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:42:54,346 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:42:54,346 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:42:54,346 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 08:42:54,346 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 08:42:54,346 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:42:54,348 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:42:54,348 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:42:54,349 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:42:54,358 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 08:42:54,391 [INFO    ] [cost_model.engines.run_one_year.run_one_year:129] [RUN_ONE_YEAR YR=2025] Applying terminations based on configured rates in hazard_slice.
2025-05-10 08:42:54,395 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 173 new events...
2025-05-10 08:42:54,400 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:42:54,401 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2025] Starting count: 100, Terminated: -50, Survivors: 150
2025-05-10 08:42:54,401 [INFO    ] [cost_model.engines.run_one_year.run_one_year:167] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 08:42:54,401 [INFO    ] [cost_model.engines.run_one_year.run_one_year:195] [RUN_ONE_YEAR YR=2025] Starting Headcount: 100, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:42:54,401 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2025] Target Headcount: 105, Hires needed: 0
2025-05-10 08:42:54,401 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 150, Needed before gross-up: 0
2025-05-10 08:42:54,401 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2025] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:42:54,402 [INFO    ] [cost_model.engines.run_one_year.run_one_year:202] [RUN_ONE_YEAR YR=2025] Hiring target: 150 (survivors + new hires)
2025-05-10 08:42:54,403 [WARNING ] [cost_model.engines.run_one_year.run_one_year:248] [RUN_ONE_YEAR SIM_YR=2025] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2025.
2025-05-10 08:42:54,405 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] EOY 2025 - Snapshot shape: (150, 11), Active: 85
2025-05-10 08:42:54,405 [INFO    ] [cost_model.projections.runner.run_projection_engine:164] EOY 2025 - Events generated this year: 346
2025-05-10 08:42:54,405 [INFO    ] [cost_model.projections.runner.run_projection_engine:193] Year 2025 - Found 46 termination events
2025-05-10 08:42:54,405 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_557534_000035
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_871814_000048
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:42:54,406 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_264252_000128
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_189765_000194
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_286731_000202
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_252650_000209
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_268659_000210
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_542881_000225
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_713525_000235
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_772849_000190
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:42:54,407 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2025 - Setting termination date 2025-12-31 00:00:00 for employee DUMMY_NH_502603_000169
2025-05-10 08:42:54,408 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_EX_557534_000035 in EOY data
2025-05-10 08:42:54,409 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_EX_871814_000048 in EOY data
2025-05-10 08:42:54,421 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:42:54,422 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_264252_000128 in EOY data
2025-05-10 08:42:54,423 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:42:54,423 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_189765_000194 in EOY data
2025-05-10 08:42:54,423 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_286731_000202 in EOY data
2025-05-10 08:42:54,424 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_252650_000209 in EOY data
2025-05-10 08:42:54,424 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_268659_000210 in EOY data
2025-05-10 08:42:54,424 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:42:54,425 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_542881_000225 in EOY data
2025-05-10 08:42:54,425 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_713525_000235 in EOY data
2025-05-10 08:42:54,425 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:42:54,425 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:42:54,426 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:42:54,426 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:42:54,426 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:42:54,427 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:42:54,427 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:42:54,427 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_772849_000190 in EOY data
2025-05-10 08:42:54,428 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:42:54,428 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_EX_376781_000092 in EOY data
2025-05-10 08:42:54,428 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2025 - Updated termination date for employee DUMMY_NH_502603_000169 in EOY data
2025-05-10 08:42:54,428 [INFO    ] [cost_model.projections.runner.run_projection_engine:253] Year 2025 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:42:54,430 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2025] EVT_HIRE constant value: 'hire'
2025-05-10 08:42:54,430 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2025] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:42:54,430 [INFO    ] [cost_model.projections.runner.run_projection_engine:334] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events in log: 0
2025-05-10 08:42:54,431 [INFO    ] [cost_model.projections.runner.run_projection_engine:335] [RUNNER EMP_STATUS_SUM YR=2025] Total hire events matching EVT_HIRE: 0
2025-05-10 08:42:54,431 [INFO    ] [cost_model.projections.runner.run_projection_engine:343] [RUNNER EMP_STATUS_SUM YR=2025] Found 0 unique employee IDs hired in 2025.
2025-05-10 08:42:54,431 [INFO    ] [cost_model.projections.runner.run_projection_engine:358] [RUNNER EMP_STATUS_SUM YR=2025] Active headcount from summary: 85
2025-05-10 08:42:54,431 [INFO    ] [cost_model.projections.runner.run_projection_engine:362] [RUNNER EMP_STATUS_SUM YR=2025] New hires from event log: 0
2025-05-10 08:42:54,431 [INFO    ] [cost_model.projections.runner.run_projection_engine:386] [RUNNER EMP_STATUS_SUM YR=2025] Final counts: Continuous=85, New Hire=0, Total Active=85
2025-05-10 08:42:54,433 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2026 (Index 1) ---
2025-05-10 08:42:54,440 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2026] Using 'active' column for headcount: 85 active employees
2025-05-10 08:42:54,444 [INFO    ] [cost_model.engines.run_one_year.run_one_year:129] [RUN_ONE_YEAR YR=2026] Applying terminations based on configured rates in hazard_slice.
2025-05-10 08:42:54,445 [INFO    ] [cost_model.engines.term.run:54] [TERM.RUN YR=2026] Snapshot EOY active count (passed to term.run): 150
2025-05-10 08:42:54,445 [INFO    ] [cost_model.engines.term.run:55] [TERM.RUN YR=2026] Number of active employees for termination consideration (n): 150
2025-05-10 08:42:54,445 [INFO    ] [cost_model.engines.term.run:56] [TERM.RUN YR=2026] as_of date for filtering: 2025-01-01 00:00:00
2025-05-10 08:42:54,446 [INFO    ] [cost_model.engines.term.run:70] [TERM.RUN YR=2026] DataFrame 'df' shape after merge: (150, 12)
2025-05-10 08:42:54,447 [INFO    ] [cost_model.engines.term.run:71] [TERM.RUN YR=2026] Sample of term_rate in df (first 5):
   term_rate
0       0.15
1       0.15
2       0.15
3       0.15
4       0.15
2025-05-10 08:42:54,447 [INFO    ] [cost_model.engines.term.run:72] [TERM.RUN YR=2026] NaN term_rates after merge: 0
2025-05-10 08:42:54,447 [INFO    ] [cost_model.engines.term.run:88] [TERM.RUN YR=2026] Probabilistic mode. Probs array sample (first 5): [0.15 0.15 0.15 0.15 0.15]
2025-05-10 08:42:54,447 [INFO    ] [cost_model.engines.term.run:89] [TERM.RUN YR=2026] Number of losers: 30
2025-05-10 08:42:54,448 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 180 new events...
2025-05-10 08:42:54,450 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:42:54,450 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2026] Starting count: 85, Terminated: -65, Survivors: 150
2025-05-10 08:42:54,451 [INFO    ] [cost_model.engines.run_one_year.run_one_year:167] [RUN_ONE_YEAR YR=2026] Using 'active' column for headcount: 85 active employees
2025-05-10 08:42:54,451 [INFO    ] [cost_model.engines.run_one_year.run_one_year:195] [RUN_ONE_YEAR YR=2026] Starting Headcount: 85, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:42:54,451 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2026] Target Headcount: 90, Hires needed: 0
2025-05-10 08:42:54,451 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2026] Initial survivors (curr): 150, Target EOY: 150, Needed before gross-up: 0
2025-05-10 08:42:54,451 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2026] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:42:54,452 [INFO    ] [cost_model.engines.run_one_year.run_one_year:202] [RUN_ONE_YEAR YR=2026] Hiring target: 150 (survivors + new hires)
2025-05-10 08:42:54,453 [WARNING ] [cost_model.engines.run_one_year.run_one_year:248] [RUN_ONE_YEAR SIM_YR=2026] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2026.
2025-05-10 08:42:54,454 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] EOY 2026 - Snapshot shape: (150, 11), Active: 69
2025-05-10 08:42:54,454 [INFO    ] [cost_model.projections.runner.run_projection_engine:164] EOY 2026 - Events generated this year: 360
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:193] Year 2026 - Found 60 termination events
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_768665_000121
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_214746_000176
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:42:54,455 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_317413_000228
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_432398_000192
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_862579_000146
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_554513_000013
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_768665_000121
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_214746_000176
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_876713_000183
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_654803_000185
2025-05-10 08:42:54,456 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_572298_000205
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_317413_000228
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_122992_000249
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_432398_000192
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_374482_000089
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_162302_000174
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_751464_000179
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_918902_000199
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_891995_000110
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_EX_376781_000092
2025-05-10 08:42:54,457 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2026 - Setting termination date 2026-12-31 00:00:00 for employee DUMMY_NH_862579_000146
2025-05-10 08:42:54,458 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_EX_554513_000013 in EOY data
2025-05-10 08:42:54,458 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:42:54,458 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_768665_000121 in EOY data
2025-05-10 08:42:54,459 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:42:54,459 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_214746_000176 in EOY data
2025-05-10 08:42:54,459 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_383697_000180 in EOY data
2025-05-10 08:42:54,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_876713_000183 in EOY data
2025-05-10 08:42:54,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_654803_000185 in EOY data
2025-05-10 08:42:54,460 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_572298_000205 in EOY data
2025-05-10 08:42:54,461 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:42:54,461 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:42:54,462 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:42:54,462 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:42:54,462 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:42:54,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_317413_000228 in EOY data
2025-05-10 08:42:54,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:42:54,463 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:42:54,464 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_122992_000249 in EOY data
2025-05-10 08:42:54,464 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_432398_000192 in EOY data
2025-05-10 08:42:54,464 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_128328_000187 in EOY data
2025-05-10 08:42:54,465 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_937981_000164 in EOY data
2025-05-10 08:42:54,465 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_EX_374482_000089 in EOY data
2025-05-10 08:42:54,466 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_159455_000167 in EOY data
2025-05-10 08:42:54,466 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_162302_000174 in EOY data
2025-05-10 08:42:54,466 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_751464_000179 in EOY data
2025-05-10 08:42:54,467 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:42:54,467 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_918902_000199 in EOY data
2025-05-10 08:42:54,467 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_891995_000110 in EOY data
2025-05-10 08:42:54,468 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_EX_376781_000092 in EOY data
2025-05-10 08:42:54,468 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2026 - Updated termination date for employee DUMMY_NH_862579_000146 in EOY data
2025-05-10 08:42:54,468 [INFO    ] [cost_model.projections.runner.run_projection_engine:253] Year 2026 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2026] EVT_HIRE constant value: 'hire'
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2026] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:334] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events in log: 0
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:335] [RUNNER EMP_STATUS_SUM YR=2026] Total hire events matching EVT_HIRE: 0
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:343] [RUNNER EMP_STATUS_SUM YR=2026] Found 0 unique employee IDs hired in 2026.
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:358] [RUNNER EMP_STATUS_SUM YR=2026] Active headcount from summary: 69
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:362] [RUNNER EMP_STATUS_SUM YR=2026] New hires from event log: 0
2025-05-10 08:42:54,470 [INFO    ] [cost_model.projections.runner.run_projection_engine:386] [RUNNER EMP_STATUS_SUM YR=2026] Final counts: Continuous=69, New Hire=0, Total Active=69
2025-05-10 08:42:54,471 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2027 (Index 2) ---
2025-05-10 08:42:54,477 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2027] Using 'active' column for headcount: 69 active employees
2025-05-10 08:42:54,481 [INFO    ] [cost_model.engines.run_one_year.run_one_year:129] [RUN_ONE_YEAR YR=2027] Applying terminations based on configured rates in hazard_slice.
2025-05-10 08:42:54,483 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 180 new events...
2025-05-10 08:42:54,486 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:42:54,486 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2027] Starting count: 69, Terminated: -81, Survivors: 150
2025-05-10 08:42:54,487 [INFO    ] [cost_model.engines.run_one_year.run_one_year:167] [RUN_ONE_YEAR YR=2027] Using 'active' column for headcount: 69 active employees
2025-05-10 08:42:54,487 [INFO    ] [cost_model.engines.run_one_year.run_one_year:195] [RUN_ONE_YEAR YR=2027] Starting Headcount: 69, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:42:54,487 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2027] Target Headcount: 73, Hires needed: 0
2025-05-10 08:42:54,487 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2027] Initial survivors (curr): 150, Target EOY: 150, Needed before gross-up: 0
2025-05-10 08:42:54,487 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2027] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:42:54,487 [INFO    ] [cost_model.engines.run_one_year.run_one_year:202] [RUN_ONE_YEAR YR=2027] Hiring target: 150 (survivors + new hires)
2025-05-10 08:42:54,489 [WARNING ] [cost_model.engines.run_one_year.run_one_year:248] [RUN_ONE_YEAR SIM_YR=2027] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2027.
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] EOY 2027 - Snapshot shape: (150, 11), Active: 57
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:164] EOY 2027 - Events generated this year: 360
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:193] Year 2027 - Found 60 termination events
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_146765_000046
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_716045_000063
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_824486_000113
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_320008_000165
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_448152_000193
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:42:54,490 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_668428_000238
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_432398_000192
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_335025_000017
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_132546_000066
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_563570_000093
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_163468_000157
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_529547_000075
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_165566_000136
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_146765_000046
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_787530_000056
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_716045_000063
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_861514_000067
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_824486_000113
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_892526_000162
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_320008_000165
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_215889_000166
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_448152_000193
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_944917_000212
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_685439_000215
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_849254_000218
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_461781_000227
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_329729_000232
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_884113_000236
2025-05-10 08:42:54,491 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_668428_000238
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_972996_000245
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_952172_000246
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_211690_000247
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_432398_000192
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_937981_000164
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_335025_000017
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_938622_000132
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_132546_000066
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_563570_000093
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_163468_000157
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_EX_529547_000075
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2027 - Setting termination date 2027-12-31 00:00:00 for employee DUMMY_NH_165566_000136
2025-05-10 08:42:54,492 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_146765_000046 in EOY data
2025-05-10 08:42:54,493 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_787530_000056 in EOY data
2025-05-10 08:42:54,493 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_716045_000063 in EOY data
2025-05-10 08:42:54,493 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_861514_000067 in EOY data
2025-05-10 08:42:54,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_824486_000113 in EOY data
2025-05-10 08:42:54,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_892526_000162 in EOY data
2025-05-10 08:42:54,494 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_320008_000165 in EOY data
2025-05-10 08:42:54,495 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_215889_000166 in EOY data
2025-05-10 08:42:54,495 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_448152_000193 in EOY data
2025-05-10 08:42:54,495 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_944917_000212 in EOY data
2025-05-10 08:42:54,496 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_685439_000215 in EOY data
2025-05-10 08:42:54,496 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_849254_000218 in EOY data
2025-05-10 08:42:54,497 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_461781_000227 in EOY data
2025-05-10 08:42:54,497 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_329729_000232 in EOY data
2025-05-10 08:42:54,497 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_884113_000236 in EOY data
2025-05-10 08:42:54,498 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_668428_000238 in EOY data
2025-05-10 08:42:54,498 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_225724_000240 in EOY data
2025-05-10 08:42:54,498 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_972996_000245 in EOY data
2025-05-10 08:42:54,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_952172_000246 in EOY data
2025-05-10 08:42:54,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_211690_000247 in EOY data
2025-05-10 08:42:54,499 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_432398_000192 in EOY data
2025-05-10 08:42:54,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_937981_000164 in EOY data
2025-05-10 08:42:54,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_335025_000017 in EOY data
2025-05-10 08:42:54,500 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_938622_000132 in EOY data
2025-05-10 08:42:54,501 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_132546_000066 in EOY data
2025-05-10 08:42:54,501 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:42:54,502 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_563570_000093 in EOY data
2025-05-10 08:42:54,502 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_163468_000157 in EOY data
2025-05-10 08:42:54,502 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_EX_529547_000075 in EOY data
2025-05-10 08:42:54,503 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2027 - Updated termination date for employee DUMMY_NH_165566_000136 in EOY data
2025-05-10 08:42:54,503 [INFO    ] [cost_model.projections.runner.run_projection_engine:253] Year 2027 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2027] EVT_HIRE constant value: 'hire'
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2027] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:334] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events in log: 0
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:335] [RUNNER EMP_STATUS_SUM YR=2027] Total hire events matching EVT_HIRE: 0
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:343] [RUNNER EMP_STATUS_SUM YR=2027] Found 0 unique employee IDs hired in 2027.
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:358] [RUNNER EMP_STATUS_SUM YR=2027] Active headcount from summary: 57
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:362] [RUNNER EMP_STATUS_SUM YR=2027] New hires from event log: 0
2025-05-10 08:42:54,505 [INFO    ] [cost_model.projections.runner.run_projection_engine:386] [RUNNER EMP_STATUS_SUM YR=2027] Final counts: Continuous=57, New Hire=0, Total Active=57
2025-05-10 08:42:54,506 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2028 (Index 3) ---
2025-05-10 08:42:54,514 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2028] Using 'active' column for headcount: 57 active employees
2025-05-10 08:42:54,525 [INFO    ] [cost_model.engines.run_one_year.run_one_year:129] [RUN_ONE_YEAR YR=2028] Applying terminations based on configured rates in hazard_slice.
2025-05-10 08:42:54,527 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 171 new events...
2025-05-10 08:42:54,530 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:42:54,531 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2028] Starting count: 57, Terminated: -93, Survivors: 150
2025-05-10 08:42:54,531 [INFO    ] [cost_model.engines.run_one_year.run_one_year:167] [RUN_ONE_YEAR YR=2028] Using 'active' column for headcount: 57 active employees
2025-05-10 08:42:54,531 [INFO    ] [cost_model.engines.run_one_year.run_one_year:195] [RUN_ONE_YEAR YR=2028] Starting Headcount: 57, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:42:54,531 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2028] Target Headcount: 60, Hires needed: 0
2025-05-10 08:42:54,531 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2028] Initial survivors (curr): 150, Target EOY: 150, Needed before gross-up: 0
2025-05-10 08:42:54,531 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2028] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:42:54,532 [INFO    ] [cost_model.engines.run_one_year.run_one_year:202] [RUN_ONE_YEAR YR=2028] Hiring target: 150 (survivors + new hires)
2025-05-10 08:42:54,534 [WARNING ] [cost_model.engines.run_one_year.run_one_year:248] [RUN_ONE_YEAR SIM_YR=2028] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2028.
2025-05-10 08:42:54,535 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] EOY 2028 - Snapshot shape: (150, 11), Active: 49
2025-05-10 08:42:54,535 [INFO    ] [cost_model.projections.runner.run_projection_engine:164] EOY 2028 - Events generated this year: 342
2025-05-10 08:42:54,535 [INFO    ] [cost_model.projections.runner.run_projection_engine:193] Year 2028 - Found 42 termination events
2025-05-10 08:42:54,535 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:42:54,535 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:42:54,535 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_449357_000103
2025-05-10 08:42:54,535 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_446407_000124
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_803274_000213
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_843448_000047
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_647163_000091
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_449357_000103
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_446407_000124
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_820606_000155
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_383697_000180
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_926080_000203
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_819142_000206
2025-05-10 08:42:54,536 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_803274_000213
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_586450_000219
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_566513_000241
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_871884_000248
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_874410_000200
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_924184_000152
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_580547_000111
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_802655_000010
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_EX_843448_000047
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:42:54,537 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2028 - Setting termination date 2028-12-31 00:00:00 for employee DUMMY_NH_228914_000151
2025-05-10 08:42:54,538 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_EX_647163_000091 in EOY data
2025-05-10 08:42:54,538 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:42:54,538 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_449357_000103 in EOY data
2025-05-10 08:42:54,539 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_446407_000124 in EOY data
2025-05-10 08:42:54,539 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_820606_000155 in EOY data
2025-05-10 08:42:54,539 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_383697_000180 in EOY data
2025-05-10 08:42:54,540 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_926080_000203 in EOY data
2025-05-10 08:42:54,540 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_819142_000206 in EOY data
2025-05-10 08:42:54,540 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_803274_000213 in EOY data
2025-05-10 08:42:54,541 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_586450_000219 in EOY data
2025-05-10 08:42:54,541 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:42:54,541 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_566513_000241 in EOY data
2025-05-10 08:42:54,542 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_871884_000248 in EOY data
2025-05-10 08:42:54,542 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_874410_000200 in EOY data
2025-05-10 08:42:54,542 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:42:54,543 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_924184_000152 in EOY data
2025-05-10 08:42:54,543 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_580547_000111 in EOY data
2025-05-10 08:42:54,544 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_EX_802655_000010 in EOY data
2025-05-10 08:42:54,544 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_EX_843448_000047 in EOY data
2025-05-10 08:42:54,544 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_930610_000177 in EOY data
2025-05-10 08:42:54,545 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2028 - Updated termination date for employee DUMMY_NH_228914_000151 in EOY data
2025-05-10 08:42:54,545 [INFO    ] [cost_model.projections.runner.run_projection_engine:253] Year 2028 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:42:54,546 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2028] EVT_HIRE constant value: 'hire'
2025-05-10 08:42:54,546 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2028] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:42:54,547 [INFO    ] [cost_model.projections.runner.run_projection_engine:334] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events in log: 0
2025-05-10 08:42:54,547 [INFO    ] [cost_model.projections.runner.run_projection_engine:335] [RUNNER EMP_STATUS_SUM YR=2028] Total hire events matching EVT_HIRE: 0
2025-05-10 08:42:54,547 [INFO    ] [cost_model.projections.runner.run_projection_engine:343] [RUNNER EMP_STATUS_SUM YR=2028] Found 0 unique employee IDs hired in 2028.
2025-05-10 08:42:54,547 [INFO    ] [cost_model.projections.runner.run_projection_engine:358] [RUNNER EMP_STATUS_SUM YR=2028] Active headcount from summary: 49
2025-05-10 08:42:54,547 [INFO    ] [cost_model.projections.runner.run_projection_engine:362] [RUNNER EMP_STATUS_SUM YR=2028] New hires from event log: 0
2025-05-10 08:42:54,547 [INFO    ] [cost_model.projections.runner.run_projection_engine:386] [RUNNER EMP_STATUS_SUM YR=2028] Final counts: Continuous=49, New Hire=0, Total Active=49
2025-05-10 08:42:54,548 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2029 (Index 4) ---
2025-05-10 08:42:54,555 [INFO    ] [cost_model.engines.run_one_year.run_one_year:116] [RUN_ONE_YEAR YR=2029] Using 'active' column for headcount: 49 active employees
2025-05-10 08:42:54,558 [INFO    ] [cost_model.engines.run_one_year.run_one_year:129] [RUN_ONE_YEAR YR=2029] Applying terminations based on configured rates in hazard_slice.
2025-05-10 08:42:54,560 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 176 new events...
2025-05-10 08:42:54,563 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 08:42:54,563 [INFO    ] [cost_model.engines.run_one_year.run_one_year:151] [RUN_ONE_YEAR YR=2029] Starting count: 49, Terminated: -101, Survivors: 150
2025-05-10 08:42:54,564 [INFO    ] [cost_model.engines.run_one_year.run_one_year:167] [RUN_ONE_YEAR YR=2029] Using 'active' column for headcount: 49 active employees
2025-05-10 08:42:54,564 [INFO    ] [cost_model.engines.run_one_year.run_one_year:195] [RUN_ONE_YEAR YR=2029] Starting Headcount: 49, Survivors: 150, Growth Rate: 0.0500
2025-05-10 08:42:54,564 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2029] Target Headcount: 52, Hires needed: 0
2025-05-10 08:42:54,564 [INFO    ] [cost_model.engines.hire.run:38] [HIRE.RUN YR=2029] Initial survivors (curr): 150, Target EOY: 150, Needed before gross-up: 0
2025-05-10 08:42:54,564 [INFO    ] [cost_model.engines.hire.run:41] [HIRE.RUN YR=2029] No hires needed as target is met or exceeded by current survivors.
2025-05-10 08:42:54,565 [INFO    ] [cost_model.engines.run_one_year.run_one_year:202] [RUN_ONE_YEAR YR=2029] Hiring target: 150 (survivors + new hires)
2025-05-10 08:42:54,566 [WARNING ] [cost_model.engines.run_one_year.run_one_year:248] [RUN_ONE_YEAR SIM_YR=2029] 'year' column MISSING in full_event_log. Adding it with current simulation year: 2029.
2025-05-10 08:42:54,567 [INFO    ] [cost_model.projections.runner.run_projection_engine:163] EOY 2029 - Snapshot shape: (150, 11), Active: 39
2025-05-10 08:42:54,567 [INFO    ] [cost_model.projections.runner.run_projection_engine:164] EOY 2029 - Events generated this year: 352
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:193] Year 2029 - Found 52 termination events
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_716045_000063
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_446407_000124
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_630610_000139
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_977990_000223
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_826965_000230
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_725374_000239
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_981004_000160
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_491476_000191
2025-05-10 08:42:54,568 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_802446_000158
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_163468_000157
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_786611_000088
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_716045_000063
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_840323_000098
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_446407_000124
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_630610_000139
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_770974_000144
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_500740_000216
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_601646_000221
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_977990_000223
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_377257_000224
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_674918_000226
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_826965_000230
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_150696_000231
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_120009_000233
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_725374_000239
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_225724_000240
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_272287_000242
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_128328_000187
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_159455_000167
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_981004_000160
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_491476_000191
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_670415_000149
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_802446_000158
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_289575_000133
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_163468_000157
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_NH_930610_000177
2025-05-10 08:42:54,569 [INFO    ] [cost_model.projections.runner.run_projection_engine:202] Year 2029 - Setting termination date 2029-12-31 00:00:00 for employee DUMMY_EX_786611_000088
2025-05-10 08:42:54,570 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_EX_716045_000063 in EOY data
2025-05-10 08:42:54,570 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_EX_840323_000098 in EOY data
2025-05-10 08:42:54,571 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_446407_000124 in EOY data
2025-05-10 08:42:54,571 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_630610_000139 in EOY data
2025-05-10 08:42:54,571 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_770974_000144 in EOY data
2025-05-10 08:42:54,571 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_500740_000216 in EOY data
2025-05-10 08:42:54,572 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_601646_000221 in EOY data
2025-05-10 08:42:54,572 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_977990_000223 in EOY data
2025-05-10 08:42:54,572 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_377257_000224 in EOY data
2025-05-10 08:42:54,573 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_674918_000226 in EOY data
2025-05-10 08:42:54,573 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_826965_000230 in EOY data
2025-05-10 08:42:54,573 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_150696_000231 in EOY data
2025-05-10 08:42:54,574 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_120009_000233 in EOY data
2025-05-10 08:42:54,574 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_725374_000239 in EOY data
2025-05-10 08:42:54,574 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_225724_000240 in EOY data
2025-05-10 08:42:54,574 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_272287_000242 in EOY data
2025-05-10 08:42:54,575 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_128328_000187 in EOY data
2025-05-10 08:42:54,575 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_159455_000167 in EOY data
2025-05-10 08:42:54,575 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_981004_000160 in EOY data
2025-05-10 08:42:54,576 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_491476_000191 in EOY data
2025-05-10 08:42:54,576 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_670415_000149 in EOY data
2025-05-10 08:42:54,577 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_802446_000158 in EOY data
2025-05-10 08:42:54,577 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_289575_000133 in EOY data
2025-05-10 08:42:54,577 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_163468_000157 in EOY data
2025-05-10 08:42:54,578 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_NH_930610_000177 in EOY data
2025-05-10 08:42:54,578 [INFO    ] [cost_model.projections.runner.run_projection_engine:216] Year 2029 - Updated termination date for employee DUMMY_EX_786611_000088 in EOY data
2025-05-10 08:42:54,578 [INFO    ] [cost_model.projections.runner.run_projection_engine:253] Year 2029 - Comprehensive snapshot shape: (150, 12), includes all employees with compensation during the year
2025-05-10 08:42:54,580 [INFO    ] [cost_model.projections.runner.run_projection_engine:332] [RUNNER EMP_STATUS_SUM YR=2029] EVT_HIRE constant value: 'hire'
2025-05-10 08:42:54,580 [INFO    ] [cost_model.projections.runner.run_projection_engine:333] [RUNNER EMP_STATUS_SUM YR=2029] Unique event_type values in log: ['comp' 'term']
2025-05-10 08:42:54,581 [INFO    ] [cost_model.projections.runner.run_projection_engine:334] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events in log: 0
2025-05-10 08:42:54,581 [INFO    ] [cost_model.projections.runner.run_projection_engine:335] [RUNNER EMP_STATUS_SUM YR=2029] Total hire events matching EVT_HIRE: 0
2025-05-10 08:42:54,581 [INFO    ] [cost_model.projections.runner.run_projection_engine:343] [RUNNER EMP_STATUS_SUM YR=2029] Found 0 unique employee IDs hired in 2029.
2025-05-10 08:42:54,581 [INFO    ] [cost_model.projections.runner.run_projection_engine:358] [RUNNER EMP_STATUS_SUM YR=2029] Active headcount from summary: 39
2025-05-10 08:42:54,581 [INFO    ] [cost_model.projections.runner.run_projection_engine:362] [RUNNER EMP_STATUS_SUM YR=2029] New hires from event log: 0
2025-05-10 08:42:54,581 [INFO    ] [cost_model.projections.runner.run_projection_engine:386] [RUNNER EMP_STATUS_SUM YR=2029] Final counts: Continuous=39, New Hire=0, Total Active=39
2025-05-10 08:42:54,582 [INFO    ] [cost_model.projections.runner.run_projection_engine:430] Projection engine run completed.
2025-05-10 08:42:54,582 [INFO    ] [cost_model.projections.runner.run_projection_engine:436] Final EOY Snapshot (2029) shape: (150, 11)
2025-05-10 08:42:54,582 [INFO    ] [cost_model.projections.runner.run_projection_engine:437] Final Cumulative Event Log shape: (1760, 8)
2025-05-10 08:42:54,582 [INFO    ] [cost_model.projections.runner.run_projection_engine:438] Summary Results:
2025-05-10 08:42:54,583 [INFO    ] [cost_model.projections.runner.run_projection_engine:439] 
   Projection Year  Active Headcount  Eligible Count  Participant Count  Total Employee Gross Compensation  Total EE Contribution  Total ER Contribution  Total Compensation  Avg Compensation (Active)  Avg Age (Active)  Participation Rate  Avg Deferral Rate (Participants)
0             2025                85              85                 77                         7978749.24                    0.0                    0.0          7978749.24               93867.638118         47.689624            0.905882                          4.012987
1             2026                69              69                 64                         6115551.61                    0.0                    0.0          6115551.61               88631.182754         48.817467            0.927536                          4.031250
2             2027                57              57                 53                         4963133.38                    0.0                    0.0          4963133.38               87072.515439         49.283524            0.929825                          4.169811
3             2028                49              49                 45                         4274141.56                    0.0                    0.0          4274141.56               87227.378776         49.849279            0.918367                          4.133333
4             2029                39              39                 35                         3305896.21                    0.0                    0.0          3305896.21               84766.569487         51.023781            0.897436                          4.285714
2025-05-10 08:42:54,583 [INFO    ] [cost_model.projections.cli.main:99] Projection engine run completed.
2025-05-10 08:42:54,584 [INFO    ] [cost_model.projections.cli.main:102] Saving detailed results...
2025-05-10 08:42:54,584 [INFO    ] [cost_model.projections.reporting.save_detailed_results:85] Saving detailed results for 'projection_cli' to output_dev/projection_cli_results...
2025-05-10 08:42:54,588 [INFO    ] [cost_model.projections.reporting.save_detailed_results:91] Final EOY snapshot saved to output_dev/projection_cli_results/projection_cli_final_eoy_snapshot.parquet
2025-05-10 08:42:54,590 [INFO    ] [cost_model.projections.reporting.save_detailed_results:96] Final cumulative event log saved to output_dev/projection_cli_results/projection_cli_final_cumulative_event_log.parquet
2025-05-10 08:42:54,591 [INFO    ] [cost_model.projections.reporting.save_detailed_results:101] Summary statistics saved to output_dev/projection_cli_results/projection_cli_summary_statistics.parquet
2025-05-10 08:42:54,592 [INFO    ] [cost_model.projections.reporting.save_detailed_results:106] Employment status summary saved to output_dev/projection_cli_results/projection_cli_employment_status_summary.parquet
2025-05-10 08:42:54,597 [INFO    ] [cost_model.projections.reporting.save_detailed_results:115] Yearly snapshots saved to output_dev/projection_cli_results/yearly_snapshots
2025-05-10 08:42:54,600 [INFO    ] [cost_model.projections.reporting.save_detailed_results:122] Run config saved to output_dev/projection_cli_results/projection_cli_run_config.yaml
2025-05-10 08:42:54,600 [INFO    ] [cost_model.projections.reporting.save_detailed_results:124] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:42:54,600 [INFO    ] [cost_model.projections.cli.main:113] Detailed results for 'projection_cli' saved to output_dev/projection_cli_results
2025-05-10 08:42:54,600 [INFO    ] [cost_model.projections.cli.main:115] Generating and saving plots...
2025-05-10 08:42:54,600 [WARNING ] [cost_model.projections.reporting.plot_projection_results:26] Summary DataFrame is empty or missing required columns for plotting. Skipping plotting.
2025-05-10 08:42:54,600 [INFO    ] [cost_model.projections.cli.main:118] Projection run for scenario 'projection_cli' completed successfully.
2025-05-10 08:42:54,600 [INFO    ] [cost_model.projections.cli.main:119] All outputs saved in: output_dev/projection_cli_results
2025-05-10 08:46:36,762 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:46:36,763 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:46:36,768 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:46:36,768 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:46:36,768 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:46:36,768 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:46:36,818 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:46:36,819 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:46:36,827 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:46:36,828 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:46:36,828 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:46:36,830 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:46:36,830 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:46:36,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:46:36,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:46:36,830 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 08:46:36,830 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 08:46:36,830 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:46:36,832 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:46:36,832 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:46:36,833 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:46:36,833 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 156, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 49, in run_one_year
    hazard_slice = hazard_table[hazard_table["simulation_year"] == year]
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/ops/common.py", line 76, in new_method
    return method(self, other)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/arraylike.py", line 40, in __eq__
    return self._cmp_method(other, operator.eq)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/frame.py", line 7897, in _cmp_method
    self, other = self._align_for_op(other, axis, flex=False, level=None)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/frame.py", line 8205, in _align_for_op
    raise ValueError(
ValueError: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.
2025-05-10 08:48:31,619 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:48:31,620 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:48:31,624 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:48:31,624 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:48:31,624 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:48:31,624 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:48:31,677 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:48:31,678 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:48:31,684 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:48:31,685 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:48:31,685 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:48:31,686 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:48:31,686 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:48:31,686 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:48:31,686 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:48:31,687 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 08:48:31,687 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 08:48:31,687 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:48:31,689 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:48:31,689 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:48:31,689 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:48:31,694 [INFO    ] [cost_model.engines.run_one_year.run_one_year:63] [RUN_ONE_YEAR YR=                                   employee_id employee_hire_date employee_birth_date  ... active  employee_deferral_rate tenure_band
employee_id                                                                            ...                                           
DUMMY_EX_181509_000011  DUMMY_EX_181509_000011         2015-04-19          1985-07-17  ...   True                     3.0     5-10yrs
DUMMY_EX_554513_000013  DUMMY_EX_554513_000013         2010-03-31          1974-10-12  ...   True                     0.0      10+yrs
DUMMY_EX_371360_000016  DUMMY_EX_371360_000016         2012-01-10          1959-05-26  ...   True                    10.0      10+yrs
DUMMY_EX_276791_000032  DUMMY_EX_276791_000032         2018-04-15          1991-12-01  ...   True                     4.0     5-10yrs
DUMMY_EX_557534_000035  DUMMY_EX_557534_000035         2007-08-03          1960-08-15  ...   True                     3.0      10+yrs
...                                        ...                ...                 ...  ...    ...                     ...         ...
DUMMY_EX_529547_000075  DUMMY_EX_529547_000075         2013-12-25          1987-06-03  ...  False                     4.0      10+yrs
DUMMY_NH_165566_000136  DUMMY_NH_165566_000136         2022-05-06          1961-06-15  ...  False                     4.0      1-3yrs
DUMMY_NH_862579_000146  DUMMY_NH_862579_000146         2022-07-18          1985-11-24  ...  False                     4.0      1-3yrs
DUMMY_NH_912390_000186  DUMMY_NH_912390_000186         2023-03-10          1963-03-22  ...  False                     3.0      1-3yrs
DUMMY_NH_502603_000169  DUMMY_NH_502603_000169         2023-05-06          1991-02-14  ...  False                    10.0      1-3yrs

[150 rows x 9 columns]] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, NewHireTerm=N/A
2025-05-10 08:48:31,699 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: Unknown datetime string format, unable to parse:                                    employee_id employee_hire_date employee_birth_date  ... active  employee_deferral_rate tenure_band
employee_id                                                                            ...                                           
DUMMY_EX_181509_000011  DUMMY_EX_181509_000011         2015-04-19          1985-07-17  ...   True                     3.0     5-10yrs
DUMMY_EX_554513_000013  DUMMY_EX_554513_000013         2010-03-31          1974-10-12  ...   True                     0.0      10+yrs
DUMMY_EX_371360_000016  DUMMY_EX_371360_000016         2012-01-10          1959-05-26  ...   True                    10.0      10+yrs
DUMMY_EX_276791_000032  DUMMY_EX_276791_000032         2018-04-15          1991-12-01  ...   True                     4.0     5-10yrs
DUMMY_EX_557534_000035  DUMMY_EX_557534_000035         2007-08-03          1960-08-15  ...   True                     3.0      10+yrs
...                                        ...                ...                 ...  ...    ...                     ...         ...
DUMMY_EX_529547_000075  DUMMY_EX_529547_000075         2013-12-25          1987-06-03  ...  False                     4.0      10+yrs
DUMMY_NH_165566_000136  DUMMY_NH_165566_000136         2022-05-06          1961-06-15  ...  False                     4.0      1-3yrs
DUMMY_NH_862579_000146  DUMMY_NH_862579_000146         2022-07-18          1985-11-24  ...  False                     4.0      1-3yrs
DUMMY_NH_912390_000186  DUMMY_NH_912390_000186         2023-03-10          1963-03-22  ...  False                     3.0      1-3yrs
DUMMY_NH_502603_000169  DUMMY_NH_502603_000169         2023-05-06          1991-02-14  ...  False                    10.0      1-3yrs

[150 rows x 9 columns]-01-01
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 156, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 65, in run_one_year
    as_of = pd.Timestamp(f"{year}-01-01")
  File "timestamps.pyx", line 1865, in pandas._libs.tslibs.timestamps.Timestamp.__new__
  File "conversion.pyx", line 364, in pandas._libs.tslibs.conversion.convert_to_tsobject
  File "conversion.pyx", line 641, in pandas._libs.tslibs.conversion.convert_str_to_tsobject
  File "parsing.pyx", line 336, in pandas._libs.tslibs.parsing.parse_datetime_string
  File "parsing.pyx", line 666, in pandas._libs.tslibs.parsing.dateutil_parse
pandas._libs.tslibs.parsing.DateParseError: Unknown datetime string format, unable to parse:                                    employee_id employee_hire_date employee_birth_date  ... active  employee_deferral_rate tenure_band
employee_id                                                                            ...                                           
DUMMY_EX_181509_000011  DUMMY_EX_181509_000011         2015-04-19          1985-07-17  ...   True                     3.0     5-10yrs
DUMMY_EX_554513_000013  DUMMY_EX_554513_000013         2010-03-31          1974-10-12  ...   True                     0.0      10+yrs
DUMMY_EX_371360_000016  DUMMY_EX_371360_000016         2012-01-10          1959-05-26  ...   True                    10.0      10+yrs
DUMMY_EX_276791_000032  DUMMY_EX_276791_000032         2018-04-15          1991-12-01  ...   True                     4.0     5-10yrs
DUMMY_EX_557534_000035  DUMMY_EX_557534_000035         2007-08-03          1960-08-15  ...   True                     3.0      10+yrs
...                                        ...                ...                 ...  ...    ...                     ...         ...
DUMMY_EX_529547_000075  DUMMY_EX_529547_000075         2013-12-25          1987-06-03  ...  False                     4.0      10+yrs
DUMMY_NH_165566_000136  DUMMY_NH_165566_000136         2022-05-06          1961-06-15  ...  False                     4.0      1-3yrs
DUMMY_NH_862579_000146  DUMMY_NH_862579_000146         2022-07-18          1985-11-24  ...  False                     4.0      1-3yrs
DUMMY_NH_912390_000186  DUMMY_NH_912390_000186         2023-03-10          1963-03-22  ...  False                     3.0      1-3yrs
DUMMY_NH_502603_000169  DUMMY_NH_502603_000169         2023-05-06          1991-02-14  ...  False                    10.0      1-3yrs

[150 rows x 9 columns]-01-01
2025-05-10 08:49:10,257 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:49:10,257 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:49:10,262 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:49:10,262 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:49:10,262 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:49:10,262 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:49:10,285 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:49:10,285 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:49:10,288 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:49:10,288 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:49:10,288 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:49:10,289 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:49:10,289 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:49:10,289 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:49:10,289 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:49:10,290 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 08:49:10,290 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 08:49:10,290 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:49:10,291 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:49:10,291 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:49:10,292 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:49:10,292 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: 'types.SimpleNamespace' object has no attribute 'data_paths'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 162, in run_projection_engine
    global_params.data_paths.census_template_path, # census_template_path
AttributeError: 'types.SimpleNamespace' object has no attribute 'data_paths'
2025-05-10 08:57:25,851 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:57:25,852 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:57:25,856 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:57:25,856 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:57:25,856 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:57:25,856 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:57:25,909 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:57:25,910 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:57:25,915 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:57:25,915 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:57:25,915 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:57:25,917 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:57:25,917 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:57:25,917 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:57:25,917 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:57:25,917 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 08:57:25,917 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 08:57:25,917 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:57:25,919 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:57:25,919 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:57:25,919 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:57:25,920 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: 'types.SimpleNamespace' object has no attribute 'global_parameters'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 163, in run_projection_engine
    global_params.global_parameters.census_template_path, # census_template_path
AttributeError: 'types.SimpleNamespace' object has no attribute 'global_parameters'
2025-05-10 08:58:31,963 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:58:31,964 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:58:31,969 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:58:31,969 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:58:31,969 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:58:31,969 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:58:32,020 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:58:32,021 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:58:32,029 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:58:32,030 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:58:32,030 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:58:32,031 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:58:32,031 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:58:32,032 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:58:32,032 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:58:32,032 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 08:58:32,032 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 08:58:32,032 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:58:32,034 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:58:32,034 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:58:32,035 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:58:32,035 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: 'types.SimpleNamespace' object has no attribute 'simulation_control'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 165, in run_projection_engine
    deterministic_term=getattr(global_params.simulation_control, 'deterministic_termination', False)
AttributeError: 'types.SimpleNamespace' object has no attribute 'simulation_control'
2025-05-10 08:59:31,585 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 08:59:31,585 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 08:59:31,590 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 08:59:31,590 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 08:59:31,590 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 08:59:31,590 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 08:59:31,643 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 08:59:31,645 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 08:59:31,652 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 08:59:31,652 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 08:59:31,652 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 08:59:31,654 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 08:59:31,654 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 08:59:31,654 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 08:59:31,654 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 08:59:31,654 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 08:59:31,654 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 08:59:31,655 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 08:59:31,657 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 08:59:31,657 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 08:59:31,657 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 08:59:31,657 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: run_one_year() got an unexpected keyword argument 'rng_seed_offset'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 156, in run_projection_engine
    event_log_for_year, _ = run_one_year(
TypeError: run_one_year() got an unexpected keyword argument 'rng_seed_offset'
2025-05-10 09:03:18,826 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 09:03:18,826 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 09:03:18,831 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 09:03:18,831 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 09:03:18,831 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 09:03:18,831 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 09:03:18,891 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 09:03:18,892 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 09:03:18,902 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 09:03:18,902 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 09:03:18,902 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 09:03:18,904 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 09:03:18,904 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 09:03:18,904 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 09:03:18,904 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 09:03:18,904 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 09:03:18,904 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 09:03:18,905 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 09:03:18,907 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 09:03:18,907 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 09:03:18,907 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 09:03:18,907 [INFO    ] [cost_model.engines.run_one_year.run_one_year:67] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, NewHireTerm=N/A
2025-05-10 09:03:18,908 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: name 'event_log' is not defined
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 156, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 72, in run_one_year
    events = event_log.copy()
NameError: name 'event_log' is not defined
2025-05-10 09:45:01,455 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 09:45:01,455 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 09:45:01,460 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 09:45:01,460 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 09:45:01,460 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 09:45:01,460 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 09:45:01,562 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 09:45:01,563 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 09:45:01,568 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 09:45:01,568 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 09:45:01,568 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 09:45:01,570 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 09:45:01,570 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 09:45:01,570 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 09:45:01,570 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 09:45:01,570 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 09:45:01,570 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 09:45:01,570 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 09:45:01,572 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 09:45:01,572 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 09:45:01,573 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 09:45:01,573 [INFO    ] [cost_model.engines.run_one_year.run_one_year:67] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, NewHireTerm=N/A
2025-05-10 09:45:01,573 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: name 'event_log' is not defined
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 156, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 72, in run_one_year
    events = event_log.copy()
NameError: name 'event_log' is not defined
2025-05-10 09:45:41,391 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 09:45:41,391 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 09:45:41,396 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 09:45:41,396 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 09:45:41,396 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 09:45:41,396 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 09:45:41,419 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 09:45:41,419 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 09:45:41,421 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 09:45:41,422 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 09:45:41,422 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 09:45:41,423 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 09:45:41,423 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 09:45:41,423 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 09:45:41,423 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 09:45:41,423 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 09:45:41,423 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 09:45:41,423 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 09:45:41,425 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 09:45:41,425 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 09:45:41,425 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 09:45:41,426 [INFO    ] [cost_model.engines.run_one_year.run_one_year:67] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, NewHireTerm=N/A
2025-05-10 09:45:41,426 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: name 'event_log' is not defined
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 156, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 72, in run_one_year
    events = event_log.copy()
NameError: name 'event_log' is not defined
2025-05-10 09:48:21,708 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 09:48:21,708 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 09:48:21,714 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 09:48:21,714 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 09:48:21,714 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 09:48:21,714 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 09:48:21,766 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 09:48:21,767 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 09:48:21,774 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 09:48:21,774 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 09:48:21,774 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 09:48:21,776 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 09:48:21,776 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 09:48:21,776 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 09:48:21,776 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 09:48:21,777 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 09:48:21,777 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 09:48:21,777 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 09:48:21,779 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 09:48:21,779 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 09:48:21,779 [INFO    ] [cost_model.projections.runner.run_projection_engine:150] --- Simulating Year 2025 (Index 0) ---
2025-05-10 09:48:21,780 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: run_one_year() missing 6 required positional arguments: 'prev_snapshot', 'year', 'config', 'hazard_table', 'rng', and 'census_template_path'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 156, in run_projection_engine
    event_log_for_year, _ = run_one_year(
TypeError: run_one_year() missing 6 required positional arguments: 'prev_snapshot', 'year', 'config', 'hazard_table', 'rng', and 'census_template_path'
2025-05-10 09:50:51,243 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 09:50:51,244 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 09:50:51,249 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 09:50:51,249 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 09:50:51,249 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 09:50:51,249 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 09:50:51,327 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 09:50:51,328 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 09:50:51,335 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 09:50:51,335 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 09:50:51,335 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 09:50:51,337 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 09:50:51,337 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 09:50:51,337 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 09:50:51,337 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 09:50:51,337 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 09:50:51,337 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 09:50:51,337 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 09:50:51,340 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 09:50:51,340 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 09:50:51,340 [ERROR   ] [cost_model.projections.runner.run_projection_engine:132] Missing 'census_template_path' in config_ns
2025-05-10 09:50:51,340 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: census_template_path must be provided in the configuration
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 133, in run_projection_engine
    raise ValueError("census_template_path must be provided in the configuration")
ValueError: census_template_path must be provided in the configuration
2025-05-10 09:53:09,599 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 09:53:09,600 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 09:53:09,604 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 09:53:09,604 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 09:53:09,604 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 09:53:09,604 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 09:53:09,664 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 09:53:09,666 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 09:53:09,676 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 09:53:09,676 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 09:53:09,677 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 09:53:09,678 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 09:53:09,678 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 09:53:09,678 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 09:53:09,678 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 09:53:09,679 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 09:53:09,679 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 09:53:09,679 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 09:53:09,680 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 09:53:09,680 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 09:53:09,681 [INFO    ] [cost_model.projections.runner.run_projection_engine:159] --- Simulating Year 2025 (Index 0) ---
2025-05-10 09:53:09,681 [INFO    ] [cost_model.engines.run_one_year.run_one_year:68] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.15000000000000002, Growth=0.04999999999999998, NewHireTerm=N/A
2025-05-10 09:53:09,692 [INFO    ] [cost_model.engines.run_one_year.run_one_year:137] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 09:53:09,709 [INFO    ] [cost_model.engines.run_one_year.run_one_year:150] [RUN_ONE_YEAR YR=2025] Applying terminations based on configured rates in hazard_slice.
2025-05-10 09:53:09,711 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: operands could not be broadcast together with shapes (150,) (750,) 
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 165, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 151, in run_one_year
    term_events = term.run(prev_snapshot, hazard_slice, rng, deterministic_term)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/term.py", line 86, in run
    losers = df.loc[draw < probs, EMP_ID].tolist()
ValueError: operands could not be broadcast together with shapes (150,) (750,) 
2025-05-10 10:11:25,974 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 10:11:25,975 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 10:11:25,980 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 10:11:25,980 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 10:11:25,980 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 10:11:25,980 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 10:11:26,030 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 10:11:26,031 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 10:11:26,036 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 10:11:26,037 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 10:11:26,037 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 10:11:26,038 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 10:11:26,038 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 10:11:26,038 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 10:11:26,038 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 10:11:26,038 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 10:11:26,039 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 10:11:26,039 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 10:11:26,040 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 10:11:26,041 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 10:11:26,041 [INFO    ] [cost_model.projections.runner.run_projection_engine:159] --- Simulating Year 2025 (Index 0) ---
2025-05-10 10:11:26,041 [INFO    ] [cost_model.engines.run_one_year.run_one_year:69] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, CompRaise=0.05000000000000001, NewHireTerm=N/A
2025-05-10 10:11:26,050 [INFO    ] [cost_model.engines.run_one_year.run_one_year:145] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 10:11:26,055 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2025] Applying terminations based on configured rates in hazard_slice.
2025-05-10 10:11:26,057 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2025] Generated 15 termination events for existing employees.
2025-05-10 10:11:26,058 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2025] Combined 165 comp and existing term events.
2025-05-10 10:11:26,058 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 165 new events...
2025-05-10 10:11:26,062 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 10:11:26,062 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 165, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 180, in run_one_year
    updated_snapshot_for_survivors, _ = snapshot.update(current_snapshot_for_survivors, temp_events_df)
ValueError: too many values to unpack (expected 2)
2025-05-10 10:11:58,092 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 10:11:58,092 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 10:11:58,097 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 10:11:58,097 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 10:11:58,097 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 10:11:58,097 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 10:11:58,120 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 10:11:58,121 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 10:11:58,124 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 10:11:58,124 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 10:11:58,124 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 10:11:58,125 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 10:11:58,125 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 10:11:58,125 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 10:11:58,125 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 10:11:58,125 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 10:11:58,125 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 10:11:58,126 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 10:11:58,126 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 10:11:58,126 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 10:11:58,127 [INFO    ] [cost_model.projections.runner.run_projection_engine:159] --- Simulating Year 2025 (Index 0) ---
2025-05-10 10:11:58,127 [INFO    ] [cost_model.engines.run_one_year.run_one_year:69] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, CompRaise=0.05000000000000001, NewHireTerm=N/A
2025-05-10 10:11:58,135 [INFO    ] [cost_model.engines.run_one_year.run_one_year:145] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 10:11:58,140 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2025] Applying terminations based on configured rates in hazard_slice.
2025-05-10 10:11:58,142 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2025] Generated 15 termination events for existing employees.
2025-05-10 10:11:58,142 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2025] Combined 165 comp and existing term events.
2025-05-10 10:11:58,142 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 165 new events...
2025-05-10 10:11:58,145 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 10:11:58,145 [INFO    ] [cost_model.engines.run_one_year.run_one_year:185] [RUN_ONE_YEAR YR=2025] After comp and term events (existing employees), n_survivors = 150
2025-05-10 10:11:58,146 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2025] Starting count: 100, Terminated: -50, Survivors: 150
2025-05-10 10:11:58,146 [INFO    ] [cost_model.engines.run_one_year.run_one_year:212] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 10:11:58,146 [INFO    ] [cost_model.engines.run_one_year.run_one_year:228] [RUN_ONE_YEAR YR=2025] Hires needed (net before new hire term adjustment): 0
2025-05-10 10:11:58,146 [INFO    ] [cost_model.engines.run_one_year.run_one_year:237] [RUN_ONE_YEAR YR=2025] No adjustment for new hire termination rate (Rate: 0.0000, Hires Needed: 0)
2025-05-10 10:11:58,146 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: 'year'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'year'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 165, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 241, in run_one_year
    hire_events_tuple = hire.run(updated_snapshot_for_survivors, hires_needed, hazard_slice, year_specific_rng, census_template_path) # Ensure hire.run uses the (potentially grossed-up) hires_needed
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/hire.py", line 32, in run
    simulation_year = hazard_slice['year'].iloc[0] # Derive simulation_year from hazard_slice
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/.venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'year'
2025-05-10 10:12:20,542 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 10:12:20,543 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 10:12:20,548 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 10:12:20,548 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 10:12:20,548 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 10:12:20,548 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 10:12:20,570 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 10:12:20,570 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 10:12:20,573 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 10:12:20,573 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 10:12:20,573 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 10:12:20,574 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 10:12:20,574 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 10:12:20,574 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 10:12:20,574 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 10:12:20,574 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 10:12:20,574 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 10:12:20,575 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 10:12:20,575 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 10:12:20,575 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 10:12:20,576 [INFO    ] [cost_model.projections.runner.run_projection_engine:159] --- Simulating Year 2025 (Index 0) ---
2025-05-10 10:12:20,576 [INFO    ] [cost_model.engines.run_one_year.run_one_year:69] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, CompRaise=0.05000000000000001, NewHireTerm=N/A
2025-05-10 10:12:20,585 [INFO    ] [cost_model.engines.run_one_year.run_one_year:145] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 10:12:20,590 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2025] Applying terminations based on configured rates in hazard_slice.
2025-05-10 10:12:20,591 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2025] Generated 15 termination events for existing employees.
2025-05-10 10:12:20,592 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2025] Combined 165 comp and existing term events.
2025-05-10 10:12:20,592 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 165 new events...
2025-05-10 10:12:20,595 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 10:12:20,596 [INFO    ] [cost_model.engines.run_one_year.run_one_year:185] [RUN_ONE_YEAR YR=2025] After comp and term events (existing employees), n_survivors = 150
2025-05-10 10:12:20,596 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2025] Starting count: 100, Terminated: -50, Survivors: 150
2025-05-10 10:12:20,596 [INFO    ] [cost_model.engines.run_one_year.run_one_year:212] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 10:12:20,596 [INFO    ] [cost_model.engines.run_one_year.run_one_year:228] [RUN_ONE_YEAR YR=2025] Hires needed (net before new hire term adjustment): 0
2025-05-10 10:12:20,596 [INFO    ] [cost_model.engines.run_one_year.run_one_year:237] [RUN_ONE_YEAR YR=2025] No adjustment for new hire termination rate (Rate: 0.0000, Hires Needed: 0)
2025-05-10 10:12:20,596 [INFO    ] [cost_model.engines.hire.run:39] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 0, Needed before gross-up: 0
2025-05-10 10:12:20,597 [INFO    ] [cost_model.engines.hire.run:42] [HIRE.RUN YR=2025] No hires needed as target is met or exceeded by current survivors.
2025-05-10 10:12:20,597 [INFO    ] [cost_model.engines.run_one_year.run_one_year:257] [RUN_ONE_YEAR YR=2025] Generated 0 hire events (aimed for 0).
2025-05-10 10:12:20,597 [INFO    ] [cost_model.engines.run_one_year.run_one_year:269] [RUN_ONE_YEAR YR=2025] Combined 165 events before new hire terminations.
2025-05-10 10:12:20,597 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 165 new events...
2025-05-10 10:12:20,601 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 10:12:20,601 [INFO    ] [cost_model.engines.run_one_year.run_one_year:276] [RUN_ONE_YEAR YR=2025] Snapshot updated with hires, active before NH term: 91
2025-05-10 10:12:20,601 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: module 'cost_model.engines.term' has no attribute 'run_new_hires'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 165, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 280, in run_one_year
    new_hire_term_events_list = term.run_new_hires(snapshot_with_hires, hazard_slice, year_specific_rng, year, deterministic_term)
AttributeError: module 'cost_model.engines.term' has no attribute 'run_new_hires'
2025-05-10 10:13:00,589 [INFO    ] [cost_model.projections.cli.main:63] Starting projection run with CLI arguments: Namespace(config='config/dev_tiny.yaml', census='data/census_preprocessed.parquet', output_dir=None, scenario_name='projection_cli')
2025-05-10 10:13:00,589 [INFO    ] [cost_model.projections.cli.main:67] Loading configuration from: config/dev_tiny.yaml
2025-05-10 10:13:00,594 [INFO    ] [cost_model.projections.cli.main:73] Logging level set to: INFO
2025-05-10 10:13:00,594 [INFO    ] [cost_model.projections.cli.main:83] Output will be saved to: output_dev/projection_cli_results
2025-05-10 10:13:00,594 [INFO    ] [cost_model.projections.cli.main:88] Creating initial snapshot from census: data/census_preprocessed.parquet for start year: 2025
2025-05-10 10:13:00,594 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:18] Creating initial snapshot for start year: 2025 from data/census_preprocessed.parquet
2025-05-10 10:13:00,617 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:28] Loaded census data with 150 records. Columns: ['employee_id', 'employee_role', 'employee_birth_date', 'employee_hire_date', 'employee_termination_date', 'employee_gross_compensation', 'employee_plan_year_compensation', 'employee_capped_compensation', 'employee_deferral_rate', 'employee_contribution', 'employer_core_contribution', 'employer_match_contribution']
2025-05-10 10:13:00,617 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:38] Setting active status based on termination dates: 100 active out of 150
2025-05-10 10:13:00,620 [INFO    ] [cost_model.projections.snapshot.create_initial_snapshot:119] Initial snapshot created with 150 records. Columns: ['employee_id', 'employee_hire_date', 'employee_birth_date', 'employee_role', 'employee_gross_compensation', 'employee_termination_date', 'active', 'employee_deferral_rate', 'tenure_band']
2025-05-10 10:13:00,620 [INFO    ] [cost_model.projections.cli.main:92] Creating initial event log for start year: 2025
2025-05-10 10:13:00,620 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:15] Creating initial event log for events up to start of year: 2025
2025-05-10 10:13:00,621 [INFO    ] [cost_model.projections.event_log.create_initial_event_log:52] Initial event log created with 2 records. Dtypes:
event_id       string[python]
event_time     datetime64[ns]
employee_id    string[python]
event_type     string[python]
value_num             Float64
value_json     string[python]
meta           string[python]
dtype: object
2025-05-10 10:13:00,621 [INFO    ] [cost_model.projections.cli.main:96] Starting projection engine...
2025-05-10 10:13:00,621 [INFO    ] [cost_model.projections.runner.run_projection_engine:88] Running 5-year projection starting from 2025.
2025-05-10 10:13:00,621 [INFO    ] [cost_model.projections.runner.run_projection_engine:89] Random seed: 42
2025-05-10 10:13:00,622 [INFO    ] [cost_model.projections.runner.run_projection_engine:113] Runner: Initial active headcount from snapshot's 'active' column: 100
2025-05-10 10:13:00,622 [WARNING ] [cost_model.projections.runner.run_projection_engine:119] Initial Snapshot: Mismatch between active count from 'employee_termination_date'.isna() (150) and 'active' column (100). Proceeding with 'active' column as definitive.
2025-05-10 10:13:00,622 [INFO    ] [cost_model.projections.runner._generate_hazard_table:34] Generating hazard table...
2025-05-10 10:13:00,623 [INFO    ] [cost_model.projections.runner._generate_hazard_table:48] Using global rates for hazard table: Term Rate=0.15, Growth Rate=0.05, Comp Raise Pct=0.05
2025-05-10 10:13:00,623 [INFO    ] [cost_model.projections.runner._generate_hazard_table:65] Hazard table constructed for 12 role/tenure combinations across 5 years.
2025-05-10 10:13:00,624 [INFO    ] [cost_model.projections.runner.run_projection_engine:159] --- Simulating Year 2025 (Index 0) ---
2025-05-10 10:13:00,624 [INFO    ] [cost_model.engines.run_one_year.run_one_year:69] [RUN_ONE_YEAR YR=2025] Hazard Slice Rates: Term=0.14999999999999997, Growth=0.05000000000000001, CompRaise=0.05000000000000001, NewHireTerm=N/A
2025-05-10 10:13:00,633 [INFO    ] [cost_model.engines.run_one_year.run_one_year:145] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 10:13:00,638 [INFO    ] [cost_model.engines.run_one_year.run_one_year:157] [RUN_ONE_YEAR YR=2025] Applying terminations based on configured rates in hazard_slice.
2025-05-10 10:13:00,639 [INFO    ] [cost_model.engines.run_one_year.run_one_year:162] [RUN_ONE_YEAR YR=2025] Generated 15 termination events for existing employees.
2025-05-10 10:13:00,640 [INFO    ] [cost_model.engines.run_one_year.run_one_year:171] [RUN_ONE_YEAR YR=2025] Combined 165 comp and existing term events.
2025-05-10 10:13:00,640 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 9)) with 165 new events...
2025-05-10 10:13:00,643 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 10:13:00,643 [INFO    ] [cost_model.engines.run_one_year.run_one_year:185] [RUN_ONE_YEAR YR=2025] After comp and term events (existing employees), n_survivors = 150
2025-05-10 10:13:00,644 [INFO    ] [cost_model.engines.run_one_year.run_one_year:196] [RUN_ONE_YEAR YR=2025] Starting count: 100, Terminated: -50, Survivors: 150
2025-05-10 10:13:00,644 [INFO    ] [cost_model.engines.run_one_year.run_one_year:212] [RUN_ONE_YEAR YR=2025] Using 'active' column for headcount: 100 active employees
2025-05-10 10:13:00,644 [INFO    ] [cost_model.engines.run_one_year.run_one_year:228] [RUN_ONE_YEAR YR=2025] Hires needed (net before new hire term adjustment): 0
2025-05-10 10:13:00,644 [INFO    ] [cost_model.engines.run_one_year.run_one_year:237] [RUN_ONE_YEAR YR=2025] No adjustment for new hire termination rate (Rate: 0.0000, Hires Needed: 0)
2025-05-10 10:13:00,644 [INFO    ] [cost_model.engines.hire.run:39] [HIRE.RUN YR=2025] Initial survivors (curr): 150, Target EOY: 0, Needed before gross-up: 0
2025-05-10 10:13:00,644 [INFO    ] [cost_model.engines.hire.run:42] [HIRE.RUN YR=2025] No hires needed as target is met or exceeded by current survivors.
2025-05-10 10:13:00,645 [INFO    ] [cost_model.engines.run_one_year.run_one_year:257] [RUN_ONE_YEAR YR=2025] Generated 0 hire events (aimed for 0).
2025-05-10 10:13:00,645 [INFO    ] [cost_model.engines.run_one_year.run_one_year:269] [RUN_ONE_YEAR YR=2025] Combined 165 events before new hire terminations.
2025-05-10 10:13:00,645 [INFO    ] [cost_model.state.snapshot.update:273] Updating snapshot ((150, 11)) with 165 new events...
2025-05-10 10:13:00,648 [INFO    ] [cost_model.state.snapshot.update:428] Snapshot update complete. New shape: (150, 11)
2025-05-10 10:13:00,648 [INFO    ] [cost_model.engines.run_one_year.run_one_year:276] [RUN_ONE_YEAR YR=2025] Snapshot updated with hires, active before NH term: 91
2025-05-10 10:13:00,648 [ERROR   ] [cost_model.projections.cli.main:124] An unexpected error occurred during the projection run: module 'cost_model.engines.term' has no attribute 'run_new_hires'
Traceback (most recent call last):
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/cli.py", line 98, in main
    run_projection_engine(config_ns, initial_snapshot, initial_event_log)
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/projections/runner.py", line 165, in run_projection_engine
    event_log_for_year, _ = run_one_year(
  File "/Users/nicholasamaral/Library/Mobile Documents/com~apple~CloudDocs/Development/cost-model/cost_model/engines/run_one_year.py", line 280, in run_one_year
    new_hire_term_events_list = term.run_new_hires(snapshot_with_hires, hazard_slice, year_specific_rng, year, deterministic_term)
AttributeError: module 'cost_model.engines.term' has no attribute 'run_new_hires'
